mov edi edi +
push ebp  +
mov ebp esp +
push [ebp+arg_0]  +
mov eax large fs:18h +
mov eax [eax+30h] +
push 0  +
push dword ptr [eax+18h]  +
call ds:RtlAllocateHeap  +
pop ebp  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
cmp [ebp+arg_0] 0 +
jz loc_100140A  +
push [ebp+arg_0]  +
mov eax large fs:18h +
mov eax [eax+30h] +
push 0  +
push dword ptr [eax+18h]  +
call ds:RtlFreeHeap  +
pop ebp  +
retn   +
***
mov edi edi +
push esi  +
push edi  +
mov edi ecx +
lea esi [edi+36Ch] +
mov ecx [esi] +
test ecx ecx +
jz loc_1001429  +
mov eax [ecx] +
push 1  +
call dword ptr [eax]  +
and dword ptr [esi] 0 +
lea esi [edi+370h] +
mov ecx [esi] +
test ecx ecx +
jz loc_100143E  +
mov eax [ecx] +
push 1  +
call dword ptr [eax]  +
and dword ptr [esi] 0 +
pop edi  +
pop esi  +
retn   +
***
mov edi edi +
push esi  +
mov esi ecx +
push edi  +
mov dword ptr [esi] offset off_10011CC +
call sub_1001411  +
mov edi ds:??1DSTRING@@UAE@XZ +
lea ecx [esi+340h] +
call edi  +
lea ecx [esi+328h] +
call edi  +
lea ecx [esi+310h] +
call edi  +
lea ecx [esi+0D0h] +
call ds:??1PATH@@UAE@XZ  +
lea ecx [esi+0B8h] +
call edi  +
lea ecx [esi+0A0h] +
call edi  +
lea ecx [esi+88h] +
call edi  +
pop edi  +
mov ecx esi +
pop esi  +
jmp ds:??1PROGRAM@@UAE@XZ  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 18h +
push esi  +
push edi  +
mov edi ecx +
lea ecx [ebp+var_18] +
call ds:??0DSTRING@@QAE@XZ  +
call ds:?QuerySystemDirectory@SYSTEM@@SGPAVPATH@@XZ  +
mov esi eax +
test esi esi +
jnz loc_10014DC  +
mov eax [edi] +
push 1  +
push 759Ch  +
mov ecx edi +
call dword ptr [eax+0Ch]  +
jmp loc_1001558  +
push 0FFFFFFFFh  +
push [ebp+arg_0]  +
lea ecx [ebp+var_18] +
call ds:?Initialize@WSTRING@@QAEEPBGK@Z  +
test al al +
jz loc_1001542  +
push 0  +
lea eax [ebp+var_18] +
push eax  +
mov ecx esi +
call ds:?AppendBase@PATH@@QAEEPBVWSTRING@@E@Z  +
test al al +
jz loc_1001542  +
push 0  +
push 0  +
push esi  +
call ds:?QueryFile@SYSTEM@@SGPAVFSN_FILE@@PBVPATH@@EPAE@Z  +
test eax eax +
jnz loc_100152D  +
mov eax [edi] +
lea ecx [esi+210h] +
push ecx  +
push offset dword_10011F8  +
push 1  +
push 759Dh  +
push edi  +
call dword ptr [eax+8]  +
add esp 14h +
jmp loc_1001550  +
mov edx [eax] +
push 1  +
mov ecx eax +
call dword ptr [edx]  +
lea ecx [ebp+var_18] +
call ds:??1DSTRING@@UAE@XZ  +
mov eax esi +
jmp loc_1001563  +
mov eax [edi] +
push 1  +
push 75C8h  +
mov ecx edi +
call dword ptr [eax+0Ch]  +
mov eax [esi] +
push 1  +
mov ecx esi +
call dword ptr [eax]  +
lea ecx [ebp+var_18] +
call ds:??1DSTRING@@UAE@XZ  +
xor eax eax +
pop edi  +
pop esi  +
leave   +
retn 4  +
***
mov edi edi +
push esi  +
mov esi ecx +
lea ecx [esi+10h] +
call ds:??1DSTRING@@UAE@XZ  +
mov ecx esi +
pop esi  +
jmp ds:??1OBJECT@@UAE@XZ  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 0A8h +
push ebx  +
push esi  +
mov esi ds:??0DSTRING@@QAE@XZ +
mov ebx ecx +
push edi  +
lea ecx [ebp+var_18] +
call esi  +
lea ecx [ebp+var_30] +
call esi  +
lea ecx [ebp+var_A8] +
call esi  +
lea ecx [ebp+var_78] +
call esi  +
lea ecx [ebp+var_60] +
call esi  +
lea ecx [ebp+var_48] +
call esi  +
lea ecx [ebp+var_90] +
call esi  +
mov edi ds:?Initialize@WSTRING@@QAEEPBGK@Z +
push 0FFFFFFFFh  +
push offset aAutocheckAutoc  +
lea ecx [ebp+var_18] +
call edi  +
test al al +
jz loc_10017A6  +
push 0FFFFFFFFh  +
push offset asc_1001250  +
lea ecx [ebp+var_30] +
call edi  +
test al al +
jz loc_10017A6  +
push 0FFFFFFFFh  +
push offset aFs  +
lea ecx [ebp+var_A8] +
call edi  +
test al al +
jz loc_10017A6  +
mov esi ds:?Strcat@WSTRING@@QAEEPBV1@@Z +
lea eax [ebx+310h] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
lea eax [ebp+var_30] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
lea eax [ebp+var_A8] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
lea eax [ebx+328h] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
cmp dword ptr [ebx+34Ch] 0 +
jz loc_10016B4  +
lea eax [ebp+var_30] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
push 0FFFFFFFFh  +
push offset aCvtarea  +
lea ecx [ebp+var_78] +
call edi  +
test al al +
jz loc_10017A6  +
lea eax [ebp+var_78] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
lea eax [ebx+340h] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
cmp byte ptr [ebx+35Ah] 0 +
jz loc_10016F3  +
lea eax [ebp+var_30] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
push 0FFFFFFFFh  +
push offset aNochkdsk  +
lea ecx [ebp+var_60] +
call edi  +
test al al +
jz loc_10017A6  +
lea eax [ebp+var_60] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
cmp byte ptr [ebx+358h] 0 +
jz loc_100172E  +
lea eax [ebp+var_30] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
push 0FFFFFFFFh  +
push offset aV  +
lea ecx [ebp+var_48] +
call edi  +
test al al +
jz loc_10017A6  +
lea eax [ebp+var_48] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
cmp byte ptr [ebx+359h] 0 +
jz loc_1001767  +
lea eax [ebp+var_30] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
push 0FFFFFFFFh  +
push offset aNosecurity  +
lea ecx [ebp+var_90] +
call edi  +
test al al +
jz loc_10017A6  +
lea eax [ebp+var_90] +
push eax  +
lea ecx [ebp+var_18] +
call esi  +
test al al +
jz loc_10017A6  +
lea eax [ebp+var_18] +
push eax  +
call ds:?AddEntry@AUTOREG@@SGEPBVWSTRING@@@Z  +
mov esi ds:??1DSTRING@@UAE@XZ +
lea ecx [ebp+var_90] +
mov bl al +
call esi  +
lea ecx [ebp+var_48] +
call esi  +
lea ecx [ebp+var_60] +
call esi  +
lea ecx [ebp+var_78] +
call esi  +
lea ecx [ebp+var_A8] +
call esi  +
lea ecx [ebp+var_30] +
call esi  +
lea ecx [ebp+var_18] +
call esi  +
mov al bl +
jmp loc_10017D7  +
mov esi ds:??1DSTRING@@UAE@XZ +
lea ecx [ebp+var_90] +
call esi  +
lea ecx [ebp+var_48] +
call esi  +
lea ecx [ebp+var_60] +
call esi  +
lea ecx [ebp+var_78] +
call esi  +
lea ecx [ebp+var_A8] +
call esi  +
lea ecx [ebp+var_30] +
call esi  +
lea ecx [ebp+var_18] +
call esi  +
xor al al +
pop edi  +
pop esi  +
pop ebx  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 30h +
push esi  +
push edi  +
mov edi ds:??0DSTRING@@QAE@XZ +
mov esi ecx +
lea ecx [ebp+var_18] +
call edi  +
lea ecx [ebp+var_30] +
call edi  +
push 0FFFFFFFFh  +
push offset aAutocheckAutoc  +
lea ecx [ebp+var_18] +
call ds:?Initialize@WSTRING@@QAEEPBGK@Z  +
test al al +
jnz loc_1001827  +
mov esi ds:??1DSTRING@@UAE@XZ +
lea ecx [ebp+var_30] +
call esi  +
lea ecx [ebp+var_18] +
call esi  +
xor al al +
pop edi  +
pop esi  +
leave   +
retn   +
mov edi ds:?DeleteEntry@AUTOREG@@SGEPBVWSTRING@@0@Z +
lea eax [esi+310h] +
push eax  +
lea eax [ebp+var_18] +
push eax  +
call edi  +
test al al +
jz loc_1001811  +
push dword ptr [esi+0C0h]  +
push dword ptr [esi+0A8h]  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1001811  +
lea eax [ebp+var_30] +
push eax  +
add esi 0B8h +
push esi  +
call ds:?DosDriveNameToNtDriveName@IFS_SYSTEM@@SGEPBVWSTRING@@PAV2@@Z  +
test al al +
jz loc_1001811  +
push ebx  +
lea eax [ebp+var_30] +
push eax  +
lea eax [ebp+var_18] +
push eax  +
call edi  +
test al al +
jnz loc_1001891  +
xor bl bl +
mov esi ds:??1DSTRING@@UAE@XZ +
lea ecx [ebp+var_30] +
call esi  +
lea ecx [ebp+var_18] +
call esi  +
mov al bl +
pop ebx  +
jmp loc_1001823  +
mov bl 1 +
jmp loc_100187C  +
***
mov edi edi +
push esi  +
push edi  +
mov esi ecx +
call ds:??0PROGRAM@@IAE@XZ  +
mov edi ds:??0DSTRING@@QAE@XZ +
lea ecx [esi+88h] +
mov dword ptr [esi] offset off_10011CC +
call edi  +
lea ecx [esi+0A0h] +
call edi  +
lea ecx [esi+0B8h] +
call edi  +
lea ecx [esi+0D0h] +
call ds:??0PATH@@QAE@XZ  +
lea ecx [esi+310h] +
call edi  +
lea ecx [esi+328h] +
call edi  +
lea ecx [esi+340h] +
call edi  +
mov eax dword_1005018 +
and dword ptr [esi+36Ch] 0 +
and dword ptr [esi+370h] 0 +
mov [esi+4] eax +
pop edi  +
mov eax esi +
pop esi  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
mov esi ecx +
call sub_1001449  +
test byte ptr [ebp+8] 1 +
jz loc_1001928  +
push esi  +
call sub_10013E8  +
pop ecx  +
mov eax esi +
pop esi  +
pop ebp  +
retn 4  +
***
mov edi edi +
push esi  +
push offset aAutoconv_exe  +
mov esi ecx +
call sub_10014AB  +
mov [esi+370h] eax +
mov ecx esi +
test eax eax +
jnz loc_100195F  +
mov eax [esi] +
push 1  +
push 759Eh  +
call dword ptr [eax+0Ch]  +
xor al al +
pop esi  +
retn   +
call sub_10017E1  +
mov ecx esi +
test al al +
jz loc_100194F  +
push ebx  +
call sub_100158A  +
mov bl al +
mov eax [esi] +
test bl bl +
jz loc_1001994  +
lea ecx [esi+88h] +
push ecx  +
push offset dword_10011F8  +
push 0  +
push 759Bh  +
push esi  +
call dword ptr [eax+8]  +
add esp 14h +
jmp loc_10019A0  +
push 1  +
push 759Eh  +
mov ecx esi +
call dword ptr [eax+0Ch]  +
mov al bl +
pop ebx  +
pop esi  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 464h +
mov eax dword_1005000 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
push edi  +
mov edi ds:??0DSTRING@@QAE@XZ +
mov esi ecx +
lea ecx [ebp+var_384] +
call edi  +
lea ecx [ebp+var_3F0] +
call edi  +
lea ecx [ebp+var_3A8] +
call edi  +
lea ecx [ebp+var_420] +
call edi  +
lea ecx [ebp+var_408] +
call edi  +
lea ecx [ebp+var_450] +
call edi  +
lea ecx [ebp+var_3D8] +
call edi  +
lea ecx [ebp+var_438] +
call edi  +
and [ebp+var_368] 0 +
lea ecx [ebp+var_244] +
call ds:??0PATH@@QAE@XZ  +
lea eax [ebp-369h] +
push eax  +
lea ebx [esi+310h] +
push ebx  +
mov [ebp+var_369] 0 +
call ds:?IsArcSystemPartition@IFS_SYSTEM@@SGEPBVWSTRING@@PAE@Z  +
test al al +
jz loc_1001AAE  +
push 1  +
push 75D8h  +
mov eax [esi] +
mov ecx esi +
call dword ptr [eax+0Ch]  +
lea ecx [ebp+var_244] +
call ds:??1PATH@@UAE@XZ  +
mov esi ds:??1DSTRING@@UAE@XZ +
lea ecx [ebp+var_438] +
call esi  +
lea ecx [ebp+var_3D8] +
call esi  +
lea ecx [ebp+var_450] +
call esi  +
lea ecx [ebp+var_408] +
call esi  +
lea ecx [ebp+var_420] +
call esi  +
lea ecx [ebp+var_3A8] +
call esi  +
lea ecx [ebp+var_3F0] +
call esi  +
lea ecx [ebp+var_384] +
call esi  +
push 4  +
pop eax  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_1002C38  +
leave   +
retn   +
push 0  +
lea eax [ebp+var_458] +
push eax  +
lea eax [ebp+var_384] +
push eax  +
push ebx  +
call ds:?QueryFileSystemName@IFS_SYSTEM@@SGEPBVWSTRING@@PAV2@PAJ1@Z  +
test al al +
jnz loc_1001B02  +
cmp [ebp+var_458] 0C0000022h +
mov eax [esi] +
jnz loc_1001AE3  +
push 1  +
push 0BD5h  +
jmp loc_1001A45  +
lea ecx [esi+88h] +
push ecx  +
push offset dword_10011F8  +
push 1  +
push 0BCBh  +
push esi  +
call dword ptr [eax+8]  +
add esp 14h +
jmp loc_1001A4A  +
push [ebp+var_37C]  +
call ds:_wcsupr  +
lea ebx [esi+330h] +
push dword ptr [ebx]  +
call ds:_wcsupr  +
push dword ptr [ebx]  +
push [ebp+var_37C]  +
call ds:_wcsicmp  +
add esp 10h +
test eax eax +
jnz loc_1001B59  +
lea ecx [esi+328h] +
push ecx  +
lea ecx [esi+88h] +
push ecx  +
push offset aWW  +
push 1  +
push 75A1h  +
mov eax [esi] +
push esi  +
call dword ptr [eax+8]  +
add esp 18h +
jmp loc_1001A4A  +
mov ebx ds:?Initialize@WSTRING@@QAEEPBDK@Z +
push 0FFFFFFFFh  +
push offset aFat  +
lea ecx [ebp+var_420] +
call ebx  +
test al al +
jz loc_10022C5  +
push 0FFFFFFFFh  +
push offset aFat32  +
lea ecx [ebp+var_408] +
call ebx  +
test al al +
jz loc_10022C5  +
push [ebp+var_418]  +
push [ebp+var_37C]  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1001BBD  +
push [ebp+var_400]  +
push [ebp+var_37C]  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1001C0A  +
push 0FFFFFFFFh  +
push offset aCnvfat  +
lea ecx [ebp+var_3F0] +
call ebx  +
test al al +
jz loc_10022B9  +
push 0FFFFFFFFh  +
push offset aIsconversionav  +
lea ecx [ebp+var_3A8] +
call ebx  +
test al al +
jz loc_10022B9  +
lea eax [ebp+var_388] +
push eax  +
lea eax [ebp+var_3A8] +
push eax  +
lea eax [ebp+var_3F0] +
push eax  +
call ds:?QueryLibraryEntryPoint@SYSTEM@@SGP6GHXZPBVWSTRING@@0PAPAX@Z  +
test eax eax +
jnz loc_1001C27  +
lea ecx [ebp+var_384] +
push ecx  +
push offset aConvert  +
push offset aSW  +
push 1  +
push 0BCAh  +
jmp loc_1001B4B  +
lea ecx [esi+328h] +
push ecx  +
call eax  +
cmp eax 0FFFFFFFFh +
jnz loc_1001C5A  +
mov ecx [esi] +
lea eax [esi+328h] +
push eax  +
lea eax [ebp+var_384] +
push eax  +
push offset aWW  +
push 1  +
push 759Ah  +
push esi  +
call dword ptr [ecx+8]  +
jmp loc_1001B51  +
mov eax [esi] +
lea ecx [ebp+var_384] +
push ecx  +
push offset dword_10011F8  +
push 0  +
push 0BC7h  +
push esi  +
call dword ptr [eax+8]  +
add esp 14h +
push 0FFFFFFFFh  +
push offset aConvertfat  +
lea ecx [ebp+var_3A8] +
call ebx  +
test al al +
jz loc_10022B9  +
lea eax [ebp+var_388] +
push eax  +
lea eax [ebp+var_3A8] +
push eax  +
lea eax [ebp+var_3F0] +
push eax  +
call ds:?QueryLibraryEntryPoint@SYSTEM@@SGP6GHXZPBVWSTRING@@0PAPAX@Z  +
mov [ebp+var_454] eax +
test eax eax +
jz loc_1001C0A  +
push 1  +
call ds:SetErrorMode  +
mov [ebp+uMode] eax +
lea eax [esi+0A0h] +
push eax  +
call ds:?QueryDriveType@SYSTEM@@SG?AW4DRIVE_TYPE@@PBVWSTRING@@@Z  +
push 0FFFFFFFFh  +
push offset byte_100129B  +
lea ecx [ebp+var_438] +
mov [ebp+var_45C] eax +
call ebx  +
test al al +
jz loc_1001DC3  +
cmp [ebp+var_45C] 1 +
jz loc_1001DC3  +
push 0  +
lea eax [esi+0A0h] +
push eax  +
lea ecx [ebp+var_244] +
call ds:?Initialize@PATH@@QAEEPBVWSTRING@@E@Z  +
test al al +
jz loc_1001DC3  +
lea eax [ebp+var_464] +
push eax  +
lea eax [ebp+var_244] +
push eax  +
call ds:?QueryVolumeLabel@SYSTEM@@SGPAVWSTRING@@PAVPATH@@PAU_VOL_SERIAL_NUMBER@@@Z  +
mov ebx eax +
test ebx ebx +
jz loc_1001DC9  +
push [ebp+var_430]  +
push dword ptr [ebx+8]  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1001DC9  +
mov eax [esi] +
lea ecx [esi+88h] +
push ecx  +
push offset dword_10011F8  +
push 0  +
push 7E5h  +
push esi  +
call dword ptr [eax+8]  +
add esp 14h +
lea ecx [esi+8] +
mov eax [ecx] +
lea edx [ebp+var_3D8] +
push edx  +
call dword ptr [eax+18h]  +
push [ebp+cchCount2]  +
mov eax [ebx+0Ch] +
push [ebp+lpString2]  +
mov ecx [ebx+8] +
push eax  +
push ecx  +
push 1  +
push 400h  +
call ds:CompareStringW  +
cmp eax 2 +
jz loc_1001DC9  +
push [ebp+uMode]  +
call ds:SetErrorMode  +
mov eax [esi] +
push 1  +
push 81Bh  +
mov ecx esi +
call dword ptr [eax+0Ch]  +
mov eax [ebx] +
push 1  +
mov ecx ebx +
call dword ptr [eax]  +
jmp loc_1001A4A  +
mov ebx [ebp+var_368] +
push [ebp+uMode]  +
call ds:SetErrorMode  +
test ebx ebx +
jz loc_1001DE1  +
mov eax [ebx] +
push 1  +
mov ecx ebx +
call dword ptr [eax]  +
lea eax [ebp+var_360] +
push eax  +
push 1  +
mov [ebp+var_361] 0 +
call IsUninstallImageValid  +
test eax eax +
jnz loc_1001E79  +
mov eax [esi] +
push 0  +
push 75F8h  +
mov ecx esi +
call dword ptr [eax+0Ch]  +
lea ecx [esi+8] +
mov eax [ecx] +
push 0  +
call dword ptr [eax+14h]  +
test al al +
jnz loc_1001E72  +
push 4  +
pop ebx  +
mov esi ds:??1DSTRING@@UAE@XZ +
lea ecx [ebp+var_244] +
call ds:??1PATH@@UAE@XZ  +
lea ecx [ebp+var_438] +
call esi  +
lea ecx [ebp+var_3D8] +
call esi  +
lea ecx [ebp+var_450] +
call esi  +
lea ecx [ebp+var_408] +
call esi  +
lea ecx [ebp+var_420] +
call esi  +
lea ecx [ebp+var_3A8] +
call esi  +
lea ecx [ebp+var_3F0] +
call esi  +
lea ecx [ebp+var_384] +
call esi  +
mov eax ebx +
jmp loc_1001A9F  +
mov [ebp+var_361] 1 +
movzx eax byte ptr [esi+35Bh] +
movzx ecx byte ptr [esi+35Ah] +
neg eax  +
sbb eax eax +
and eax 4 +
neg ecx  +
sbb ecx ecx +
and ecx 2 +
or eax ecx +
xor ecx ecx +
cmp [esi+358h] cl +
lea edx [ebp+var_38C] +
setnz cl  +
push edx  +
lea ebx [esi+328h] +
or eax ecx +
movzx ecx byte ptr [esi+359h] +
neg ecx  +
sbb ecx ecx +
and ecx 10h +
or eax ecx +
push eax  +
lea ecx [esi+8] +
push ecx  +
lea eax [esi+340h] +
push eax  +
push ebx  +
lea eax [esi+310h] +
push eax  +
call [ebp+var_454]  +
push [ebp+var_388]  +
mov [ebp+var_36A] al +
call ds:?FreeLibraryHandle@SYSTEM@@SGXPAX@Z  +
cmp [ebp+var_36A] 0 +
jz loc_1002063  +
xor ebx ebx +
mov [ebp+var_368] ebx +
cmp [esi+359h] bl +
jnz loc_1001FAE  +
cmp dword ptr [esi+0ACh] 2 +
jnz loc_1001FAE  +
cmp dword ptr [esi+0ACh] 1 +
jbe loc_1001F30  +
mov eax [esi+0A8h] +
movzx eax word ptr [eax+2] +
jmp loc_1001F35  +
mov eax 0FFFFh +
cmp ax 3Ah +
jnz loc_1001FAE  +
lea ecx [ebp+var_3C0] +
call edi  +
mov eax [esi+0A8h] +
push 0  +
push eax  +
call SceConfigureConvertedFileSecurity  +
mov [ebp+var_368] eax +
test eax eax +
jz loc_1001FA2  +
lea eax [ebp+var_3C0] +
push eax  +
push [ebp+var_368]  +
call ds:?QueryWindowsErrorMessage@SYSTEM@@SGEKPAVWSTRING@@@Z  +
test al al +
mov eax [esi] +
jz loc_1001F89  +
lea ecx [ebp+var_3C0] +
push ecx  +
push offset dword_10011F8  +
push 1  +
push 75F2h  +
jmp loc_1001F9B  +
push [ebp+var_368]  +
push offset aD  +
push 1  +
push 75F3h  +
push esi  +
call dword ptr [eax+8]  +
add esp 14h +
lea ecx [ebp+var_3C0] +
call ds:??1DSTRING@@UAE@XZ  +
xor eax eax +
push eax  +
push eax  +
push eax  +
lea eax [esi+310h] +
push eax  +
call ds:?GenerateLabelNotification@SUPERAREA@@SGJPBVWSTRING@@PAV2@PAU_FILE_FS_SIZE_INFORMATION@@PAU_FILE_FS_VOLUME_INFORMATION@@@Z  +
test eax eax +
jge loc_1001FD5  +
mov eax [esi] +
push 1  +
push 75FAh  +
mov ecx esi +
call dword ptr [eax+0Ch]  +
push 4  +
pop ebx  +
cmp [ebp+var_361] 0 +
jz loc_100203C  +
call RemoveUninstallImage  +
test eax eax +
jnz loc_100203C  +
call ds:GetLastError  +
lea ecx [ebp+var_3C0] +
mov ebx eax +
call edi  +
lea eax [ebp+var_3C0] +
push eax  +
push ebx  +
call ds:?QueryWindowsErrorMessage@SYSTEM@@SGEKPAVWSTRING@@@Z  +
test al al +
mov eax [esi] +
jz loc_1002019  +
lea ecx [ebp+var_3C0] +
push ecx  +
push offset dword_10011F8  +
jmp loc_100201F  +
push ebx  +
push offset aD  +
push 1  +
push 75F9h  +
push esi  +
call dword ptr [eax+8]  +
add esp 14h +
push 4  +
pop ebx  +
lea ecx [ebp+var_3C0] +
call ds:??1DSTRING@@UAE@XZ  +
cmp [ebp+var_368] 0 +
jnz loc_1001E16  +
test ebx ebx +
jnz loc_1001E16  +
mov eax [esi] +
push ebx  +
push 75AEh  +
mov ecx esi +
call dword ptr [eax+0Ch]  +
jmp loc_1001E19  +
mov eax [ebp+var_38C] +
cmp eax 9 +
ja loc_10022A0  +
jmp ds:off_10022DA[eax*4]  +
push ebx  +
lea ecx [esi+88h] +
push ecx  +
push offset aWW  +
push 1  +
push 75B0h  +
mov eax [esi] +
push esi  +
call dword ptr [eax+8]  +
add esp 18h +
jmp loc_1001E16  +
mov eax [esi] +
push ebx  +
push offset dword_10011F8  +
push 1  +
push 7599h  +
push esi  +
call dword ptr [eax+8]  +
add esp 14h +
push 3  +
jmp loc_1001E18  +
mov eax [esi] +
push ebx  +
lea ecx [ebp+var_384] +
push ecx  +
push offset aWW  +
push 1  +
push 759Ah  +
push esi  +
call dword ptr [eax+8]  +
add esp 18h +
push 2  +
jmp loc_1001E18  +
lea ecx [esi+88h] +
push ecx  +
push offset dword_10011F8  +
push 1  +
push 75EBh  +
mov eax [esi] +
push esi  +
call dword ptr [eax+8]  +
add esp 14h +
jmp loc_1001E16  +
lea ecx [esi+88h] +
push ecx  +
push offset dword_10011F8  +
push 1  +
push 75F5h  +
jmp loc_10020EF  +
mov eax [esi] +
lea ecx [esi+88h] +
push ecx  +
push offset dword_10011F8  +
push 0  +
push 75D4h  +
push esi  +
call dword ptr [eax+8]  +
add esp 14h +
lea ecx [esi+8] +
mov eax [ecx] +
push 0  +
call dword ptr [eax+14h]  +
test al al +
jz loc_1001E16  +
mov ecx esi +
call sub_1001934  +
test al al +
jz loc_1001E16  +
cmp byte ptr [esi+359h] 0 +
jnz loc_10021F8  +
cmp dword ptr [esi+0ACh] 2 +
jnz loc_10021F8  +
cmp dword ptr [esi+0ACh] 1 +
jbe loc_100217E  +
mov eax [esi+0A8h] +
movzx eax word ptr [eax+2] +
jmp loc_1002183  +
mov eax 0FFFFh +
cmp ax 3Ah +
jnz loc_10021F8  +
lea ecx [ebp+var_3C0] +
call edi  +
mov eax [esi+0A8h] +
push 1  +
push eax  +
call SceConfigureConvertedFileSecurity  +
mov ebx eax +
test ebx ebx +
jz loc_10021E7  +
lea eax [ebp+var_3C0] +
push eax  +
push ebx  +
call ds:?QueryWindowsErrorMessage@SYSTEM@@SGEKPAVWSTRING@@@Z  +
test al al +
mov eax [esi] +
jz loc_10021CE  +
lea ecx [ebp+var_3C0] +
push ecx  +
push offset dword_10011F8  +
push 1  +
push 75F2h  +
jmp loc_10021DB  +
push ebx  +
push offset aD  +
push 1  +
push 75F4h  +
push esi  +
call dword ptr [eax+8]  +
add esp 14h +
push 4  +
pop ebx  +
jmp loc_10021EA  +
xor ebx ebx +
inc ebx  +
lea ecx [ebp+var_3C0] +
call ds:??1DSTRING@@UAE@XZ  +
jmp loc_10021FB  +
xor ebx ebx +
inc ebx  +
cmp [ebp+var_361] 0 +
jz loc_1001E19  +
call RemoveUninstallImage  +
test eax eax +
jnz loc_1001E19  +
call ds:GetLastError  +
lea ecx [ebp+var_3C0] +
mov ebx eax +
call edi  +
lea eax [ebp+var_3C0] +
push eax  +
push ebx  +
call ds:?QueryWindowsErrorMessage@SYSTEM@@SGEKPAVWSTRING@@@Z  +
test al al +
mov eax [esi] +
jz loc_1002247  +
lea ecx [ebp+var_3C0] +
push ecx  +
push offset dword_10011F8  +
jmp loc_100224D  +
push ebx  +
push offset aD  +
push 1  +
push 75F9h  +
push esi  +
call dword ptr [eax+8]  +
add esp 14h +
push 4  +
pop ebx  +
lea ecx [ebp+var_3C0] +
call ds:??1DSTRING@@UAE@XZ  +
jmp loc_1001E19  +
mov eax [esi] +
push ebx  +
lea ecx [esi+88h] +
push ecx  +
push offset aWW  +
push 1  +
push 75AFh  +
push esi  +
call dword ptr [eax+8]  +
xor ebx ebx +
add esp 18h +
cmp [ebp+var_38C] 8 +
setz bl  +
add ebx 4 +
jmp loc_1001E19  +
push ebx  +
lea ecx [esi+88h] +
push ecx  +
push offset aWW  +
push 1  +
push 75AFh  +
jmp loc_100208D  +
push 1  +
push 75C8h  +
jmp loc_1001A43  +
mov eax [esi] +
push 1  +
push 75C8h  +
mov ecx esi +
call dword ptr [eax+0Ch]  +
jmp loc_1001E16  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 2CCh +
push ebx  +
push esi  +
push edi  +
mov edi ds:??0ARRAY@@QAE@XZ +
mov esi ecx +
lea ecx [ebp+var_18] +
call edi  +
lea ecx [ebp+var_30] +
call edi  +
lea ecx [ebp+var_2CC] +
call ds:??0ARGUMENT_LEXEMIZER@@QAE@XZ  +
mov edi ds:??0STRING_ARGUMENT@@QAE@XZ +
lea ecx [ebp+var_B4] +
call edi  +
lea ecx [ebp+var_E0] +
call edi  +
lea ecx [ebp+var_88] +
call edi  +
lea ecx [ebp+var_5C] +
call edi  +
mov edi ds:??0FLAG_ARGUMENT@@QAE@XZ +
lea ecx [ebp+var_1A0] +
call edi  +
lea ecx [ebp+var_140] +
call edi  +
lea ecx [ebp+var_110] +
call edi  +
lea ecx [ebp+var_170] +
call edi  +
lea ecx [ebp+var_1D0] +
call edi  +
mov edi ds:?Initialize@ARRAY@@QAEEKK@Z +
push 1  +
push 7  +
lea ecx [ebp+var_18] +
call edi  +
test al al +
jz loc_1002717  +
push 1  +
push 7  +
lea ecx [ebp+var_30] +
call edi  +
test al al +
jz loc_1002717  +
lea eax [ebp+var_30] +
push eax  +
lea ecx [ebp+var_2CC] +
call ds:?Initialize@ARGUMENT_LEXEMIZER@@QAEEPAVARRAY@@@Z  +
test al al +
jz loc_1002717  +
mov ebx ds:?Initialize@STRING_ARGUMENT@@QAEEPAD@Z +
push offset asc_1001328  +
lea ecx [ebp+var_B4] +
call ebx  +
test al al +
jz loc_1002717  +
mov edi ds:?Initialize@FLAG_ARGUMENT@@QAEEPAD@Z +
push offset a?  +
lea ecx [ebp+var_1A0] +
call edi  +
test al al +
jz loc_1002717  +
push offset aV_0  +
lea ecx [ebp+var_140] +
call edi  +
test al al +
jz loc_1002717  +
push offset aNosecurity_0  +
lea ecx [ebp+var_110] +
call edi  +
test al al +
jz loc_1002717  +
push offset aNochkdsk_0  +
lea ecx [ebp+var_170] +
call edi  +
test al al +
jz loc_1002717  +
push offset asc_1001304  +
lea ecx [ebp+var_1D0] +
call edi  +
test al al +
jz loc_1002717  +
push offset asc_1001328  +
lea ecx [ebp+var_E0] +
call ebx  +
test al al +
jz loc_1002717  +
push offset aFs_0  +
lea ecx [ebp+var_88] +
call ebx  +
test al al +
jz loc_1002717  +
push offset aCvtarea_0  +
lea ecx [ebp+var_5C] +
call ebx  +
test al al +
jz loc_1002717  +
push 0  +
lea ecx [ebp+var_2CC] +
call ds:?SetCaseSensitive@ARGUMENT_LEXEMIZER@@QAEXE@Z  +
mov edi ds:?Put@ARRAY@@UAEEPAVOBJECT@@@Z +
lea eax [ebp+var_E0] +
push eax  +
lea ecx [ebp+var_18] +
call edi  +
test al al +
jz loc_1002717  +
lea eax [ebp+var_1A0] +
push eax  +
lea ecx [ebp+var_18] +
call edi  +
test al al +
jz loc_1002717  +
lea eax [ebp+var_B4] +
push eax  +
lea ecx [ebp+var_18] +
call edi  +
test al al +
jz loc_1002717  +
lea eax [ebp+var_140] +
push eax  +
lea ecx [ebp+var_18] +
call edi  +
test al al +
jz loc_1002717  +
lea eax [ebp+var_110] +
push eax  +
lea ecx [ebp+var_18] +
call edi  +
test al al +
jz loc_1002717  +
lea eax [ebp+var_170] +
push eax  +
lea ecx [ebp+var_18] +
call edi  +
test al al +
jz loc_1002717  +
lea eax [ebp+var_1D0] +
push eax  +
lea ecx [ebp+var_18] +
call edi  +
test al al +
jz loc_1002717  +
lea eax [ebp+var_88] +
push eax  +
lea ecx [ebp+var_18] +
call edi  +
test al al +
jz loc_1002717  +
lea eax [ebp+var_5C] +
push eax  +
lea ecx [ebp+var_18] +
call edi  +
test al al +
jz loc_1002717  +
push [ebp+arg_0]  +
lea ecx [ebp+var_2CC] +
call ds:?PrepareToParse@ARGUMENT_LEXEMIZER@@QAEEPAVWSTRING@@@Z  +
test al al +
jz loc_1002717  +
lea eax [ebp+var_18] +
push eax  +
lea ecx [ebp+var_2CC] +
call ds:?DoParsing@ARGUMENT_LEXEMIZER@@QAEEPAVARRAY@@@Z  +
test al al +
jnz loc_10025BC  +
cmp [ebp+arg_4] al +
jz loc_100272B  +
lea ecx [ebp+var_2CC] +
call ds:?QueryInvalidArgument@ARGUMENT_LEXEMIZER@@QAEPAVWSTRING@@XZ  +
mov edi eax +
mov eax [esi] +
push edi  +
push offset dword_10011F8  +
push 1  +
push 7595h  +
push esi  +
call dword ptr [eax+8]  +
add esp 14h +
test edi edi +
jz loc_100272B  +
mov eax [edi] +
push 1  +
mov ecx edi +
call dword ptr [eax]  +
jmp loc_100272B  +
mov al [ebp+var_174] +
mov [esi+35Ch] al +
mov al [ebp+var_114] +
mov [esi+358h] al +
mov al [ebp+var_E4] +
mov [esi+359h] al +
mov al [ebp+var_144] +
mov [esi+35Ah] al +
mov al [ebp+var_1A4] +
lea ecx [ebp+var_B4] +
mov [esi+35Bh] al +
mov byte ptr [esi+35Dh] 0 +
call ds:?IsValueSet@ARGUMENT@@QAEEXZ  +
mov edi ds:?Initialize@WSTRING@@QAEEPBV1@KK@Z +
mov ebx ds:?Initialize@WSTRING@@QAEEPBGK@Z +
push 0FFFFFFFFh  +
lea ecx [esi+0A0h] +
test al al +
jz loc_1002681  +
push 0  +
push [ebp+var_8C]  +
call edi  +
test al al +
jz loc_100272B  +
lea ecx [ebp+var_88] +
call ds:?IsValueSet@ARGUMENT@@QAEEXZ  +
push 0FFFFFFFFh  +
lea ecx [esi+328h] +
test al al +
jz loc_100268A  +
push 0  +
push [ebp+var_60]  +
call edi  +
test al al +
jz loc_100272B  +
lea ecx [ebp+var_5C] +
call ds:?IsValueSet@ARGUMENT@@QAEEXZ  +
push 0FFFFFFFFh  +
lea ecx [esi+340h] +
test al al +
jz loc_1002693  +
push 0  +
push [ebp+var_34]  +
call edi  +
test al al +
jnz loc_100269A  +
jmp loc_100272B  +
push offset dword_10012EC  +
call ebx  +
jmp loc_100262D  +
push offset dword_10012EC  +
call ebx  +
jmp loc_1002654  +
push offset dword_10012EC  +
call ebx  +
lea ecx [ebp+var_1D0] +
call sub_100156E  +
lea ecx [ebp+var_170] +
call sub_100156E  +
lea ecx [ebp+var_110] +
call sub_100156E  +
lea ecx [ebp+var_140] +
call sub_100156E  +
lea ecx [ebp+var_1A0] +
call sub_100156E  +
mov esi ds:??1STRING_ARGUMENT@@UAE@XZ +
lea ecx [ebp+var_5C] +
call esi  +
lea ecx [ebp+var_88] +
call esi  +
lea ecx [ebp+var_E0] +
call esi  +
lea ecx [ebp+var_B4] +
call esi  +
lea ecx [ebp+var_2CC] +
call ds:??1ARGUMENT_LEXEMIZER@@UAE@XZ  +
mov esi ds:??1ARRAY@@UAE@XZ +
lea ecx [ebp+var_30] +
call esi  +
lea ecx [ebp+var_18] +
call esi  +
mov al 1 +
jmp loc_10027A3  +
cmp [ebp+arg_4] 0 +
jz loc_100272B  +
mov eax [esi] +
push 1  +
push 75C8h  +
mov ecx esi +
call dword ptr [eax+0Ch]  +
lea ecx [ebp+var_1D0] +
call sub_100156E  +
lea ecx [ebp+var_170] +
call sub_100156E  +
lea ecx [ebp+var_110] +
call sub_100156E  +
lea ecx [ebp+var_140] +
call sub_100156E  +
lea ecx [ebp+var_1A0] +
call sub_100156E  +
mov esi ds:??1STRING_ARGUMENT@@UAE@XZ +
lea ecx [ebp+var_5C] +
call esi  +
lea ecx [ebp+var_88] +
call esi  +
lea ecx [ebp+var_E0] +
call esi  +
lea ecx [ebp+var_B4] +
call esi  +
lea ecx [ebp+var_2CC] +
call ds:??1ARGUMENT_LEXEMIZER@@UAE@XZ  +
mov esi ds:??1ARRAY@@UAE@XZ +
lea ecx [ebp+var_30] +
call esi  +
lea ecx [ebp+var_18] +
call esi  +
xor al al +
pop edi  +
pop esi  +
pop ebx  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 25Ch +
mov eax dword_1005000 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
mov esi ecx +
push edi  +
mov edi [ebp+arg_0] +
lea ecx [ebp+var_244] +
call ds:??0PATH@@QAE@XZ  +
lea ecx [ebp+var_25C] +
call ds:??0DSTRING@@QAE@XZ  +
push 1  +
xor ebx ebx +
push ebx  +
mov ecx esi +
call sub_1002307  +
test al al +
jnz loc_10027FF  +
mov dword ptr [edi] 4 +
jmp loc_10029CE  +
cmp [esi+35Ch] bl +
jz loc_1002812  +
push ebx  +
push 7594h  +
jmp loc_10029C5  +
cmp [esi+0ACh] ebx +
jnz loc_100283B  +
lea eax [esi+0A0h] +
push eax  +
call ds:?QueryCurrentDosDriveName@SYSTEM@@SGEPAVWSTRING@@@Z  +
test al al +
jnz loc_100283B  +
push 1  +
push 75C8h  +
mov eax [esi] +
mov ecx esi +
call dword ptr [eax+0Ch]  +
jmp loc_10027F4  +
lea eax [esi+0A0h] +
push ebx  +
push eax  +
lea ecx [ebp+var_244] +
call ds:?Initialize@PATH@@QAEEPBVWSTRING@@E@Z  +
test al al +
jz loc_100282B  +
lea ecx [ebp+var_25C] +
push ecx  +
lea ecx [esi+0D0h] +
push ecx  +
lea eax [esi+0B8h] +
push eax  +
lea ecx [ebp+var_244] +
call ds:?AnalyzePath@PATH@@QAE?AW4PATH_ANALYZE_CODE@@PAVWSTRING@@PAV1@0@Z  +
push 4  +
pop ebx  +
test eax eax +
jl loc_10029BE  +
xor ecx ecx +
inc ecx  +
cmp eax ecx +
jle loc_10028A1  +
cmp eax 2 +
jz loc_100289E  +
cmp eax ebx +
jnz loc_10029BE  +
push ecx  +
push 8ADh  +
jmp loc_10029C5  +
push ecx  +
jmp loc_100282D  +
cmp [ebp+var_250] 0 +
jz loc_10028B2  +
push ecx  +
push 7597h  +
jmp loc_1002832  +
lea ecx [ebp+var_244] +
call ds:?IsGuidVolName@PATH@@QAEEXZ  +
mov ebx ds:?Initialize@WSTRING@@QAEEPBV1@KK@Z +
push 0FFFFFFFFh  +
lea ecx [esi+88h] +
push 0  +
test al al +
jz loc_1002901  +
lea eax [esi+0B8h] +
push eax  +
call ebx  +
test al al +
jz loc_100282B  +
cmp dword ptr [esi+2ECh] 2 +
jnz loc_1002962  +
lea eax [esi+2E0h] +
cmp dword ptr [eax+0Ch] 1 +
jbe loc_1002909  +
mov ecx [eax+8] +
movzx ecx word ptr [ecx+2] +
jmp loc_100290E  +
lea eax [esi+2E0h] +
jmp loc_10028D8  +
mov ecx 0FFFFh +
cmp cx 3Ah +
jnz loc_1002962  +
push 0FFFFFFFFh  +
push 0  +
push eax  +
lea ecx [esi+0A0h] +
call ebx  +
test al al +
jz loc_100282B  +
lea ebx [esi+0A0h] +
push dword ptr [ebx+8]  +
call ds:_wcsupr  +
pop ecx  +
push ebx  +
call ds:?QueryDriveType@SYSTEM@@SG?AW4DRIVE_TYPE@@PBVWSTRING@@@Z  +
sub eax 0 +
jz loc_10029B7  +
sub eax 3 +
jz loc_10029AB  +
dec eax  +
jz loc_100299F  +
cmp dword ptr [esi+334h] 0 +
jnz loc_100296A  +
push 1  +
push 7596h  +
jmp loc_1002832  +
lea eax [esi+0B8h] +
jmp loc_1002914  +
lea eax [esi+310h] +
push eax  +
push ebx  +
call ds:?DosDriveNameToNtDriveName@IFS_SYSTEM@@SGEPBVWSTRING@@PAV2@@Z  +
test al al +
jz loc_100282B  +
and dword ptr [edi] 0 +
lea ecx [ebp+var_25C] +
call ds:??1DSTRING@@UAE@XZ  +
lea ecx [ebp+var_244] +
call ds:??1PATH@@UAE@XZ  +
mov al 1 +
jmp loc_10029E8  +
push 1  +
push 75F6h  +
jmp loc_1002832  +
push 1  +
push 7598h  +
jmp loc_1002832  +
push 1  +
jmp loc_10028AB  +
push 1  +
push 7597h  +
mov eax [esi] +
mov ecx esi +
call dword ptr [eax+0Ch]  +
mov [edi] ebx +
lea ecx [ebp+var_25C] +
call ds:??1DSTRING@@UAE@XZ  +
lea ecx [ebp+var_244] +
call ds:??1PATH@@UAE@XZ  +
xor al al +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_1002C38  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
mov esi ecx +
call sub_1001411  +
push 1  +
push 7531h  +
push 7594h  +
mov ecx esi +
call ds:?Initialize@PROGRAM@@QAEEKKK@Z  +
test al al +
jz loc_1002A2F  +
push [ebp+arg_0]  +
mov ecx esi +
call sub_10027AF  +
jmp loc_1002A3A  +
mov eax [ebp+arg_0] +
mov dword ptr [eax] 4 +
xor al al +
pop esi  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 380h +
mov eax dword_1005000 +
xor eax ebp +
mov [ebp+var_4] eax +
push 0  +
push 0  +
push 1  +
push 0  +
mov [ebp+var_380] 4 +
call ds:HeapSetInformation  +
push 4  +
call sub_10013C5  +
pop ecx  +
test eax eax +
jz loc_1002A87  +
mov ecx eax +
call ds:??0CLASS_DESCRIPTOR@@QAE@XZ  +
jmp loc_1002A89  +
xor eax eax +
mov dword_1005018 eax +
test eax eax +
jz loc_1002A9A  +
mov ecx eax +
call ds:?Initialize@CLASS_DESCRIPTOR@@QAEEXZ  +
lea ecx [ebp+var_37C] +
call sub_100189A  +
lea eax [ebp+var_380] +
push eax  +
lea ecx [ebp+var_37C] +
call sub_10029FE  +
test al al +
jz loc_1002ACC  +
lea ecx [ebp+var_37C] +
call sub_10019AA  +
mov [ebp+var_380] eax +
lea ecx [ebp+var_37C] +
call sub_1001449  +
mov ecx [ebp+var_4] +
mov eax [ebp+var_380] +
xor ecx ebp +
call sub_1002C38  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push ecx  +
mov dword_1005120 eax +
mov dword_100511C ecx +
mov dword_1005118 edx +
mov dword_1005114 ebx +
mov dword_1005110 esi +
mov dword_100510C edi +
mov word_1005138 ss +
mov word_100512C cs +
mov word_1005108 ds +
mov word_1005104 es +
mov word_1005100 fs +
mov word_10050FC gs +
pushf   +
pop dword_1005130  +
mov eax [ebp+0] +
mov dword_1005124 eax +
mov eax [ebp+4] +
mov dword_1005128 eax +
lea eax [ebp+8] +
mov dword_1005134 eax +
mov eax dword_1005128 +
mov dword_100502C eax +
mov eax dword_1005000 +
mov dword_1005070 10001h +
mov dword_1005020 0C0000409h +
mov dword_1005024 1 +
mov [ebp-8] eax +
mov eax dword_1005004 +
push offset off_100132C  +
mov [ebp-4] eax +
call RtlUnhandledExceptionFilter  +
push 0C0000409h  +
push 0FFFFFFFFh  +
call NtTerminateProcess  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
jmp loc_1002BBF  +
pause   +
mov ecx ds:7FFE0324h +
mov edx ds:7FFE0320h +
mov eax ds:7FFE0328h +
cmp ecx eax +
jnz loc_1002BBD  +
mov eax ds:7FFE0004h +
mul  edx +
shl ecx 8 +
imul ecx ds:7FFE0004h +
shrd eax edx +
add eax ecx +
mov ecx [ebp+arg_0] +
shr edx 18h +
xor eax ecx +
mov [ecx] eax +
jz loc_1002BFE  +
cmp eax 0BB40E64Eh +
jnz loc_1002C04  +
mov dword ptr [ecx] 0BB40E64Fh +
pop ebp  +
retn   +
***
mov eax dword_1005000 +
test eax eax +
jz loc_1002C1B  +
cmp eax 0BB40E64Eh +
jnz loc_1002C2B  +
push offset dword_1005000  +
call sub_1002BB6  +
mov eax dword_1005000 +
pop ecx  +
not eax  +
mov dword_1005004 eax +
retn   +
***
cmp ecx dword_1005000 +
jnz loc_1002C43  +
retn 0  +
jmp loc_1002AEE  +
***
jmp ds:?Compare@OBJECT@@UBEJPBV1@@Z  +
***
jmp ds:?DisplayMessage@PROGRAM@@UBAEKW4MESSAGE_TYPE@@PADZZ  +
***
jmp ds:?DisplayMessage@PROGRAM@@UBEEKW4MESSAGE_TYPE@@@Z  +
***
jmp ds:?Fatal@PROGRAM@@UBAXKKPADZZ  +
***
jmp ds:?Fatal@PROGRAM@@UBEXXZ  +
***
jmp ds:?GetStandardInput@PROGRAM@@UAEPAVSTREAM@@XZ  +
***
jmp ds:?GetStandardOutput@PROGRAM@@UAEPAVSTREAM@@XZ  +
***
jmp ds:?GetStandardError@PROGRAM@@UAEPAVSTREAM@@XZ  +
***
jmp ds:?Usage@PROGRAM@@UBEXXZ  +
***
jmp ds:?ValidateVersion@PROGRAM@@UBEXKK@Z  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
mov esi [ebp+arg_0] +
xor eax eax +
jmp loc_1002D1D  +
test eax eax +
jnz loc_1002D22  +
mov ecx [esi] +
test ecx ecx +
jz loc_1002D1A  +
call ecx  +
add esi 4 +
cmp esi [ebp+arg_4] +
jb loc_1002D0E  +
pop esi  +
pop ebp  +
retn   +
***
mov eax dword_1005360 +
push offset dword_1005350  +
push dword_100535C  +
mov dword_1005350 eax +
push offset dword_1005340  +
push offset dword_1005344  +
push offset dword_100533C  +
call ds:__getmainargs  +
add esp 14h +
mov dword_100534C eax +
retn   +
***
call __SEH_prolog4  +
xor ebx ebx +
mov [ebp+ms_exc.disabled] ebx +
mov eax large fs:18h +
mov esi [eax+4] +
mov [ebp+var_1C] ebx +
mov edi offset Destination +
push ebx  +
push esi  +
push edi  +
call ds:InterlockedCompareExchange  +
cmp eax ebx +
jz loc_1002DAA  +
cmp eax esi +
jnz loc_1002D9D  +
xor esi esi +
inc esi  +
mov [ebp+var_1C] esi +
jmp loc_1002DAD  +
push 3E8h  +
call ds:Sleep  +
jmp loc_1002D84  +
xor esi esi +
inc esi  +
mov eax dword_1005374 +
cmp eax esi +
jnz loc_1002DC0  +
push 1Fh  +
call _amsg_exit  +
pop ecx  +
jmp loc_1002DFB  +
mov eax dword_1005374 +
test eax eax +
jnz loc_1002DF5  +
mov dword_1005374 esi +
push offset dword_10011A0  +
push offset dword_1001194  +
call sub_1002D01  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1002DFB  +
mov [ebp+ms_exc.disabled] 0FFFFFFFEh +
mov eax 0FFh +
jmp loc_1002EC5  +
mov dword_1005358 esi +
mov eax dword_1005374 +
cmp eax esi +
jnz loc_1002E1F  +
push offset dword_1001190  +
push offset dword_1001188  +
call _initterm  +
pop ecx  +
pop ecx  +
mov dword_1005374 2 +
cmp [ebp+var_1C] ebx +
jnz loc_1002E2C  +
push ebx  +
push edi  +
call ds:InterlockedExchange  +
cmp dword_100537C ebx +
jz loc_1002E4D  +
push offset dword_100537C  +
call sub_1003099  +
pop ecx  +
test eax eax +
jz loc_1002E4D  +
push ebx  +
push 2  +
push ebx  +
call dword_100537C  +
push dword_1005340  +
push dword_1005344  +
push dword_100533C  +
call sub_1002A44  +
add esp 0Ch +
mov dword_1005354 eax +
cmp dword_1005348 ebx +
jnz loc_1002EAB  +
push eax  +
call ds:exit  +
mov eax [ebp-14h] +
mov ecx [eax] +
mov ecx [ecx] +
mov [ebp-20h] ecx +
push eax  +
push ecx  +
call _XcptFilter  +
pop ecx  +
pop ecx  +
retn   +
mov esp [ebp-18h] +
mov eax [ebp-20h] +
mov dword_1005354 eax +
xor ebx ebx +
cmp dword_1005348 ebx +
jnz loc_1002EAB  +
push eax  +
call ds:_exit  +
cmp dword_1005358 ebx +
jnz loc_1002EB9  +
call ds:_cexit  +
mov [ebp+ms_exc.disabled] 0FFFFFFFEh +
mov eax dword_1005354 +
call __SEH_epilog4  +
retn   +
***
mov eax 5A4Dh +
cmp ds:1000000h ax +
jz loc_1002EE2  +
xor eax eax +
jmp loc_1002F2F  +
mov eax ds:100003Ch +
lea eax [eax+1000000h] +
cmp dword ptr [eax] 4550h +
jnz loc_1002EDE  +
movzx ecx word ptr [eax+18h] +
cmp ecx 10Bh +
jz loc_1002F1C  +
cmp ecx 20Bh +
jnz loc_1002EDE  +
cmp dword ptr [eax+84h] 0Eh +
jbe loc_1002EDE  +
xor ecx ecx +
cmp [eax+0F8h] ecx +
jmp loc_1002F2A  +
cmp dword ptr [eax+74h] 0Eh +
jbe loc_1002EDE  +
xor ecx ecx +
cmp [eax+0E8h] ecx +
setnz cl  +
mov eax ecx +
push 1  +
mov dword_1005348 eax +
call sub_1003232  +
push eax  +
call ds:__set_app_type  +
or dword_100536C 0FFFFFFFFh +
or dword_1005370 0FFFFFFFFh +
pop ecx  +
pop ecx  +
call ds:__p__fmode  +
mov ecx dword_1005368 +
mov [eax] ecx +
call ds:__p__commode  +
mov ecx dword_1005364 +
mov [eax] ecx +
call sub_10031C4  +
cmp dword_1005010 0 +
jnz loc_1002F88  +
push offset sub_10031C4  +
call ds:__setusermatherr  +
pop ecx  +
call sub_10031AC  +
xor eax eax +
retn   +
***
call sub_1002C0B  +
jmp sub_1002D62  +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov eax [ebp+8] +
mov eax [eax] +
cmp dword ptr [eax] 0E06D7363h +
jnz loc_1002FE1  +
cmp dword ptr [eax+10h] 3 +
jnz loc_1002FE1  +
mov eax [eax+14h] +
cmp eax 19930520h +
jz loc_1002FDB  +
cmp eax 19930521h +
jz loc_1002FDB  +
cmp eax 19930522h +
jz loc_1002FDB  +
cmp eax 1994000h +
jnz loc_1002FE1  +
call ds:?terminate@@YAXXZ  +
xor eax eax +
pop ebp  +
retn 4  +
***
push offset loc_1002FA4  +
call ds:SetUnhandledExceptionFilter  +
xor eax eax +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov ecx [ebp+arg_0] +
mov eax 5A4Dh +
cmp [ecx] ax +
jz loc_1003026  +
xor eax eax +
pop ebp  +
retn   +
mov eax [ecx+3Ch] +
add eax ecx +
cmp dword ptr [eax] 4550h +
jnz loc_1003022  +
xor edx edx +
mov ecx 10Bh +
cmp [eax+18h] cx +
setz dl  +
mov eax edx +
pop ebp  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov eax [ebp+arg_0] +
mov ecx [eax+3Ch] +
add ecx eax +
movzx eax word ptr [ecx+14h] +
push ebx  +
push esi  +
movzx esi word ptr [ecx+6] +
xor edx edx +
push edi  +
lea eax [eax+ecx+18h] +
test esi esi +
jbe loc_100308D  +
mov edi [ebp+arg_4] +
mov ecx [eax+0Ch] +
cmp edi ecx +
jb loc_1003085  +
mov ebx [eax+8] +
add ebx ecx +
cmp edi ebx +
jb loc_100308F  +
inc edx  +
add eax 28h +
cmp edx esi +
jb loc_1003075  +
xor eax eax +
pop edi  +
pop esi  +
pop ebx  +
pop ebp  +
retn   +
***
call __SEH_prolog4  +
and [ebp+ms_exc.disabled] 0 +
mov esi 1000000h +
push esi  +
call sub_1003010  +
pop ecx  +
test eax eax +
jz loc_10030F6  +
mov eax [ebp+arg_0] +
sub eax esi +
push eax  +
push esi  +
call sub_1003050  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_10030F6  +
mov eax [eax+24h] +
shr eax 1Fh +
not eax  +
and eax 1 +
mov [ebp+ms_exc.disabled] 0FFFFFFFEh +
jmp loc_10030FF  +
mov eax [ebp-14h] +
mov eax [eax] +
mov eax [eax] +
xor ecx ecx +
cmp eax 0C0000005h +
setz cl  +
mov eax ecx +
retn   +
mov esp [ebp-18h] +
mov [ebp+ms_exc.disabled] 0FFFFFFFEh +
xor eax eax +
call __SEH_epilog4  +
retn   +
***
mov eax [esp+8+arg_4] +
mov ecx [ebp-10h] +
mov large fs:0 ecx +
pop ecx  +
pop edi  +
pop edi  +
pop esi  +
pop ebx  +
mov esp ebp +
pop ebp  +
push ecx  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push dword ptr [ebp+14h]  +
push dword ptr [ebp+10h]  +
push dword ptr [ebp+0Ch]  +
push dword ptr [ebp+8]  +
push offset sub_1002C38  +
push offset dword_1005000  +
call _except_handler4_common  +
add esp 18h +
pop ebp  +
retn   +
***
call ds:_controlfp  +
pop ecx  +
pop ecx  +
retn   +
***
retn   +
***
call __SEH_prolog4  +
xor eax eax +
mov ecx [ebp+arg_0] +
test ecx ecx +
jz loc_1003225  +
cmp ecx 0FFFFFFFFh +
jz loc_1003225  +
and [ebp+ms_exc.disabled] eax +
mov edx 5A4Dh +
cmp [ecx] dx +
jnz loc_100321E  +
mov edx [ecx+3Ch] +
test edx edx +
jl loc_100321E  +
cmp edx 10000000h +
jnb loc_100321E  +
lea eax [edx+ecx] +
mov [ebp+var_1C] eax +
cmp dword ptr [eax] 4550h +
jz loc_100321E  +
jmp loc_1003219  +
xor eax eax +
inc eax  +
retn   +
mov esp [ebp-18h] +
xor eax eax +
mov [ebp+var_1C] eax +
mov [ebp+ms_exc.disabled] 0FFFFFFFEh +
call __SEH_epilog4  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push 0  +
call ds:GetModuleHandleA  +
test eax eax +
jz loc_1003267  +
push eax  +
call sub_10031CC  +
test eax eax +
jz loc_1003267  +
movzx eax word ptr [eax+5Ch] +
cmp ax 2 +
jnz loc_100325C  +
push 2  +
pop eax  +
pop ebp  +
retn   +
cmp ax 3 +
jnz loc_1003267  +
xor eax eax +
inc eax  +
pop ebp  +
retn   +
mov eax [ebp+arg_0] +
pop ebp  +
retn   +
***
