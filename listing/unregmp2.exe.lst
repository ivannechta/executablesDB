scas   +
mov ah 0E2h +
inc ebp  +
retn   +
***
retn 0  +
***
retn 0  +
***
retn   +
***
retf 0  +
***
retf   +
***
push 68000001h  +
retf   +
***
imul eax [ecx] +
add al bh +
retf 100h  +
***
mov eax 0FFFh +
cmp [ecx] ax +
jnz loc_1026EE5  +
push 8  +
pop eax  +
mov [ecx] ax +
push ecx  +
call ds:VariantClear  +
retn   +
***
mov edi edi +
push esi  +
mov esi eax +
xor eax eax +
mov ecx edx +
test edx edx +
jz loc_1026F0D  +
cmp [esi] ax +
jz loc_1026F09  +
inc esi  +
inc esi  +
dec edx  +
jnz loc_1026EFF  +
test edx edx +
jnz loc_1026F12  +
mov eax 80070057h +
pop esi  +
test edi edi +
jz locret_1026F23  +
test eax eax +
jl loc_1026F20  +
sub ecx edx +
mov [edi] ecx +
retn   +
and dword ptr [edi] 0 +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
xor eax eax +
test ecx ecx +
jz loc_1026F39  +
cmp ecx [ebp+arg_0] +
jbe loc_1026F3E  +
mov eax 80070057h +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push edi  +
push [ebp+arg_4]  +
mov ecx edx +
mov edi eax +
call sub_1026F29  +
test eax eax +
jl loc_1026F67  +
mov eax [ebp+arg_0] +
call sub_1026EF2  +
jmp loc_1026F6A  +
and dword ptr [edi] 0 +
pop edi  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ebx  +
push esi  +
push edi  +
mov ebx eax +
mov esi edx +
xor eax eax +
xor edi edi +
test esi esi +
jz loc_1026FA9  +
cmp [ebp+arg_4] eax +
jz loc_1026FA5  +
movzx edx word ptr [ebx] +
test dx dx +
jz loc_1026FA5  +
mov [ecx] dx +
inc ecx  +
inc ecx  +
inc ebx  +
inc ebx  +
dec esi  +
dec [ebp+arg_4]  +
inc edi  +
test esi esi +
jnz loc_1026F88  +
test esi esi +
jnz loc_1026FB1  +
dec ecx  +
dec ecx  +
dec edi  +
mov eax 8007007Ah +
xor edx edx +
mov [ecx] dx +
mov ecx [ebp+arg_0] +
test ecx ecx +
jz loc_1026FBF  +
mov [ecx] edi +
pop edi  +
pop esi  +
pop ebx  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ebx  +
push esi  +
push [ebp+arg_8]  +
mov esi eax +
push [ebp+arg_4]  +
xor ebx ebx +
dec esi  +
push esi  +
push edi  +
call ds:_vsnwprintf  +
add esp 10h +
test eax eax +
jl loc_1026FF4  +
cmp eax esi +
ja loc_1026FF4  +
jz loc_1026FF9  +
jmp loc_1027001  +
mov ebx 8007007Ah +
xor eax eax +
mov [edi+esi*2] ax +
mov eax esi +
mov ecx [ebp+arg_0] +
test ecx ecx +
jz loc_102700A  +
mov [ecx] eax +
pop esi  +
mov eax ebx +
pop ebx  +
pop ebp  +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 438h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
push edi  +
xor edi edi +
mov [ebp+var_428] eax +
mov [ebp+var_430] edi +
mov [ebp+cbValueName] 104h +
mov [ebp+cbData] 208h +
mov [ebp+Type] 1 +
mov [ebp+var_42C] edi +
mov [ebp+hKey] edi +
cmp eax edi +
jnz loc_1027076  +
mov eax 80070057h +
jmp loc_10273D6  +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 3  +
push edi  +
push edi  +
push edi  +
push offset SubKey  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jz loc_10270A2  +
mov eax 80004005h +
jmp loc_10273D6  +
push ebx  +
mov ebx ds:RegSetValueExW +
push esi  +
mov esi ds:_wcsnicmp +
mov [ebp+var_434] edi +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
lea eax [ebp+cbValueName] +
push eax  +
lea eax [ebp+ValueName] +
push eax  +
mov [ebp+dwIndex] edi +
mov [ebp+cbValueName] 104h +
mov [ebp+cbData] 208h +
push edi  +
jmp loc_10272F1  +
inc [ebp+dwIndex]  +
cmp [ebp+Type] 1 +
jnz loc_10272A1  +
mov eax [ebp+var_434] +
sub eax edi +
mov [ebp+var_42C] edi +
jz loc_102721B  +
dec eax  +
jz loc_102719A  +
push 5  +
dec eax  +
push offset aEhome  +
lea eax [ebp+ValueName] +
push eax  +
jz loc_1027175  +
call esi  +
add esp 0Ch +
test eax eax +
jz loc_10272AB  +
push 2  +
lea eax [ebp+ValueName] +
push offset aMs  +
push eax  +
call esi  +
add esp 0Ch +
test eax eax +
jz loc_10272AB  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1027166  +
jmp loc_1027273  +
call esi  +
add esp 0Ch +
test eax eax +
jnz loc_10272AB  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_102718B  +
jmp loc_1027273  +
push 2  +
lea eax [ebp+ValueName] +
push offset aMs  +
push eax  +
call esi  +
add esp 0Ch +
test eax eax +
jnz loc_10272AB  +
push 6  +
lea eax [ebp+ValueName] +
push offset aMsplay  +
push eax  +
call esi  +
add esp 0Ch +
test eax eax +
jz loc_10272AB  +
push 5  +
lea eax [ebp+ValueName] +
push offset aMswmp  +
push eax  +
call esi  +
add esp 0Ch +
test eax eax +
jz loc_10272AB  +
push 0Eh  +
lea eax [ebp+ValueName] +
push offset aMsphotoacquire  +
push eax  +
call esi  +
add esp 0Ch +
test eax eax +
jz loc_10272AB  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_102720F  +
jmp loc_1027273  +
push 6  +
lea eax [ebp+ValueName] +
push offset aMsplay  +
push eax  +
call esi  +
add esp 0Ch +
test eax eax +
jz loc_1027260  +
push 5  +
lea eax [ebp+ValueName] +
push offset aMswmp  +
push eax  +
call esi  +
add esp 0Ch +
test eax eax +
jz loc_1027260  +
push 0Eh  +
lea eax [ebp+ValueName] +
push offset aMsphotoacquire  +
push eax  +
call esi  +
add esp 0Ch +
test eax eax +
jnz loc_10272AB  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1027269  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push [ebp+Type]  +
lea eax [ebp+ValueName] +
push edi  +
push eax  +
push [ebp+hKey]  +
call ebx  +
mov [ebp+var_42C] eax +
jmp loc_10272AB  +
mov [ebp+var_430] 80004005h +
mov [ebp+cbValueName] 104h +
mov [ebp+cbData] 208h +
cmp [ebp+var_42C] edi +
jnz loc_1027307  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
lea eax [ebp+cbValueName] +
push eax  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+dwIndex]  +
push [ebp+var_428]  +
call ds:RegEnumValueW  +
test eax eax +
jz loc_10270FA  +
jmp loc_1027311  +
mov [ebp+var_430] 80004005h +
inc [ebp+var_434]  +
cmp [ebp+var_434] 4 +
jl loc_10270B6  +
cmp [ebp+var_430] edi +
jl loc_10273B2  +
mov esi ds:RegEnumValueW +
mov ebx 208h +
mov [ebp+cbValueName] 104h +
mov [ebp+cbData] ebx +
jmp loc_1027370  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+var_428]  +
mov [ebp+cbValueName] 104h +
mov [ebp+cbData] ebx +
call ds:RegDeleteValueW  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
lea eax [ebp+cbValueName] +
push eax  +
lea eax [ebp+ValueName] +
push eax  +
push edi  +
push [ebp+var_428]  +
call esi  +
test eax eax +
jz loc_102734D  +
push [ebp+var_428]  +
push [ebp+hKey]  +
call sub_102F291  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push offset SubKey  +
push 80000002h  +
call ds:RegDeleteKeyW  +
mov eax [ebp+var_430] +
pop esi  +
pop ebx  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 38h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push 1  +
xor esi esi +
push esi  +
push offset aSoftwareMicr_0  +
mov edi 80000002h +
push edi  +
xor ebx ebx +
mov [ebp+hKey] esi +
mov [ebp+cbData] 14h +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102747A  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset ValueName  +
push [ebp+hKey]  +
mov [ebp+Type] 1 +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102746D  +
cmp [ebp+Type] 1 +
jnz loc_102746D  +
lea eax [ebp+Data] +
push eax  +
push offset aYes  +
call ds:_wcsicmp  +
mov ebx eax +
neg ebx  +
pop ecx  +
sbb ebx ebx +
pop ecx  +
inc ebx  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp ebx esi +
jnz loc_10274A3  +
cmp [ebp+arg_0] esi +
jz loc_10274A3  +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 3  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMic_30  +
push edi  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_10274A3  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
mov eax ebx +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push ecx  +
and [ebp+hKey] 0 +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push 3  +
push 0  +
xor esi esi +
push offset aSoftwareMic_31  +
inc esi  +
push 80000001h  +
mov dword ptr [ebp+Data] esi +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102750D  +
push 4  +
lea eax [ebp+Data] +
push eax  +
push 4  +
push 0  +
push offset a6bf52a52394a11  +
push [ebp+hKey]  +
mov dword ptr [ebp+Data] esi +
call ds:RegSetValueExW  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop esi  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 228h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push edi  +
xor edi edi +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 3  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_32  +
push 80000001h  +
mov [ebp+hKey] edi +
mov [ebp+Type] 1 +
call ds:RegCreateKeyExW  +
test eax eax +
jz loc_1027566  +
xor eax eax +
jmp loc_102763D  +
push ebx  +
push esi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
mov esi offset aClientId +
push esi  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
call ds:RegQueryValueExW  +
mov ebx eax +
cmp ebx edi +
jnz loc_10275C5  +
cmp [ebp+Type] 1 +
jnz loc_10275C5  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_10275B2  +
sub eax edx +
sar eax 1 +
cmp eax 14h +
jnb loc_1027628  +
lea eax [ebp+rguid] +
push eax  +
call ds:CoCreateGuid  +
test eax eax +
jnz loc_1027628  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+rguid] +
push eax  +
call ds:StringFromGUID2  +
test eax eax +
jz loc_1027628  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_10275FC  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push esi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
mov ebx eax +
push [ebp+hKey]  +
call ds:RegCloseKey  +
xor eax eax +
cmp ebx edi +
pop esi  +
setz al  +
pop ebx  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 228h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push edi  +
xor edi edi +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 3  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMicr_0  +
push 80000002h  +
mov [ebp+hKey] edi +
mov [ebp+Type] 1 +
call ds:RegCreateKeyExW  +
test eax eax +
jz loc_10276A0  +
xor eax eax +
jmp loc_1027777  +
push ebx  +
push esi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
mov esi offset aInstallId +
push esi  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
call ds:RegQueryValueExW  +
mov ebx eax +
cmp ebx edi +
jnz loc_10276FF  +
cmp [ebp+Type] 1 +
jnz loc_10276FF  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_10276EC  +
sub eax edx +
sar eax 1 +
cmp eax 14h +
jnb loc_1027762  +
lea eax [ebp+rguid] +
push eax  +
call ds:CoCreateGuid  +
test eax eax +
jnz loc_1027762  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+rguid] +
push eax  +
call ds:StringFromGUID2  +
test eax eax +
jz loc_1027762  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1027736  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push esi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
mov ebx eax +
push [ebp+hKey]  +
call ds:RegCloseKey  +
xor eax eax +
cmp ebx edi +
pop esi  +
setz al  +
pop ebx  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
and [ebp+hKey] 0 +
push ebx  +
push esi  +
push edi  +
mov edi ds:RegDeleteKeyW +
push offset aSoftwareMic_33  +
mov esi 80000002h +
push esi  +
call edi  +
mov ebx offset aSoftwareMic_34 +
push ebx  +
push esi  +
call edi  +
xor eax eax +
push eax  +
lea ecx [ebp+hKey] +
push ecx  +
push eax  +
push 3  +
push eax  +
push eax  +
push eax  +
push ebx  +
push esi  +
call ds:RegCreateKeyExW  +
pop edi  +
pop esi  +
pop ebx  +
test eax eax +
jnz locret_10277D7  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 21Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push 2001Fh  +
xor esi esi +
push esi  +
push offset aSoftwareMic_35  +
push 80000001h  +
mov [ebp+hKey] esi +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10278FE  +
push edi  +
mov edi ds:RegEnumKeyExW +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+var_218] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
mov [ebp+phkResult] esi +
mov [ebp+var_21C] esi +
mov [ebp+var_218] 104h +
push esi  +
jmp loc_10278E1  +
inc [ebp+var_21C]  +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+hKey]  +
mov [ebp+var_218] 104h +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10278C9  +
push offset aWmploc_dll  +
push [ebp+phkResult]  +
call ds:RegDeleteKeyW  +
push offset aSetup_wm_exe  +
push [ebp+phkResult]  +
call ds:RegDeleteKeyW  +
push offset aUnregmp2_exe  +
push [ebp+phkResult]  +
call ds:RegDeleteKeyW  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+var_218] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+var_21C]  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jz loc_1027856  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push esi  +
mov esi ds:RegDeleteKeyW +
push offset aSoftwareMic_36  +
push 80000002h  +
call esi  +
push offset aClsid896e73f03  +
push 80000000h  +
call esi  +
pop esi  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 638h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
mov esi ds:RegOpenKeyExW +
push edi  +
lea ecx [ebp+hKey] +
push ecx  +
xor eax eax +
mov ebx 2001Fh +
push ebx  +
push eax  +
push offset aSoftwareMic_37  +
mov edi 80000001h +
push edi  +
mov [ebp+var_628] eax +
mov [ebp+hKey] eax +
call esi  +
test eax eax +
jz loc_102798A  +
and [ebp+hKey] 0 +
lea eax [ebp+var_628] +
push eax  +
push ebx  +
push 0  +
push offset aSoftwareMic_11  +
push edi  +
call esi  +
test eax eax +
jnz loc_1027AD6  +
mov edi ds:RegEnumValueW +
lea ecx [ebp+var_634] +
push ecx  +
lea ecx [ebp+FileName] +
push ecx  +
lea ecx [ebp+Type] +
push ecx  +
push eax  +
lea ecx [ebp+var_630] +
push ecx  +
lea ecx [ebp+ValueName] +
mov ebx 104h +
mov esi 208h +
push ecx  +
mov [ebp+var_620] eax +
mov [ebp+var_630] ebx +
mov [ebp+var_634] esi +
mov [ebp+Type] 1 +
push eax  +
jmp loc_1027ABA  +
inc [ebp+var_620]  +
cmp [ebp+var_620] 3E8h +
jnb loc_1027ACA  +
cmp [ebp+hKey] 0 +
mov [ebp+var_630] ebx +
mov [ebp+var_634] esi +
jz loc_1027A59  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+hKey]  +
mov [ebp+cbData] esi +
call ds:RegQueryValueExW  +
test eax eax +
jz loc_1027A8F  +
lea eax [ebp+FileName] +
push eax  +
call ds:DeleteFileW  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jnz loc_1027A8F  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+var_628]  +
call ds:RegDeleteValueW  +
dec [ebp+var_620]  +
lea eax [ebp+var_634] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
lea eax [ebp+var_630] +
push eax  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+var_620]  +
push [ebp+var_628]  +
call edi  +
test eax eax +
jz loc_10279FA  +
push [ebp+var_628]  +
call ds:RegCloseKey  +
cmp [ebp+hKey] 0 +
pop edi  +
pop esi  +
pop ebx  +
jz loc_1027AEE  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov ecx [ebp+var_4] +
xor ecx ebp +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 10h +
push ebx  +
mov ebx ds:RegOpenKeyExW +
push esi  +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push 3  +
xor esi esi +
push esi  +
push offset aSoftwareMicr_0  +
push 80000002h  +
mov [ebp+hKey] esi +
mov [ebp+cbData] 104h +
mov [ebp+Type] 1 +
mov dword ptr [ebp+Data] esi +
call ebx  +
mov edi offset aInstallresult +
test eax eax +
jnz loc_1027B9B  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push edi  +
push [ebp+hKey]  +
mov [ebp+cbData] 4 +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1027B92  +
cmp [ebp+Type] 4 +
jnz loc_1027B92  +
cmp dword ptr [ebp+Data] 0D2AF9h +
jz loc_1027B7C  +
cmp dword ptr [ebp+Data] 0C00D2AFBh +
jnz loc_1027B92  +
push 4  +
lea eax [ebp+Data] +
push eax  +
push 4  +
push esi  +
push edi  +
push [ebp+hKey]  +
mov dword ptr [ebp+Data] esi +
call ds:RegSetValueExW  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
lea eax [ebp+hKey] +
push eax  +
push 3  +
push esi  +
push offset aSoftwareMicr_0  +
push 80000001h  +
call ebx  +
test eax eax +
jnz loc_1027C07  +
push 4  +
pop ebx  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push edi  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1027BFE  +
cmp [ebp+Type] ebx +
jnz loc_1027BFE  +
cmp dword ptr [ebp+Data] 0D2AF9h +
jz loc_1027BEA  +
cmp dword ptr [ebp+Data] 0C00D2AFBh +
jnz loc_1027BFE  +
push ebx  +
lea eax [ebp+Data] +
push eax  +
push ebx  +
push esi  +
push edi  +
push [ebp+hKey]  +
mov dword ptr [ebp+Data] esi +
call ds:RegSetValueExW  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
pop esi  +
pop ebx  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 10h +
and [ebp+hKey] 0 +
push esi  +
lea eax [ebp+hKey] +
push eax  +
xor esi esi +
inc esi  +
push esi  +
push 0  +
push offset aSoftwareClient  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1027C80  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aIconsvisible  +
push [ebp+hKey]  +
mov dword ptr [ebp+Data] esi +
mov [ebp+cbData] 4 +
mov [ebp+Type] esi +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1027C77  +
cmp [ebp+Type] 4 +
jnz loc_1027C77  +
cmp dword ptr [ebp+Data] esi +
setz al  +
mov esi eax +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov eax esi +
pop esi  +
leave   +
retn   +
***
mov edi edi +
push esi  +
push offset aSoftwareMicr_3  +
xor esi esi +
push 80000002h  +
inc esi  +
call ds:RegDeleteKeyW  +
test eax eax +
jz loc_1027CA6  +
xor esi esi +
mov eax esi +
pop esi  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 74h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
xor ebx ebx +
push ebx  +
lea eax [ebp+hKey] +
push eax  +
push ebx  +
push 20006h  +
push ebx  +
push ebx  +
push ebx  +
push offset aSystemCurrentc  +
push 80000002h  +
mov [ebp+hKey] ebx +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1027D34  +
push esi  +
push edi  +
push 19h  +
pop ecx  +
mov esi offset aProgramfilesWi +
lea edi [ebp+var_6C] +
movs   +
push 4  +
lea eax [ebp+Data] +
push eax  +
push 4  +
push ebx  +
push offset aCardinality  +
push [ebp+hKey]  +
movs   +
mov esi ds:RegSetValueExW +
mov dword ptr [ebp+Data] ebx +
call esi  +
push 66h  +
lea eax [ebp+var_6C] +
push eax  +
push 2  +
push ebx  +
push offset aExename  +
push [ebp+hKey]  +
call esi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
pop esi  +
mov ecx [ebp+var_4] +
xor eax eax +
xor ecx ebp +
inc eax  +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
xor esi esi +
call ds:GetUserDefaultLCID  +
push esi  +
push [ebp+arg_4]  +
push [ebp+arg_0]  +
push eax  +
call ds:LCIDToLocaleName  +
test eax eax +
jz loc_1027D6A  +
inc esi  +
mov eax esi +
pop esi  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 218h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
push edi  +
xor esi esi +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
xor edi edi +
inc edi  +
push edi  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMicr_2  +
push 80000001h  +
mov [ebp+hKey] esi +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1027E0A  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aObfuscatedsync  +
push [ebp+hKey]  +
mov [ebp+Type] edi +
mov [ebp+cbData] 208h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1027DFE  +
cmp [ebp+Type] edi +
jnz loc_1027DFE  +
mov esi edi +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov ecx [ebp+var_4] +
pop edi  +
mov eax esi +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
cmp [ebp+Arguments] 0 +
push esi  +
mov esi ecx +
jnz loc_1027E36  +
and dword ptr [esi] 0 +
mov byte ptr [esi+4] 1 +
jmp loc_1027E5C  +
push [ebp+Arguments]  +
mov byte ptr [esi+4] 0 +
call ds:SysAllocString  +
mov [esi] eax +
test eax eax +
jnz loc_1027E5C  +
lea eax [ebp+Arguments] +
push eax  +
push 1  +
push 1  +
push 8007000Eh  +
call ds:RaiseException  +
mov eax esi +
pop esi  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov edx [ebp+arg_4] +
xor eax eax +
test edx edx +
jz loc_1027E7E  +
cmp edx 7FFFFFFFh +
jbe loc_1027E83  +
mov eax 80070057h +
test eax eax +
jl loc_1027E99  +
mov eax [ebp+arg_8] +
mov ecx [ebp+arg_0] +
push 7FFFFFFEh  +
push 0  +
call sub_1026F74  +
pop ebp  +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov edx [ebp+arg_4] +
shr edx 1 +
push 0  +
pop eax  +
jz loc_1027EB9  +
cmp edx 7FFFFFFFh +
jbe loc_1027EBE  +
mov eax 80070057h +
test eax eax +
jl loc_1027ED4  +
mov eax [ebp+arg_8] +
mov ecx [ebp+arg_0] +
push 7FFFFFFEh  +
push 0  +
call sub_1026F74  +
pop ebp  +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov edx [ebp+arg_4] +
push esi  +
push edi  +
mov edi [ebp+arg_0] +
mov esi 7FFFFFFFh +
push esi  +
push edi  +
lea eax [ebp+arg_0] +
call sub_1026F47  +
test eax eax +
jl loc_1027F13  +
mov eax [ebp+arg_0] +
mov edx [ebp+arg_4] +
push esi  +
sub edx eax +
lea ecx [edi+eax*2] +
mov eax [ebp+arg_8] +
push 0  +
call sub_1026F74  +
pop edi  +
pop esi  +
pop ebp  +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ebx  +
mov ebx [ebp+arg_0] +
push esi  +
mov esi [ebp+arg_4] +
push edi  +
mov edi 7FFFFFFFh +
push edi  +
shr esi 1 +
push ebx  +
lea eax [ebp+arg_4] +
mov edx esi +
call sub_1026F47  +
test eax eax +
jl loc_1027F58  +
mov eax [ebp+arg_4] +
push edi  +
mov edx esi +
sub edx eax +
lea ecx [ebx+eax*2] +
mov eax [ebp+arg_8] +
push 0  +
call sub_1026F74  +
pop edi  +
pop esi  +
pop ebx  +
pop ebp  +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
xor eax eax +
cmp [ebp+arg_4] eax +
jz loc_1027F79  +
cmp [ebp+arg_4] 7FFFFFFFh +
jbe loc_1027F7E  +
mov eax 80070057h +
test eax eax +
jl loc_1027F98  +
push edi  +
mov edi [ebp+arg_0] +
lea eax [ebp+arg_C] +
push eax  +
push [ebp+arg_8]  +
mov eax [ebp+arg_4] +
push 0  +
call sub_1026FCB  +
pop edi  +
pop ebp  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov ecx [ebp+arg_4] +
shr ecx 1 +
push 0  +
pop eax  +
jz loc_1027FB6  +
cmp ecx 7FFFFFFFh +
jbe loc_1027FBB  +
mov eax 80070057h +
test eax eax +
jl loc_1027FD4  +
push edi  +
mov edi [ebp+arg_0] +
lea eax [ebp+arg_C] +
push eax  +
push [ebp+arg_8]  +
mov eax ecx +
push 0  +
call sub_1026FCB  +
pop edi  +
pop ebp  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 218h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
push ebx  +
xor ebx ebx +
push esi  +
push edi  +
mov edi [ebp+arg_4] +
mov [ebp+var_218] ebx +
cmp eax ebx +
jnz loc_10280AD  +
mov esi 104h +
push esi  +
push ebx  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_10302A3  +
test eax eax +
jz loc_10281C6  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102E61A  +
push offset aMplayer2_exe  +
push esi  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_10281C6  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_10281C6  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_214] +
push eax  +
lea eax [ebp+tstrFilename] +
push eax  +
mov [ebp+var_214] ebx +
mov [ebp+var_210] ebx +
call sub_102EC42  +
test eax eax +
jl loc_10281C6  +
cmp edi ebx +
jz loc_10281BC  +
mov eax [ebp+var_210] +
movzx ecx ax +
shr eax 10h +
push ecx  +
push eax  +
mov eax [ebp+var_214] +
jmp loc_10281A3  +
cmp eax 3 +
jnz loc_10280E0  +
mov esi 104h +
push esi  +
push ebx  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_10302A3  +
test eax eax +
jz loc_10281C6  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102E61A  +
push offset aWmplayer_exe  +
jmp loc_1028140  +
cmp eax 2 +
jnz loc_1028117  +
push 103h  +
lea eax [ebp+tstrFilename] +
push eax  +
call ds:GetSystemDirectoryW  +
test eax eax +
jz loc_10281C6  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102E61A  +
push offset aQuartz_dll  +
push 104h  +
jmp loc_1028141  +
cmp eax 1 +
jnz loc_10281C6  +
mov esi 104h +
push esi  +
lea eax [ebp+tstrFilename] +
push eax  +
call ds:GetSystemDirectoryW  +
test eax eax +
jz loc_10281C6  +
push offset aDxmasf_dll  +
push esi  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_10281C6  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_10281C6  +
lea eax [ebp+var_214] +
push eax  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+tstrFilename] +
push eax  +
mov [ebp+var_210] ebx +
mov [ebp+var_214] ebx +
call sub_102EC42  +
test eax eax +
jl loc_10281C6  +
cmp edi ebx +
jz loc_10281BC  +
mov eax [ebp+var_214] +
movzx ecx ax +
shr eax 10h +
push ecx  +
push eax  +
mov eax [ebp+var_210] +
movzx ecx ax +
push ecx  +
shr eax 10h +
push eax  +
push offset aLuLuLuLu  +
push [ebp+arg_8]  +
push edi  +
call sub_1027F64  +
add esp 1Ch +
mov [ebp+var_218] 1 +
mov ecx [ebp+var_4] +
mov eax [ebp+var_218] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 424h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
push edi  +
xor esi esi +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 3  +
push esi  +
push esi  +
push esi  +
xor ebx ebx +
push offset aSoftwareMicr_0  +
inc ebx  +
push 80000002h  +
mov [ebp+var_420] ebx +
mov [ebp+hKey] esi +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_10284DB  +
push 103h  +
lea eax [ebp+var_20C] +
push eax  +
push 3  +
call sub_1027FDB  +
test eax eax +
jz loc_10282EF  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+phkResult] +
push eax  +
push esi  +
mov edi offset aResetautoplay +
push edi  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
mov [ebp+phkResult] ebx +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10282BD  +
cmp [ebp+phkResult] ebx +
jnz loc_10282BD  +
lea eax [ebp+var_20C] +
push eax  +
lea eax [ebp+Data] +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10282BD  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov eax ebx +
jmp loc_10284E0  +
lea eax [ebp+var_20C] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_10282C6  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
push ebx  +
push esi  +
push edi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
push [ebp+hKey]  +
mov ebx ds:RegCloseKey +
call ebx  +
lea eax [ebp+hKey] +
push eax  +
mov edi 2001Fh +
push edi  +
push esi  +
mov esi ds:RegOpenKeyExW +
push offset aSoftwareMic_14  +
push 80000002h  +
call esi  +
test eax eax +
jnz loc_10284D3  +
and [ebp+phkResult] eax +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 0  +
push offset aHandlecdburnin  +
push [ebp+hKey]  +
call esi  +
test eax eax +
jnz loc_102835F  +
push [ebp+phkResult]  +
call sub_1027017  +
push [ebp+phkResult]  +
mov [ebp+var_420] eax +
call ebx  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 0  +
push offset aHandledvdburni  +
push [ebp+hKey]  +
call esi  +
test eax eax +
jnz loc_1028393  +
push [ebp+phkResult]  +
call sub_1027017  +
push [ebp+phkResult]  +
mov [ebp+var_420] eax +
call ebx  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 0  +
push offset aPlaycdaudioona  +
push [ebp+hKey]  +
call esi  +
test eax eax +
jnz loc_10283C7  +
push [ebp+phkResult]  +
call sub_1027017  +
push [ebp+phkResult]  +
mov [ebp+var_420] eax +
call ebx  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 0  +
push offset aPlaydvdmovieon  +
push [ebp+hKey]  +
call esi  +
test eax eax +
jnz loc_10283FB  +
push [ebp+phkResult]  +
call sub_1027017  +
push [ebp+phkResult]  +
mov [ebp+var_420] eax +
call ebx  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 0  +
push offset aPlayvideofiles  +
push [ebp+hKey]  +
call esi  +
test eax eax +
jnz loc_102842F  +
push [ebp+phkResult]  +
call sub_1027017  +
push [ebp+phkResult]  +
mov [ebp+var_420] eax +
call ebx  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 0  +
push offset aPlayvideocdmov  +
push [ebp+hKey]  +
call esi  +
test eax eax +
jnz loc_1028463  +
push [ebp+phkResult]  +
call sub_1027017  +
push [ebp+phkResult]  +
mov [ebp+var_420] eax +
call ebx  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 0  +
push offset aPlaysupervideo  +
push [ebp+hKey]  +
call esi  +
test eax eax +
jnz loc_1028497  +
push [ebp+phkResult]  +
call sub_1027017  +
push [ebp+phkResult]  +
mov [ebp+var_420] eax +
call ebx  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 0  +
push offset aShowpictureson  +
push [ebp+hKey]  +
call esi  +
test eax eax +
jnz loc_10284CB  +
push [ebp+phkResult]  +
call sub_1027017  +
push [ebp+phkResult]  +
mov [ebp+var_420] eax +
call ebx  +
push [ebp+hKey]  +
call ebx  +
mov eax [ebp+var_420] +
jmp loc_10284E0  +
mov eax 80004005h +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov eax 125Ch +
call __alloca_probe  +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
lea eax [ebp+hKey] +
push eax  +
push 2001Fh  +
xor ebx ebx +
push ebx  +
push offset aSoftwarePolici  +
push 80000001h  +
mov [ebp+hKey] ebx +
mov [ebp+cbData] ebx +
mov [ebp+Type] 1 +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10286AC  +
push esi  +
push edi  +
mov edi ds:wcschr +
mov [ebp+var_1254] ebx +
lea eax [ebp+ValueName] +
cmp [ebp+var_1254] ebx +
jz loc_102856E  +
push offset aRadioguideurl  +
jmp loc_1028573  +
push offset aMediaguideurl  +
push 7Fh  +
push eax  +
call sub_1027E68  +
push offset aPartner  +
push 7Fh  +
lea eax [ebp+var_204] +
push eax  +
call sub_1027E68  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+hKey]  +
mov [ebp+cbData] 1048h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102868B  +
cmp [ebp+Type] 1 +
jnz loc_102868B  +
mov [ebp+var_206] ax +
lea eax [ebp+Data] +
push 2Fh  +
push eax  +
call edi  +
pop ecx  +
pop ecx  +
cmp eax ebx +
jz loc_1028678  +
lea esi [eax+2] +
push 2Fh  +
push esi  +
call edi  +
pop ecx  +
pop ecx  +
cmp eax ebx +
jz loc_1028613  +
lea esi [eax+2] +
push 2Fh  +
push esi  +
call edi  +
pop ecx  +
pop ecx  +
cmp eax ebx +
jz loc_1028613  +
xor ecx ecx +
mov [eax] cx +
cmp esi ebx +
jz loc_1028678  +
push 3Fh  +
push esi  +
call edi  +
pop ecx  +
pop ecx  +
cmp eax ebx +
jz loc_1028627  +
xor ecx ecx +
mov [eax] cx +
push esi  +
call ds:_wcslwr  +
mov [esp+126Ch+var_126C] offset a_windowsmedia_ +
push esi  +
call ds:wcsstr  +
pop ecx  +
pop ecx  +
cmp eax ebx +
jz loc_1028678  +
xor ecx ecx +
mov [eax] cx +
mov eax esi +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_102864C  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push esi  +
push 1  +
push ebx  +
lea eax [ebp+var_204] +
push eax  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
jmp loc_102868B  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
inc [ebp+var_1254]  +
cmp [ebp+var_1254] 2 +
jl loc_1028559  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
pop esi  +
mov ecx [ebp+var_4] +
xor eax eax +
xor ecx ebp +
inc eax  +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 1B4h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp-4] eax +
lea ecx [ebp-1B4h] +
call sub_1031EAC  +
lea eax [ebp-1B4h] +
push eax  +
mov dword_10416EC 1 +
call sub_103802C  +
test eax eax +
jz loc_1028851  +
push esi  +
push edi  +
push 9  +
xor edi edi +
pop esi  +
cmp edi esi +
ja loc_1028757  +
jmp ds:off_1028869[edi*4]  +
push offset a_asf  +
jmp loc_102875C  +
push offset a_asx  +
jmp loc_102875C  +
push offset a_wax  +
jmp loc_102875C  +
push offset a_wma  +
jmp loc_102875C  +
push offset a_wmv  +
jmp loc_102875C  +
push offset a_wvx  +
jmp loc_102875C  +
push offset a_wm  +
jmp loc_102875C  +
push offset a_wmx  +
jmp loc_102875C  +
push offset a_wmd  +
jmp loc_102875C  +
push offset a_wmz  +
jmp loc_102875C  +
push offset a_wpl  +
push esi  +
lea eax [ebp-18h] +
push eax  +
call sub_1027E68  +
lea eax [ebp-18h] +
push eax  +
lea eax [ebp-1B4h] +
push eax  +
call sub_10396F5  +
inc edi  +
cmp edi 0Bh +
jl loc_1028706  +
push 27h  +
xor edi edi +
pop esi  +
cmp edi 0Ah +
ja loc_10287DA  +
jmp ds:off_1028891[edi*4]  +
push offset aApplicationXMp  +
jmp loc_10287DF  +
push offset aVideoXMsAsf  +
jmp loc_10287DF  +
push offset aAudioXMsWax  +
jmp loc_10287DF  +
push offset aAudioXMsWma  +
jmp loc_10287DF  +
push offset aVideoXMsWm  +
jmp loc_10287DF  +
push offset aVideoXMsWmv  +
jmp loc_10287DF  +
push offset aVideoXMsWvx  +
jmp loc_10287DF  +
push offset aVideoXMsWmx  +
jmp loc_10287DF  +
push offset aApplicationXMs  +
jmp loc_10287DF  +
push offset aApplicationX_0  +
jmp loc_10287DF  +
push offset aVideoXMsAsfPlu  +
jmp loc_10287DF  +
push offset aApplicationVnd  +
push esi  +
lea eax [ebp-68h] +
push eax  +
call sub_1027E68  +
lea eax [ebp-68h] +
push eax  +
lea eax [ebp-1B4h] +
push eax  +
call sub_1039746  +
inc edi  +
cmp edi 0Ch +
jl loc_1028781  +
xor edi edi +
mov esi 95h +
mov eax edi +
sub eax 0 +
jz loc_1028824  +
dec eax  +
lea eax [ebp-194h] +
jz loc_102881D  +
push offset aMmsu  +
jmp loc_102882F  +
push offset aMmst  +
jmp loc_102882F  +
push offset aMms  +
lea eax [ebp-194h] +
push esi  +
push eax  +
call sub_1027E68  +
lea eax [ebp-194h] +
push eax  +
lea eax [ebp-1B4h] +
push eax  +
call sub_10397A3  +
inc edi  +
cmp edi 3 +
jl loc_1028806  +
pop edi  +
pop esi  +
lea ecx [ebp-1B4h] +
call sub_1031ECD  +
mov ecx [ebp-4] +
xor ecx ebp +
call sub_102DF7D  +
leave   +
retn   +
***
xor eax eax +
inc eax  +
push eax  +
push eax  +
push 0  +
mov dword_10416E8 eax +
call sub_103925C  +
jmp loc_10286C1  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 210h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push edi  +
push 104h  +
push 1  +
lea eax [ebp+FileName] +
push eax  +
call sub_10302A3  +
xor edi edi +
test eax eax +
jz loc_1028A76  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E61A  +
push offset aWmplayer_exe  +
push 104h  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_1028A76  +
lea eax [ebp+FileName] +
push eax  +
call ds:GetFileAttributesW  +
mov [ebp+hKey] edi +
cmp [ebp+arg_0] edi +
jz loc_1028963  +
and eax 0FFFFFFF9h +
jmp loc_1028966  +
or eax 6 +
push eax  +
lea eax [ebp+FileName] +
push eax  +
call ds:SetFileAttributesW  +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_38  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1028AE6  +
push esi  +
cmp [ebp+arg_0] edi +
jnz loc_1028A49  +
push offset aProgramfiles_0  +
push 208h  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EA2  +
mov esi ds:RegSetValueExW +
test eax eax +
jl loc_10289FA  +
lea eax [ebp+FileName] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_10289D0  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
push 2  +
push edi  +
push offset aWindowsmediapl  +
push [ebp+hKey]  +
call esi  +
push offset aProgramfilesX8  +
push 208h  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EA2  +
test eax eax +
jl loc_1028A69  +
lea eax [ebp+FileName] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1028A1D  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
push 2  +
push edi  +
push offset aWindowsmedia_0  +
push [ebp+hKey]  +
call esi  +
jmp loc_1028A69  +
mov esi ds:RegDeleteValueW +
push offset aWindowsmediapl  +
push [ebp+hKey]  +
call esi  +
push offset aWindowsmedia_0  +
push [ebp+hKey]  +
call esi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop esi  +
push 104h  +
push edi  +
lea eax [ebp+FileName] +
push eax  +
call sub_10302A3  +
test eax eax +
jz loc_1028AE6  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E61A  +
push offset aMplayer2_exe  +
push 104h  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_1028AE6  +
lea eax [ebp+FileName] +
push eax  +
call ds:GetFileAttributesW  +
cmp [ebp+arg_0] edi +
jz loc_1028AD5  +
and eax 0FFFFFFF9h +
jmp loc_1028AD8  +
or eax 6 +
push eax  +
lea eax [ebp+FileName] +
push eax  +
call ds:SetFileAttributesW  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 410h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
xor esi esi +
mov [ebp+hKey] esi +
mov dword ptr [ebp+Data] 1 +
call sub_102D126  +
test eax eax +
jnz loc_1028EE7  +
cmp [ebp+arg_0] esi +
push ebx  +
setnz al  +
push edi  +
push [ebp+arg_0]  +
mov dword ptr [ebp+Data] eax +
call sub_10288DD  +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 3  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareClient  +
mov ebx 80000002h +
push ebx  +
call ds:RegCreateKeyExW  +
mov edi ds:RegSetValueExW +
test eax eax +
jnz loc_1028B93  +
push 4  +
lea eax [ebp+Data] +
push eax  +
push 4  +
push esi  +
push offset aIconsvisible  +
push [ebp+hKey]  +
call edi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 3  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareClie_0  +
push ebx  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1028BE5  +
cmp dword ptr [ebp+Data] esi +
push 4  +
setz al  +
mov [ebp+phkResult] eax +
lea eax [ebp+phkResult] +
push eax  +
push 4  +
push esi  +
push offset aHidden  +
push [ebp+hKey]  +
call edi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 3  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMic_39  +
push ebx  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1028C28  +
push 4  +
lea eax [ebp+Data] +
push eax  +
push 4  +
push esi  +
push offset aWmpocm  +
push [ebp+hKey]  +
call edi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 3  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMicr_1  +
push ebx  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1028EE5  +
push 4  +
lea eax [ebp+Data] +
push eax  +
push 4  +
push esi  +
push offset aDontask  +
push [ebp+hKey]  +
mov dword ptr [ebp+Data] 2 +
call edi  +
push 0FFh  +
lea eax [ebp+var_204] +
push eax  +
call sub_103066C  +
test eax eax +
jz loc_1028DA8  +
mov ebx ds:wcsstr +
mov [ebp+phkResult] esi +
jmp loc_1028C9A  +
push 2Ch  +
pop ecx  +
mov [eax] cx +
lea eax [ebp+var_204] +
push offset String2  +
push eax  +
call ebx  +
pop ecx  +
pop ecx  +
cmp eax esi +
jnz loc_1028C94  +
lea eax [ebp+var_204] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1028CB7  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_204] +
push eax  +
push 1  +
push esi  +
mov ebx offset aVersion +
push ebx  +
push [ebp+hKey]  +
call edi  +
cmp [ebp+arg_0] esi +
jnz loc_1028D98  +
push esi  +
lea eax [ebp+phkResult] +
push eax  +
push esi  +
push 3  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMicr_1  +
push 80000001h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1028DBA  +
lea eax [ebp+var_204] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1028D1A  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_204] +
push eax  +
push 1  +
push esi  +
push ebx  +
push [ebp+phkResult]  +
call edi  +
push offset asc_1002FC4  +
mov ebx 100h +
push ebx  +
lea eax [ebp+var_204] +
push eax  +
call sub_1027E68  +
lea eax [ebp+var_204] +
lea ecx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx si +
jnz loc_1028D60  +
sub eax ecx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_204] +
push eax  +
push 1  +
push esi  +
push offset aLocale  +
push [ebp+phkResult]  +
call edi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
jmp loc_1028DBF  +
push offset aSoftwareMicr_1  +
push 80000001h  +
call ds:RegDeleteKeyW  +
cmp [ebp+arg_0] esi +
jz loc_1028DBA  +
mov dword ptr [ebp+Data] esi +
mov ebx 100h +
jmp loc_1028DC9  +
mov ebx 100h +
mov dword ptr [ebp+Data] 1 +
push 4  +
lea eax [ebp+Data] +
push eax  +
push 4  +
push esi  +
push offset aIsinstalled  +
push [ebp+hKey]  +
call edi  +
push 0FFh  +
lea eax [ebp+var_204] +
push eax  +
call sub_102FC69  +
test eax eax +
jz loc_1028E8C  +
lea eax [ebp+var_204] +
cmp [ebp+arg_0] esi +
jz loc_1028E0D  +
push offset aShowwmp_0  +
jmp loc_1028E12  +
push offset aHidewmp_0  +
push ebx  +
push eax  +
call sub_1027EDD  +
push ebx  +
lea eax [ebp+var_404] +
push eax  +
lea eax [ebp+var_204] +
push eax  +
call ds:PathUnExpandEnvStringsW  +
test eax eax +
jz loc_1028E59  +
lea eax [ebp+var_404] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1028E3B  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_404] +
push eax  +
push 2  +
jmp loc_1028E7E  +
lea eax [ebp+var_204] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1028E62  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_204] +
push eax  +
push 1  +
push esi  +
push offset aStubpath  +
push [ebp+hKey]  +
call edi  +
push 4  +
push offset asc_1002FC4  +
push 1  +
push esi  +
push offset aLocale  +
push [ebp+hKey]  +
push esi  +
call sub_102F9D6  +
push 14h  +
push offset aWmpaccess  +
push 1  +
push esi  +
push offset aComponentid  +
push [ebp+hKey]  +
push esi  +
call sub_102F9D6  +
push 2Ah  +
push offset aWindowsMediaPl  +
push 1  +
push esi  +
push esi  +
push [ebp+hKey]  +
push esi  +
call sub_102F9D6  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
pop ebx  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 634h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
xor ebx ebx +
push ebx  +
lea eax [ebp+hKey] +
push eax  +
push ebx  +
push 2001Fh  +
push ebx  +
push ebx  +
push ebx  +
push offset aSoftwareMic_40  +
push 80000002h  +
mov [ebp+hKey] ebx +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_10290BE  +
push esi  +
push edi  +
mov esi 105h +
push esi  +
lea eax [ebp+Buffer] +
push eax  +
mov [ebp+Data] ebx +
mov [ebp+var_62C] ebx +
call ds:GetSystemDirectoryW  +
mov edi ds:RegSetValueExW +
test eax eax +
jz loc_1029035  +
push offset aWmp_dll  +
lea eax [ebp+Buffer] +
push eax  +
push offset aSS  +
lea eax [ebp+tstrFilename] +
push esi  +
push eax  +
call sub_1027F64  +
add esp 14h +
test eax eax +
jl loc_1028FCD  +
lea eax [ebp+var_62C] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102EC42  +
test eax eax +
jl loc_1028FCD  +
push 8  +
lea eax [ebp+Data] +
push eax  +
push 3  +
push ebx  +
push offset aWmp_dll  +
push [ebp+hKey]  +
call edi  +
push offset aWmploc_dll  +
lea eax [ebp+Buffer] +
push eax  +
push offset aSS  +
lea eax [ebp+tstrFilename] +
push esi  +
push eax  +
mov [ebp+var_62C] ebx +
mov [ebp+Data] ebx +
call sub_1027F64  +
add esp 14h +
test eax eax +
jl loc_1029035  +
lea eax [ebp+var_62C] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102EC42  +
test eax eax +
jl loc_1029035  +
push 8  +
lea eax [ebp+Data] +
push eax  +
push 3  +
push ebx  +
push offset aWmploc_dll  +
push [ebp+hKey]  +
call edi  +
push esi  +
push 1  +
lea eax [ebp+var_628] +
push eax  +
mov [ebp+var_62C] ebx +
mov [ebp+Data] ebx +
call sub_10302A3  +
test eax eax +
jz loc_10290B0  +
push offset aWmplayer_exe  +
lea eax [ebp+var_628] +
push eax  +
push offset aSS  +
lea eax [ebp+tstrFilename] +
push esi  +
push eax  +
call sub_1027F64  +
add esp 14h +
test eax eax +
jl loc_10290B0  +
lea eax [ebp+var_62C] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102EC42  +
test eax eax +
jl loc_10290B0  +
push 8  +
lea eax [ebp+Data] +
push eax  +
push 3  +
push ebx  +
push offset aWmplayer_exe  +
push [ebp+hKey]  +
call edi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
pop esi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 20Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push edi  +
mov edi [ebp+arg_0] +
test edi edi +
jnz loc_10290F1  +
xor eax eax +
jmp loc_1029143  +
push esi  +
mov esi 104h +
push esi  +
lea eax [ebp+Buffer] +
push eax  +
call ds:GetSystemDirectoryW  +
lea eax [ebp+Buffer] +
push eax  +
call sub_102E61A  +
push offset aWindowsMedia  +
push esi  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027EDD  +
pop esi  +
test eax eax +
jl loc_10290ED  +
lea eax [ebp+Buffer] +
push eax  +
mov eax [ebp+arg_4] +
dec eax  +
push eax  +
push edi  +
call sub_1027E68  +
xor ecx ecx +
test eax eax +
setnl cl  +
mov eax ecx +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
xor esi esi +
cmp [ebp+arg_4] 104h +
jnb loc_102916C  +
xor eax eax +
jmp loc_102919C  +
push [ebp+arg_4]  +
push [ebp+arg_0]  +
call sub_10290D0  +
test eax eax +
jz loc_102919A  +
push [ebp+arg_0]  +
call sub_102E61A  +
push offset aServer  +
push [ebp+arg_4]  +
push [ebp+arg_0]  +
call sub_1027EDD  +
test eax eax +
jl loc_1029168  +
xor esi esi +
inc esi  +
mov eax esi +
pop esi  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 520h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
mov ebx ds:RegOpenKeyExW +
push esi  +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push 20019h  +
xor esi esi +
push esi  +
push offset aSoftwareMicr_8  +
mov edi 80000001h +
push edi  +
mov [ebp+hKey] esi +
mov [ebp+cbName] esi +
call ebx  +
test eax eax +
jnz loc_102921E  +
push offset aDesktopshortcu  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
push offset aQuicklaunchsho  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
lea eax [ebp+hKey] +
push eax  +
push 20019h  +
push esi  +
push offset aSoftwareMicr_0  +
push edi  +
mov [ebp+hKey] esi +
call ebx  +
test eax eax +
jnz loc_102925A  +
push offset aUdblocalpath  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
lea eax [ebp+hKey] +
push eax  +
push 2001Fh  +
push esi  +
push offset aSoftwareMic_41  +
push edi  +
call ebx  +
test eax eax +
jnz loc_10292CB  +
mov [ebp+cbName] 80h +
jmp loc_102929C  +
lea eax [ebp+Name] +
push eax  +
push [ebp+hKey]  +
mov [ebp+cbName] 80h +
call ds:RegDeleteKeyW  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push esi  +
push [ebp+hKey]  +
call ds:RegEnumKeyExW  +
test eax eax +
jz loc_102927F  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
lea eax [ebp+hKey] +
push eax  +
push 2  +
push esi  +
push offset aSoftwareMicr_2  +
push edi  +
call ebx  +
test eax eax +
jnz loc_102930C  +
xor ebx ebx +
push ds:off_1001C60[ebx]  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
add ebx 4 +
cmp ebx 0A0h +
jb loc_10292E3  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMicr_2  +
push edi  +
mov [ebp+hKey] esi +
call ds:RegCreateKeyExW  +
mov ebx ds:RegSetValueExW +
test eax eax +
jnz loc_1029393  +
push 4  +
pop eax  +
push eax  +
lea ecx [ebp+Data] +
push ecx  +
push eax  +
push esi  +
push offset aAcceptedprivac  +
push [ebp+hKey]  +
mov dword ptr [ebp+Data] esi +
mov [ebp+cbName] eax +
call ebx  +
push [ebp+cbName]  +
lea eax [ebp+Data] +
push eax  +
push 4  +
push esi  +
push offset aUpgradecheckfr  +
push [ebp+hKey]  +
mov dword ptr [ebp+Data] 1 +
push esi  +
call sub_102F9D6  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push offset aSoftwareMic_42  +
push edi  +
mov [ebp+hKey] esi +
call ds:RegDeleteKeyW  +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMic_43  +
push edi  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_102948B  +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
push 26FDh  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_102941B  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_10293F1  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push esi  +
push offset aAppname  +
push [ebp+hKey]  +
call ebx  +
push 104h  +
push 1  +
lea eax [ebp+var_514] +
push eax  +
call sub_10302A3  +
test eax eax +
jz loc_102947F  +
push offset aWmplayer_exe_0  +
push 104h  +
lea eax [ebp+var_514] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102947F  +
lea eax [ebp+var_514] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1029455  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_514] +
push eax  +
push 1  +
push esi  +
push offset aExepath  +
push [ebp+hKey]  +
call ebx  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
lea eax [ebp+hKey] +
push eax  +
push 2  +
push esi  +
push offset aSoftwareMic_44  +
push edi  +
mov [ebp+hKey] esi +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102950B  +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
push 0A4h  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_10294FF  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_10294D5  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push esi  +
push offset aLocale  +
push [ebp+hKey]  +
call ebx  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 0CA8h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
push edi  +
push 0Dh  +
pop ecx  +
mov esi offset aIncludeWmslocs +
lea edi [ebp+var_3C] +
movs   +
movs   +
push 0Ah  +
pop ecx  +
mov esi offset aAdminWebWmssec +
lea edi [ebp+var_68] +
movs   +
push 0Dh  +
movs   +
pop ecx  +
mov esi offset aAdminWebWmss_0 +
lea edi [ebp+var_CA4] +
movs   +
push 1D2h  +
xor ebx ebx +
lea eax [ebp+var_C6E] +
push ebx  +
push eax  +
movs   +
call memset  +
push 11h  +
pop ecx  +
mov esi offset aAdminWebWmss_1 +
lea edi [ebp+var_A9C] +
movs   +
push 1C2h  +
lea eax [ebp+var_A56] +
push ebx  +
push eax  +
movs   +
call memset  +
push 12h  +
pop ecx  +
mov esi offset aAdminWebWmss_2 +
lea edi [ebp+var_894] +
movs   +
push 1BEh  +
lea eax [ebp+var_84A] +
push ebx  +
push eax  +
movs   +
call memset  +
add esp 24h +
mov esi 105h +
push esi  +
lea eax [ebp+var_480] +
push eax  +
call sub_1029157  +
test eax eax +
jz loc_102968F  +
lea eax [ebp+var_3C] +
push eax  +
lea eax [ebp+var_68] +
push eax  +
lea eax [ebp+var_480] +
push eax  +
mov edi offset aSSS +
push edi  +
lea eax [ebp+ExistingFileName] +
push esi  +
push eax  +
call sub_1027F64  +
add esp 18h +
test eax eax +
jl loc_102968F  +
lea eax [ebp+ExistingFileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_102968F  +
lea ebx [ebp+var_CA4] +
mov [ebp+var_CA8] 3 +
lea eax [ebp+var_3C] +
push eax  +
push ebx  +
lea eax [ebp+var_480] +
push eax  +
push edi  +
lea eax [ebp+FileName] +
push esi  +
push eax  +
call sub_1027F64  +
add esp 18h +
test eax eax +
jl loc_1029681  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_102966B  +
lea eax [ebp+FileName] +
push eax  +
call ds:DeleteFileW  +
push 0  +
lea eax [ebp+ExistingFileName] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
call ds:CreateHardLinkW  +
add ebx 208h +
dec [ebp+var_CA8]  +
jnz loc_102962D  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 390h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
xor ebx ebx +
push ebx  +
lea eax [ebp+hKey] +
push eax  +
push ebx  +
push 2001Bh  +
push ebx  +
push ebx  +
push ebx  +
push offset aSoftwareMicr_3  +
push 80000002h  +
mov [ebp+hKey] ebx +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_10297F5  +
push esi  +
push edi  +
push 1Fh  +
pop ecx  +
mov esi offset aProgramfiles_1 +
lea edi [ebp+var_F8] +
movs   +
push 20h  +
movs   +
pop ecx  +
push 1Dh  +
mov esi offset a@ProgramfilesW +
lea edi [ebp+var_17C] +
movs   +
pop ecx  +
push 4  +
lea eax [ebp+Data] +
push eax  +
push 4  +
movs   +
push ebx  +
push offset aOnlineonly  +
push [ebp+hKey]  +
mov esi offset aProgramfiles_2 +
lea edi [ebp+var_78] +
movs   +
mov esi ds:RegSetValueExW +
mov dword ptr [ebp+Data] 1 +
call esi  +
push 82h  +
lea eax [ebp+var_17C] +
push eax  +
push 2  +
pop edi  +
push edi  +
push ebx  +
push offset aFriendlyname  +
push [ebp+hKey]  +
call esi  +
push 7Eh  +
lea eax [ebp+var_F8] +
push eax  +
push edi  +
push ebx  +
push offset aIcon  +
push [ebp+hKey]  +
call esi  +
push 74h  +
lea eax [ebp+var_78] +
push eax  +
push edi  +
push ebx  +
push offset aStartcommand  +
push [ebp+hKey]  +
call esi  +
push offset aA9a5353f2d4b47  +
push 105h  +
lea eax [ebp+var_388] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_10297B4  +
xor eax eax +
mov [ebp+var_33A] ax +
lea eax [ebp+var_388] +
lea edx [eax+2] +
mov cx [eax] +
add eax edi +
cmp cx bx +
jnz loc_10297BD  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+4] +
push eax  +
lea eax [ebp+var_388] +
push eax  +
push 7  +
push ebx  +
push offset aEndpoints  +
push [ebp+hKey]  +
call esi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
pop esi  +
mov ecx [ebp+var_4] +
xor eax eax +
xor ecx ebp +
inc eax  +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov eax 2238h +
call __alloca_probe  +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
push edi  +
xor edi edi +
push offset aSystemCurrentc  +
inc edi  +
push 80000002h  +
mov [ebp+var_2210] edi +
call ds:RegDeleteKeyW  +
xor esi esi +
test eax eax +
jz loc_102984A  +
mov [ebp+var_2210] esi +
lea eax [ebp+hKey] +
push eax  +
push 3  +
push esi  +
push offset aSoftwareMicr_4  +
push 80000001h  +
mov [ebp+hKey] esi +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102988B  +
push offset aWmpnscfg  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push 104h  +
push edi  +
lea eax [ebp+FileName] +
push eax  +
call sub_10302A3  +
test eax eax +
jz loc_10298EC  +
push offset aWmpnscfg_exe  +
push 208h  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027F1E  +
test eax eax +
jl loc_10298EC  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_10298EC  +
push 0Ah  +
push esi  +
push offset Parameters  +
lea eax [ebp+FileName] +
push eax  +
push esi  +
push esi  +
call ds:ShellExecuteW  +
test eax eax +
jz loc_10298EC  +
mov [ebp+var_2210] esi +
push 0F003Fh  +
push esi  +
push esi  +
call ds:OpenSCManagerW  +
mov [ebp+hSCObject] eax +
cmp eax esi +
jz loc_10299D9  +
push ebx  +
push 27h  +
push offset ServiceName  +
push eax  +
call ds:OpenServiceW  +
mov ebx eax +
cmp ebx esi +
jz loc_10299CC  +
lea eax [ebp+pcbBytesNeeded] +
push eax  +
push 2000h  +
lea eax [ebp+ServiceConfig] +
push eax  +
push ebx  +
mov [ebp+pcbBytesNeeded] esi +
call ds:QueryServiceConfigW  +
test eax eax +
jz loc_102994D  +
cmp [ebp+ServiceConfig.dwStartType] 2 +
jnz loc_102996B  +
push esi  +
push esi  +
push esi  +
push esi  +
push esi  +
push esi  +
push esi  +
push 0FFFFFFFFh  +
push 3  +
push 0FFFFFFFFh  +
push ebx  +
call ds:ChangeServiceConfigW  +
test eax eax +
jnz loc_102996B  +
mov [ebp+var_2210] esi +
push 6  +
pop ecx  +
xor eax eax +
mov [ebp+ServiceStatus.dwServiceType] esi +
lea edi [ebp+ServiceStatus.dwCurrentState] +
stos   +
lea eax [ebp+ServiceStatus] +
push eax  +
push ebx  +
call ds:QueryServiceStatus  +
test eax eax +
jz loc_10299AB  +
test byte ptr [ebp+ServiceStatus.dwControlsAccepted] 1 +
jz loc_10299C5  +
cmp [ebp+ServiceStatus.dwCurrentState] 3 +
jz loc_10299C5  +
cmp [ebp+ServiceStatus.dwCurrentState] 1 +
jz loc_10299C5  +
lea eax [ebp+ServiceStatus] +
push eax  +
push 1  +
push ebx  +
call ds:ControlService  +
test eax eax +
jnz loc_10299C5  +
mov [ebp+var_2210] esi +
push ebx  +
call ds:CloseServiceHandle  +
push [ebp+hSCObject]  +
call ds:CloseServiceHandle  +
pop ebx  +
mov ecx [ebp+var_4] +
mov eax [ebp+var_2210] +
pop edi  +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push ecx  +
push esi  +
push edi  +
xor esi esi +
push esi  +
call ds:CoInitialize  +
push offset Buffer  +
push 4  +
mov [ebp+ppv] esi +
mov [ebp+var_4] esi +
call sub_1039F1B  +
lea eax [ebp+ppv] +
push eax  +
push offset riid  +
push 1  +
push esi  +
push offset rclsid  +
call ds:CoCreateInstance  +
mov edi eax +
cmp edi esi +
jl loc_1029A5A  +
mov eax [ebp+ppv] +
mov ecx [eax] +
lea edx [ebp+var_4] +
push edx  +
push offset dword_1003A3C  +
push eax  +
call dword ptr [ecx]  +
mov edi eax +
cmp edi esi +
jl loc_1029A5A  +
mov eax [ebp+var_4] +
mov ecx [eax] +
push 1  +
push esi  +
push esi  +
push esi  +
push eax  +
call dword ptr [ecx+10h]  +
mov edi eax +
push edi  +
push offset aFinishedCreati  +
push 4  +
call sub_1039F55  +
mov eax [ebp+var_4] +
add esp 0Ch +
cmp eax esi +
jz loc_1029A77  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov eax [ebp+ppv] +
cmp eax esi +
jz loc_1029A84  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
call ds:CoUninitialize  +
mov eax edi +
pop edi  +
pop esi  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 214h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
and [ebp+var_210] 0 +
push ebx  +
push edi  +
lea eax [ebp+var_214] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
mov [ebp+var_214] 208h +
call sub_102D396  +
mov ebx offset aWindowsMedia_0 +
mov edi 104h +
test eax eax +
jz loc_1029B13  +
push ebx  +
push edi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_1029B13  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_1029B13  +
lea eax [ebp+FileName] +
push eax  +
call ds:DeleteFileW  +
mov [ebp+var_210] eax +
lea eax [ebp+var_214] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
push 0  +
mov [ebp+var_214] 208h +
call sub_102D6EF  +
test eax eax +
jz loc_1029B6B  +
push ebx  +
push edi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_1029B6B  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_1029B6B  +
lea eax [ebp+FileName] +
push eax  +
call ds:DeleteFileW  +
mov [ebp+var_210] eax +
mov ecx [ebp+var_4] +
mov eax [ebp+var_210] +
pop edi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 0A34h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
xor ecx ecx +
mov [ebp+lpPathName] eax +
mov [ebp+var_A30] ecx +
cmp eax ecx +
jz loc_1029D76  +
lea eax [ebp+var_A2C] +
push eax  +
push ecx  +
push ecx  +
push 801Ch  +
push ecx  +
call ds:SHGetFolderPathW  +
test eax eax +
jl loc_1029D76  +
push ebx  +
mov ebx 104h +
push ebx  +
lea eax [ebp+Buffer] +
push eax  +
push 0A5h  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_1029D75  +
lea eax [ebp+Buffer] +
push eax  +
lea eax [ebp+var_A2C] +
push eax  +
push offset aSS_0  +
lea eax [ebp+PathName] +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 14h +
test eax eax +
jl loc_1029D75  +
push esi  +
push edi  +
lea eax [ebp+PathName] +
push eax  +
call sub_102FE6A  +
mov edi ds:GetLastError +
mov esi ds:CreateDirectoryW +
test eax eax +
jnz loc_1029C70  +
push 0  +
lea eax [ebp+PathName] +
push eax  +
call esi  +
test eax eax +
jnz loc_1029C70  +
call edi  +
cmp eax 0B7h +
jz loc_1029C70  +
call edi  +
push eax  +
lea eax [ebp+PathName] +
push eax  +
push offset aFailedToGetCre  +
push 2  +
call sub_1039F55  +
add esp 10h +
lea eax [ebp+PathName] +
push eax  +
call sub_102FE6A  +
test eax eax +
jz loc_1029D73  +
lea eax [ebp+PathName] +
push eax  +
push offset aSSyncPlaylists  +
lea eax [ebp+pszPath] +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
test eax eax +
jl loc_1029D73  +
push 0  +
lea eax [ebp+pszPath] +
push eax  +
call esi  +
test eax eax +
jnz loc_1029CC4  +
call edi  +
cmp eax 0B7h +
jnz loc_1029D5A  +
push ebx  +
lea eax [ebp+var_824] +
push eax  +
call sub_1027D49  +
test eax eax +
jz loc_1029D01  +
lea eax [ebp+pszPath] +
push eax  +
call ds:PathAddBackslashW  +
lea eax [ebp+var_824] +
push eax  +
push ebx  +
lea eax [ebp+pszPath] +
push eax  +
call sub_1027EDD  +
push 0  +
lea eax [ebp+pszPath] +
push eax  +
call esi  +
call ds:GetTickCount  +
push eax  +
lea eax [ebp+pszPath] +
push eax  +
push offset aS08x  +
push [ebp+arg_4]  +
push [ebp+lpPathName]  +
call sub_1027F64  +
add esp 14h +
test eax eax +
jl loc_1029D73  +
push 0  +
push [ebp+lpPathName]  +
call esi  +
mov [ebp+var_A30] eax +
test eax eax +
jnz loc_1029D73  +
call edi  +
cmp eax 0B7h +
jz loc_1029D73  +
call edi  +
push eax  +
push offset aFailedToGetObf  +
push 4  +
call sub_1039F55  +
add esp 0Ch +
jmp loc_1029D73  +
call edi  +
push eax  +
lea eax [ebp+pszPath] +
push eax  +
push offset aFailedToGetC_0  +
push 4  +
call sub_1039F55  +
add esp 10h +
pop edi  +
pop esi  +
pop ebx  +
mov ecx [ebp+var_4] +
mov eax [ebp+var_A30] +
xor ecx ebp +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 630h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
and [ebp+var_624] 0 +
push esi  +
push 0  +
call ds:CoInitialize  +
push 104h  +
lea eax [ebp+Data] +
push eax  +
call sub_1029B84  +
test eax eax +
jz loc_1029FFF  +
or [ebp+hKey] 0FFFFFFFFh +
push ebx  +
mov [ebp+var_628] 0Ch +
mov esi 208h +
push edi  +
mov eax [ebp+hKey] +
cmp eax 0Ah +
ja loc_1029E82  +
jmp ds:off_102A02F[eax*4]  +
mov edi offset aSyncpl02_xml +
push offset a02_music_added  +
jmp loc_1029E8C  +
mov edi offset aSyncpl03_xml +
push offset a03_music_rated  +
jmp loc_1029E8C  +
mov edi offset aSyncpl04_xml +
push offset a04_music_playe  +
jmp loc_1029E8C  +
mov edi offset aSyncpl05_xml +
push offset a05_pictures_ta  +
jmp loc_1029E8C  +
mov edi offset aSyncpl06_xml +
push offset a06_pictures_ra  +
jmp loc_1029E8C  +
mov edi offset aSyncpl07_xml +
push offset a07_tv_recorded  +
jmp loc_1029E8C  +
mov edi offset aSyncpl08_xml +
push offset a08_video_rated  +
jmp loc_1029E8C  +
mov edi offset aSyncpl09_xml +
push offset a09_music_playe  +
jmp loc_1029E8C  +
mov edi offset aSyncpl10_xml +
push offset a10_all_music  +
jmp loc_1029E8C  +
mov edi offset aSyncpl11_xml +
push offset a11_all_picture  +
jmp loc_1029E8C  +
mov edi offset aSyncpl12_xml +
push offset a12_all_video  +
jmp loc_1029E8C  +
mov edi offset aSyncpl01_xml +
push offset a01_music_auto_  +
push esi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_1027EA2  +
push 17h  +
push edi  +
push hModule  +
call ds:FindResourceW  +
mov ebx eax +
test ebx ebx +
jz loc_1029F56  +
push ebx  +
push hModule  +
call ds:LoadResource  +
mov [ebp+lpBuffer] eax +
test eax eax +
jz loc_1029F56  +
lea eax [ebp+var_20C] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push offset aSS_wpl  +
lea eax [ebp+FileName] +
push esi  +
push eax  +
call sub_1027F9F  +
add esp 14h +
test eax eax +
jl loc_1029F56  +
push 0  +
push 8000080h  +
push 2  +
push 0  +
push 1  +
push 40000000h  +
lea eax [ebp+FileName] +
push eax  +
call ds:CreateFileW  +
mov edi eax +
cmp edi 0FFFFFFFFh +
jz loc_1029F56  +
and [ebp+NumberOfBytesWritten] 0 +
push ebx  +
push hInstance  +
call ds:SizeofResource  +
push 0  +
lea ecx [ebp+NumberOfBytesWritten] +
push ecx  +
push eax  +
push [ebp+lpBuffer]  +
push edi  +
call ds:WriteFile  +
push edi  +
mov [ebp+var_624] 1 +
call ds:CloseHandle  +
inc [ebp+hKey]  +
dec [ebp+var_628]  +
jnz loc_1029DE5  +
xor esi esi +
pop edi  +
pop ebx  +
cmp [ebp+var_624] esi +
jz loc_1029FFF  +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMicr_2  +
push 80000001h  +
mov [ebp+hKey] esi +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_102A015  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1029FA9  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push esi  +
push offset aObfuscatedsync  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
test eax eax +
jz loc_1029FF1  +
call ds:GetLastError  +
push eax  +
push offset aErrorFailedToS  +
push 2  +
call sub_1039F55  +
add esp 0Ch +
push [ebp+hKey]  +
call ds:RegCloseKey  +
jmp loc_102A015  +
call ds:GetLastError  +
push eax  +
push offset aErrorFailedToO  +
push 2  +
call sub_1039F55  +
add esp 0Ch +
call ds:CoUninitialize  +
mov ecx [ebp+var_4] +
mov eax [ebp+var_624] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push edi  +
push offset aCheckingForPla  +
push 4  +
xor edi edi +
call sub_1039F1B  +
call sub_1027D76  +
test eax eax +
jnz loc_102A09F  +
push offset aPlaylistLocati  +
push 4  +
call sub_1039F1B  +
call sub_1029D8F  +
mov edi eax +
test edi edi +
jnz loc_102A098  +
push offset aObfuscationFor  +
jmp loc_102A0A4  +
push offset aObfuscationF_0  +
jmp loc_102A0A4  +
push offset aPlaylistLoca_0  +
push 4  +
call sub_1039F1B  +
mov eax edi +
pop edi  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 674h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp-4] eax +
push ebx  +
push esi  +
xor ebx ebx +
push ebx  +
lea eax [ebp-63Ch] +
push eax  +
push ebx  +
xor esi esi +
inc esi  +
push esi  +
push ebx  +
push ebx  +
push ebx  +
push offset aSoftwareMicr_2  +
push 80000001h  +
mov [ebp-620h] ebx +
mov [ebp-63Ch] ebx +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_102A681  +
push 206h  +
mov [ebp-414h] ax +
lea eax [ebp-412h] +
push ebx  +
push eax  +
call memset  +
add esp 0Ch +
lea eax [ebp-674h] +
push eax  +
lea eax [ebp-414h] +
push eax  +
lea eax [ebp-658h] +
push eax  +
push ebx  +
push offset aObfuscatedsync  +
push dword ptr [ebp-63Ch]  +
mov [ebp-658h] esi +
mov dword ptr [ebp-674h] 208h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102A675  +
cmp [ebp-658h] esi +
jnz loc_102A675  +
cmp ax [ebp-414h] +
jz loc_102A675  +
push ebx  +
call ds:CoInitialize  +
lea eax [ebp-644h] +
push eax  +
push offset riid  +
push esi  +
push ebx  +
push offset rclsid  +
mov [ebp-644h] ebx +
mov [ebp-638h] ebx +
mov [ebp-640h] ebx +
mov [ebp-630h] ebx +
call ds:CoCreateInstance  +
cmp eax ebx +
mov [ebp-620h] eax +
jl loc_102A62F  +
mov eax [ebp-644h] +
mov ecx [eax] +
lea edx [ebp-638h] +
push edx  +
push offset dword_10041CC  +
push eax  +
call dword ptr [ecx]  +
cmp eax ebx +
mov [ebp-620h] eax +
jl loc_102A62F  +
mov eax [ebp-638h] +
mov ecx [eax] +
lea edx [ebp-640h] +
push edx  +
push eax  +
call dword ptr [ecx+40h]  +
cmp eax ebx +
mov [ebp-620h] eax +
jl loc_102A62F  +
mov eax [ebp-640h] +
mov ecx [eax] +
lea edx [ebp-630h] +
push edx  +
push offset dword_10041BC  +
push eax  +
call dword ptr [ecx]  +
cmp eax ebx +
mov [ebp-620h] eax +
jl loc_102A62F  +
mov eax [ebp-630h] +
cmp eax ebx +
jz loc_102A63F  +
lea edx [ebp-62Ch] +
push edx  +
mov [ebp-62Ch] ebx +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+4Ch]  +
cmp eax ebx +
mov [ebp-620h] eax +
jl loc_102A613  +
mov esi [ebp-62Ch] +
push offset aTrue  +
lea ecx [ebp-660h] +
call sub_1027E1F  +
cmp [eax+4] bl +
jz loc_102A278  +
mov [ebp-624h] ebx +
jmp loc_102A28E  +
mov eax [eax] +
mov [ebp-624h] eax +
cmp eax ebx +
jnz loc_102A28E  +
mov dword ptr [ebp-624h] offset byte_1002720 +
push edi  +
push offset aEquals  +
lea ecx [ebp-654h] +
call sub_1027E1F  +
cmp [eax+4] bl +
jz loc_102A2A8  +
xor edi edi +
jmp loc_102A2B5  +
mov eax [eax] +
mov edi eax +
cmp eax ebx +
jnz loc_102A2B5  +
mov edi offset byte_1002720 +
push offset aSynconly  +
lea ecx [ebp-64Ch] +
call sub_1027E1F  +
cmp [eax+4] bl +
jz loc_102A2CE  +
xor eax eax +
jmp loc_102A2D9  +
mov eax [eax] +
cmp eax ebx +
jnz loc_102A2D9  +
mov eax offset byte_1002720 +
push dword ptr [ebp-624h]  +
mov ecx [esi] +
push edi  +
push eax  +
push esi  +
call dword ptr [ecx+1Ch]  +
push dword ptr [ebp-64Ch]  +
mov esi ds:SysFreeString +
mov [ebp-620h] eax +
call esi  +
push dword ptr [ebp-654h]  +
call esi  +
push dword ptr [ebp-660h]  +
call esi  +
cmp [ebp-620h] ebx +
jl loc_102A612  +
mov edi [ebp-630h] +
push offset aPlaylist  +
lea ecx [ebp-64Ch] +
mov [ebp-624h] ebx +
call sub_1027E1F  +
cmp [eax+4] bl +
jz loc_102A33C  +
xor eax eax +
jmp loc_102A347  +
mov eax [eax] +
cmp eax ebx +
jnz loc_102A347  +
mov eax offset byte_1002720 +
mov ecx [edi] +
lea edx [ebp-624h] +
push edx  +
push 0FFFFFFFFh  +
push ebx  +
push eax  +
push dword ptr [ebp-62Ch]  +
push edi  +
call dword ptr [ecx+50h]  +
push dword ptr [ebp-64Ch]  +
mov [ebp-620h] eax +
call esi  +
cmp [ebp-620h] ebx +
jl loc_102A602  +
mov eax [ebp-624h] +
lea edx [ebp-650h] +
push edx  +
mov [ebp-650h] ebx +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+1Ch]  +
cmp [ebp-650h] ebx +
mov [ebp-634h] ebx +
jle loc_102A602  +
mov eax [ebp-624h] +
lea edx [ebp-65Ch] +
push edx  +
push dword ptr [ebp-634h]  +
mov [ebp-65Ch] ebx +
mov [ebp-628h] ebx +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+30h]  +
cmp eax ebx +
mov [ebp-620h] eax +
jl loc_102A5CA  +
mov eax [ebp-65Ch] +
mov ecx [eax] +
lea edx [ebp-628h] +
push edx  +
push offset dword_1004168  +
push eax  +
call dword ptr [ecx]  +
cmp eax ebx +
mov [ebp-620h] eax +
jl loc_102A5CA  +
xor eax eax +
lea edi [ebp-670h] +
stos   +
stos   +
stos   +
lea edx [ebp-670h] +
push edx  +
push ebx  +
stos   +
push ebx  +
push ds:off_101AD30  +
xor eax eax +
mov [ebp-670h] ax +
mov eax [ebp-628h] +
mov ecx [eax] +
push ebx  +
push eax  +
call dword ptr [ecx+14h]  +
cmp eax ebx +
mov [ebp-620h] eax +
jl loc_102A5BF  +
push 8  +
pop eax  +
cmp ax [ebp-670h] +
jnz loc_102A5BF  +
mov edi [ebp-668h] +
cmp edi ebx +
jz loc_102A5BF  +
xor eax eax +
cmp ax [edi] +
jz loc_102A5BF  +
mov esi 206h +
push esi  +
mov [ebp-20Ch] ax +
lea eax [ebp-20Ah] +
push ebx  +
push eax  +
call memset  +
add esp 0Ch +
push edi  +
mov edi 104h +
push edi  +
lea eax [ebp-20Ch] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_102A5BF  +
lea eax [ebp-20Ch] +
push 5Ch  +
push eax  +
call ds:wcsrchr  +
pop ecx  +
pop ecx  +
mov [ebp-648h] eax +
cmp eax ebx +
jz loc_102A5BF  +
xor eax eax +
push esi  +
mov [ebp-61Ch] ax +
lea eax [ebp-61Ah] +
push ebx  +
push eax  +
call memset  +
add esp 0Ch +
push dword ptr [ebp-648h]  +
lea eax [ebp-61Ch] +
push edi  +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_102A5BF  +
lea eax [ebp-414h] +
push eax  +
push edi  +
lea eax [ebp-20Ch] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_102A5BF  +
lea eax [ebp-20Ch] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_102A514  +
sub eax edx +
sar eax 1 +
jz loc_102A538  +
push 5Ch  +
lea eax [ebp+eax*2-20Eh] +
pop ecx  +
cmp cx [eax] +
jnz loc_102A538  +
xor ecx ecx +
mov [eax] cx +
lea eax [ebp-61Ch] +
push eax  +
push edi  +
lea eax [ebp-20Ch] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102A5BF  +
lea eax [ebp-20Ch] +
push eax  +
call ds:GetFileAttributesW  +
cmp eax 0FFFFFFFFh +
jz loc_102A5BF  +
test al 10h +
jnz loc_102A5BF  +
lea ecx [ebp-670h] +
call sub_1026ED5  +
push 8  +
pop eax  +
mov [ebp-670h] ax +
lea eax [ebp-20Ch] +
push eax  +
call ds:SysAllocString  +
mov [ebp-668h] eax +
cmp eax ebx +
jz loc_102A5BF  +
mov eax [ebp-628h] +
mov ecx [eax] +
lea edx [ebp-670h] +
push edx  +
push ebx  +
push ebx  +
push ds:off_101AD30  +
push 8  +
push eax  +
call dword ptr [ecx+1Ch]  +
test eax eax +
jl loc_102A5BF  +
mov eax [ebp-628h] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+30h]  +
lea ecx [ebp-670h] +
call sub_1026ED5  +
mov eax [ebp-628h] +
cmp eax ebx +
jz loc_102A5DA  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov eax [ebp-65Ch] +
cmp eax ebx +
jz loc_102A5EA  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
inc dword ptr [ebp-634h]  +
mov eax [ebp-634h] +
cmp eax [ebp-650h] +
jl loc_102A3A3  +
mov eax [ebp-624h] +
cmp eax ebx +
jz loc_102A612  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
pop edi  +
push offset aCreatedMediaLi  +
push 4  +
call sub_1039F1B  +
mov eax [ebp-62Ch] +
cmp eax ebx +
jz loc_102A62F  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov eax [ebp-630h] +
cmp eax ebx +
jz loc_102A63F  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov eax [ebp-640h] +
cmp eax ebx +
jz loc_102A64F  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov eax [ebp-638h] +
cmp eax ebx +
jz loc_102A65F  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov eax [ebp-644h] +
cmp eax ebx +
jz loc_102A66F  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
call ds:CoUninitialize  +
push dword ptr [ebp-63Ch]  +
call ds:RegCloseKey  +
mov ecx [ebp-4] +
mov eax [ebp-620h] +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 624h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
xor esi esi +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 20006h  +
push esi  +
push esi  +
push esi  +
push offset aWmp_burncdShel  +
push 80000000h  +
mov [ebp+hKey] esi +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_102A816  +
push ebx  +
push edi  +
mov edi ds:RegSetValueExW +
push 24h  +
push offset Data  +
push 1  +
push esi  +
push offset aMuiverb  +
push [ebp+hKey]  +
mov [ebp+phkResult] esi +
call edi  +
mov ebx 104h +
push ebx  +
lea eax [ebp+Data] +
push eax  +
push 0A7h  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_102A757  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_102A731  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push esi  +
push esi  +
push [ebp+hKey]  +
call edi  +
push esi  +
lea eax [ebp+phkResult] +
push eax  +
push esi  +
push 20006h  +
push esi  +
push esi  +
push esi  +
push offset aCommand  +
push [ebp+hKey]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_102A808  +
push ebx  +
push ebx  +
lea eax [ebp+var_61C] +
push eax  +
call sub_10302A3  +
test eax eax +
jz loc_102A7FC  +
push offset aWmplayer_exe_0  +
push ebx  +
lea eax [ebp+var_61C] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102A7FC  +
lea eax [ebp+var_61C] +
push eax  +
push offset aSPrefetch3Task  +
lea eax [ebp+var_414] +
push 103h  +
push eax  +
call sub_1027F64  +
add esp 10h +
test eax eax +
jl loc_102A7FC  +
lea eax [ebp+var_414] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_102A7D6  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_414] +
push eax  +
push 1  +
push esi  +
push esi  +
push [ebp+phkResult]  +
call edi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
pop ebx  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn   +
***
call sub_10291A6  +
call sub_10284F4  +
call sub_10274BB  +
call sub_1027515  +
call sub_1029A95  +
call sub_102A060  +
jmp loc_102A0B4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 4BCh +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+hInstance] +
push ebx  +
mov ebx [ebp+lpCmdLine] +
push esi  +
push edi  +
push 2  +
pop esi  +
xor edi edi +
push edi  +
push edi  +
push 1  +
push edi  +
mov hInstance eax +
mov dword_1041700 esi +
call ds:HeapSetInformation  +
lea eax [ebp+ulOptions] +
cmp ebx edi +
jz loc_102A8A5  +
push 153h  +
push ebx  +
push eax  +
call ds:mbstowcs  +
add esp 0Ch +
jmp loc_102A8B5  +
push offset byte_1002720  +
push 154h  +
push eax  +
call sub_1027E68  +
push edi  +
lea eax [ebp+ulOptions] +
push eax  +
call ds:RegisterApplicationRestart  +
test eax eax +
jge loc_102A8D2  +
push offset aErrorRegistrat  +
push esi  +
call sub_1039F1B  +
mov esi ds:wcsstr +
lea eax [ebp+ulOptions] +
push offset aCreatemedialib  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102A8F1  +
call sub_10299F2  +
call sub_103BAF0  +
test eax eax +
jz loc_102A9B6  +
lea eax [ebp+ulOptions] +
push offset aReentrant  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_102AEA1  +
push offset aErrorCallerAtt  +
push 2  +
call sub_1039F1B  +
push 104h  +
lea eax [ebp+FileName] +
push eax  +
call ds:GetSystemWindowsDirectoryW  +
test eax eax +
jz loc_102AEA1  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E61A  +
push offset aSysnativeUnreg  +
push 208h  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027F1E  +
test eax eax +
jl loc_102AEA1  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_102AEA1  +
push offset aReentrant_0  +
push 154h  +
lea eax [ebp+ulOptions] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102AEA1  +
push 0Ah  +
push edi  +
lea eax [ebp+ulOptions] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
push edi  +
push edi  +
call ds:ShellExecuteW  +
jmp loc_102AEA1  +
call sub_1027789  +
call sub_1027910  +
call sub_102764F  +
cmp ebx edi +
jz loc_102AE86  +
lea eax [ebp+ulOptions] +
push offset aPerformindiv  +
push eax  +
call esi  +
pop ecx  +
test eax eax +
pop ecx  +
lea eax [ebp+ulOptions] +
jz loc_102AA02  +
push offset aPerformindivif  +
push eax  +
call esi  +
neg eax  +
pop ecx  +
sbb eax eax +
pop ecx  +
neg eax  +
push eax  +
call sub_102AEB9  +
jmp loc_102AE86  +
push offset aEnsurefilevers  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AA89  +
mov [ebp+hKey] edi +
mov [ebp+phkResult] edi +
call sub_1028EFB  +
mov esi ds:RegOpenKeyExW +
lea eax [ebp+phkResult] +
push eax  +
push 20019h  +
push edi  +
push offset aSoftwareMicr_5  +
mov ebx 80000002h +
push ebx  +
call esi  +
test eax eax +
jz loc_102AA78  +
lea eax [ebp+hKey] +
push eax  +
push 3  +
push edi  +
push offset aSoftwareMicr_4  +
push ebx  +
call esi  +
test eax eax +
jnz loc_102AE86  +
push offset aMp10_ensurefil  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
push [ebp+hKey]  +
jmp loc_102AA7E  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
jmp loc_102AE86  +
lea eax [ebp+ulOptions] +
push offset aCreatewmshardl  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AAA7  +
call sub_102951F  +
jmp loc_102AE86  +
call sub_10308C4  +
lea eax [ebp+ulOptions] +
push offset aResetwmpburn  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AACA  +
call sub_102A69A  +
jmp loc_102AE86  +
lea eax [ebp+ulOptions] +
push offset aApplyformats  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_102AE86  +
lea eax [ebp+ulOptions] +
push offset aMigratelibrary  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_102AE86  +
lea eax [ebp+ulOptions] +
push offset aFixups  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AB1D  +
call sub_1027938  +
call sub_1027AFF  +
jmp loc_102AE86  +
lea eax [ebp+ulOptions] +
push offset aUpdatewmpversi  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AB36  +
call sub_1028EFB  +
lea eax [ebp+ulOptions] +
push offset aReguniv  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AB54  +
call sub_1039FE7  +
jmp loc_102AE86  +
lea eax [ebp+ulOptions] +
push offset aUnregexts  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AB78  +
call sub_1036681  +
push edi  +
call sub_1037D3F  +
jmp loc_102AE86  +
lea eax [ebp+ulOptions] +
push offset aShowwmp  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
mov ebx offset aSetshowstate +
test eax eax +
jz loc_102ABA1  +
lea eax [ebp+ulOptions] +
push ebx  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_102ABB5  +
lea eax [ebp+ulOptions] +
push offset aAdddvdsupport  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102ABBA  +
call sub_1031E27  +
lea eax [ebp+ulOptions] +
push offset aHidewmp  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AC23  +
call sub_102D126  +
test eax eax +
jnz loc_102AE86  +
lea eax [ebp+ulOptions] +
push ebx  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
push edi  +
test eax eax +
jz loc_102ABF3  +
call sub_1028AFA  +
jmp loc_102ABF8  +
call sub_10288DD  +
call sub_102980A  +
call sub_102CFAC  +
call sub_1036681  +
call sub_1027C8A  +
push edi  +
push edi  +
push 3000h  +
push 8000000h  +
call ds:SHChangeNotify  +
jmp loc_102AE86  +
lea eax [ebp+ulOptions] +
push offset aShowwmp  +
push eax  +
call esi  +
pop ecx  +
test eax eax +
pop ecx  +
lea eax [ebp+ulOptions] +
jz loc_102AC74  +
push ebx  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AC55  +
call sub_10281E2  +
push 1  +
call sub_1028AFA  +
jmp loc_102AC5C  +
push 1  +
call sub_10288DD  +
call sub_1027CAF  +
push 1  +
call sub_102CA13  +
call sub_1036EA3  +
call sub_10296A3  +
jmp loc_102AC0C  +
push offset aSetwmpasdefaul  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102ACA6  +
call sub_1039FBC  +
push edi  +
push edi  +
push edi  +
call sub_103925C  +
push edi  +
push edi  +
push 3000h  +
push 8000000h  +
call ds:SHChangeNotify  +
jmp loc_102AEA1  +
lea eax [ebp+ulOptions] +
push offset aPreinstall  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102ACC4  +
call sub_102FA3C  +
jmp loc_102AE86  +
call sub_102BA33  +
call sub_1028EFB  +
lea eax [ebp+ulOptions] +
push offset aFirstlogon  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102ACE7  +
call sub_102A828  +
lea eax [ebp+ulOptions] +
push offset aResetmui  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AD00  +
call sub_10277DE  +
lea eax [ebp+ulOptions] +
push offset aShortcuts  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AD39  +
push 1  +
call sub_10273EA  +
test eax eax +
jz loc_102AD33  +
lea eax [ebp+ulOptions] +
push offset aIsvinstall  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_102AD39  +
push edi  +
call sub_102CA13  +
push edi  +
call sub_10273EA  +
mov ebx ds:SHChangeNotify +
test eax eax +
jz loc_102AD55  +
push 1  +
push 1  +
push edi  +
call sub_103925C  +
jmp loc_102AD8F  +
lea eax [ebp+ulOptions] +
push offset aRegexts  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AD6D  +
push edi  +
push edi  +
jmp loc_102AD4D  +
lea eax [ebp+ulOptions] +
push offset aRegbrowsers  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102AD9D  +
push edi  +
push edi  +
push 1  +
call sub_103925C  +
call sub_10288C2  +
push edi  +
push edi  +
push 3000h  +
push 8000000h  +
call ebx  +
push 44Ch  +
push 0A28h  +
push 1  +
push 5  +
call sub_102FFFB  +
test eax eax +
jz loc_102AE86  +
call sub_102D126  +
test eax eax +
jnz loc_102AE86  +
call sub_1027C11  +
test eax eax +
jnz loc_102AE86  +
push edi  +
mov [ebp+hKey] edi +
call sub_10288DD  +
call sub_102CFAC  +
call sub_1036681  +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 3  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMicr_1  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_102AE78  +
push 0FFh  +
lea eax [ebp+Data] +
push eax  +
call sub_102FC69  +
test eax eax +
jz loc_102AE6C  +
push offset aHidewmp_0  +
push 100h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027EDD  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_102AE3E  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push offset aStubpath  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push edi  +
push edi  +
push 3000h  +
push 8000000h  +
call ebx  +
lea eax [ebp+ulOptions] +
push eax  +
push offset aCurrentCommand  +
push 2  +
call sub_1039F55  +
add esp 0Ch +
call sub_1039930  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
xor eax eax +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 10h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 0A4h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
xor esi esi +
xor eax eax +
xor ebx ebx +
inc ebx  +
cmp [ebp+arg_0] esi +
push edi  +
setz al  +
mov dword ptr [ebp+var_88] ebx +
mov [ebp+var_A0] esi +
mov [ebp+var_90] esi +
mov [ebp+var_94] esi +
mov [ebp+var_8C] esi +
mov [ebp+var_9C] esi +
mov edi eax +
lea eax [ebp+var_A0] +
push eax  +
mov [ebp+var_98] esi +
call WMDRMCreateProvider  +
mov dword ptr [ebp+var_88] eax +
mov eax [ebp+var_A0] +
cmp eax esi +
jz loc_102B0A8  +
cmp dword ptr [ebp+var_88] esi +
jl loc_102B0A8  +
mov ecx [eax] +
lea edx [ebp+var_90] +
push edx  +
push offset dword_1026E3C  +
push eax  +
call dword ptr [ecx+0Ch]  +
mov dword ptr [ebp+var_88] eax +
mov eax [ebp+var_90] +
cmp eax esi +
jz loc_102B0A8  +
cmp dword ptr [ebp+var_88] esi +
jl loc_102B0A8  +
mov ecx [eax] +
lea edx [ebp+var_94] +
push edx  +
push offset dword_1026E2C  +
push eax  +
call dword ptr [ecx]  +
mov dword ptr [ebp+var_88] eax +
cmp [ebp+var_94] esi +
jz loc_102B0A8  +
cmp eax esi +
jl loc_102B0A8  +
cmp edi esi +
jnz loc_102AFFA  +
mov eax [ebp+var_90] +
mov ecx [eax] +
lea edx [ebp+var_A4] +
push edx  +
push eax  +
call dword ptr [ecx+24h]  +
test eax eax +
jl loc_102AFEF  +
push [ebp+var_A4]  +
lea eax [ebp+var_84] +
push 80h  +
push eax  +
call sub_1027EA2  +
test eax eax +
jl loc_102AFEF  +
lea eax [ebp+var_84] +
push 2Eh  +
push eax  +
call ds:wcsrchr  +
pop ecx  +
pop ecx  +
cmp eax esi +
jz loc_102AFEF  +
add eax 2 +
push eax  +
call ds:_wtol  +
and eax ebx +
pop ecx  +
cmp al bl +
jz loc_102AFFA  +
mov dword ptr [ebp+var_88] ebx +
jmp loc_102B0A8  +
mov eax [ebp+var_90] +
mov ecx [eax] +
lea edx [ebp+var_9C] +
push edx  +
push ebx  +
push eax  +
call dword ptr [ecx+2Ch]  +
cmp eax esi +
mov dword ptr [ebp+var_88] eax +
jl loc_102B0A8  +
mov edi 1FCh +
cmp [ebp+var_98] edi +
jz loc_102B08E  +
mov eax [ebp+var_8C] +
cmp eax esi +
jz loc_102B03F  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov [ebp+var_8C] esi +
mov eax [ebp+var_94] +
mov ecx [eax] +
lea edx [ebp+var_8C] +
push edx  +
push esi  +
push eax  +
call dword ptr [ecx+0Ch]  +
mov dword ptr [ebp+var_88] eax +
mov eax [ebp+var_8C] +
cmp eax esi +
jz loc_102B0A8  +
cmp dword ptr [ebp+var_88] esi +
jl loc_102B094  +
mov ecx [eax] +
lea edx [ebp+var_98] +
push edx  +
push eax  +
call dword ptr [ecx+84h]  +
cmp eax esi +
mov dword ptr [ebp+var_88] eax +
jl loc_102B08E  +
push esi  +
call ds:Sleep  +
jmp loc_102B021  +
mov eax [ebp+var_8C] +
cmp eax esi +
jz loc_102B0A8  +
mov ecx [eax] +
lea edx [ebp+var_88] +
push edx  +
push eax  +
call dword ptr [ecx+8Ch]  +
push dword ptr [ebp+var_88]  +
push offset aIndivReturned0  +
push 2  +
call sub_1039F55  +
mov eax [ebp+var_9C] +
add esp 0Ch +
cmp eax esi +
jz loc_102B0D3  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov [ebp+var_9C] esi +
mov eax [ebp+var_8C] +
cmp eax esi +
jz loc_102B0E9  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov [ebp+var_8C] esi +
mov eax [ebp+var_94] +
cmp eax esi +
jz loc_102B0FF  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov [ebp+var_94] esi +
mov eax [ebp+var_90] +
cmp eax esi +
jz loc_102B125  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+20h]  +
mov eax [ebp+var_90] +
cmp eax esi +
jz loc_102B125  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov [ebp+var_90] esi +
mov eax [ebp+var_A0] +
pop edi  +
cmp eax esi +
pop esi  +
pop ebx  +
jz loc_102B138  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov ecx [ebp+var_4] +
mov eax dword ptr [ebp+var_88] +
xor ecx ebp +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push ebx  +
push edi  +
mov edi [ebp+arg_0] +
xor ebx ebx +
mov [ebp+hKey] ebx +
cmp edi ebx +
jz loc_102B1D4  +
push ebx  +
lea eax [ebp+hKey] +
push eax  +
push ebx  +
push 2001Fh  +
push ebx  +
push ebx  +
push ebx  +
push offset aSoftwareMic_45  +
push 80000001h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_102B1D4  +
push esi  +
push edi  +
push offset aPlugin  +
push [ebp+hKey]  +
call sub_102F670  +
mov esi eax +
cmp esi ebx +
jz loc_102B1CA  +
mov eax edi +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_102B1A1  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push edi  +
push 1  +
push ebx  +
push esi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
push esi  +
call ds:free  +
pop ecx  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop esi  +
pop edi  +
pop ebx  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 21Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_4] +
mov ecx [ebp+arg_8] +
push ebx  +
mov ebx [ebp+arg_0] +
push edi  +
xor edi edi +
mov [ebp+var_21C] ebx +
mov [ebp+var_214] eax +
mov [ebp+var_218] ecx +
mov [ebp+var_210] edi +
cmp eax edi +
jz loc_102B39A  +
cmp ebx edi +
jz loc_102B39A  +
push esi  +
push edi  +
push edi  +
push offset aNpdsplay_dll  +
push eax  +
push ebx  +
call sub_10312EE  +
mov esi 0D2AF9h +
cmp eax esi +
jnz loc_102B247  +
mov [ebp+var_210] esi +
push edi  +
push edi  +
push offset aNpds_zip  +
push [ebp+var_214]  +
push ebx  +
call sub_10312EE  +
cmp eax esi +
jnz loc_102B264  +
mov [ebp+var_210] esi +
push edi  +
push edi  +
push offset aNpwmsdrm_dll  +
push [ebp+var_214]  +
push ebx  +
call sub_10312EE  +
cmp eax esi +
jnz loc_102B281  +
mov [ebp+var_210] esi +
push edi  +
push edi  +
push offset aNpdrmv2_dll  +
push [ebp+var_214]  +
push ebx  +
call sub_10312EE  +
cmp eax esi +
jnz loc_102B29E  +
mov [ebp+var_210] esi +
push edi  +
push edi  +
push offset aNpdrmv2_zip  +
push [ebp+var_214]  +
push ebx  +
call sub_10312EE  +
cmp eax esi +
jnz loc_102B2BB  +
mov [ebp+var_210] esi +
mov ebx 103h +
cmp [ebp+var_218] edi +
jz loc_102B351  +
push [ebp+var_218]  +
call sub_102FE6A  +
test eax eax +
jz loc_102B351  +
push ebx  +
push offset aClasses  +
push [ebp+var_218]  +
lea eax [ebp+FileName] +
push eax  +
call sub_102D262  +
push edi  +
push edi  +
push offset aWmpns_jar  +
lea eax [ebp+FileName] +
push eax  +
push [ebp+var_21C]  +
call sub_10312EE  +
cmp eax esi +
jnz loc_102B316  +
mov [ebp+var_210] esi +
push ebx  +
push offset aBin  +
push [ebp+var_218]  +
lea eax [ebp+FileName] +
push eax  +
call sub_102D262  +
push edi  +
push edi  +
push offset aWmpns_dll  +
lea eax [ebp+FileName] +
push eax  +
push [ebp+var_21C]  +
call sub_10312EE  +
cmp eax esi +
jnz loc_102B351  +
mov [ebp+var_210] esi +
push [ebp+var_214]  +
call sub_102B151  +
push ebx  +
push offset aNpplayns_dll  +
push [ebp+var_214]  +
lea eax [ebp+FileName] +
push eax  +
call sub_102D262  +
push 1  +
push edi  +
push edi  +
push 1  +
push edi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1030A20  +
cmp eax esi +
jnz loc_102B391  +
mov [ebp+var_210] esi +
mov eax [ebp+var_210] +
pop esi  +
jmp loc_102B39F  +
mov eax 80070003h +
mov ecx [ebp+var_4] +
pop edi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 21Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
and [ebp+hKey] 0 +
push ebx  +
push esi  +
mov esi ds:RegOpenKeyExW +
push edi  +
lea eax [ebp+hKey] +
push eax  +
mov edi 20019h +
push edi  +
push 0  +
xor ebx ebx +
push offset aSoftwareNetsca  +
inc ebx  +
push 80000001h  +
mov [ebp+Type] ebx +
call esi  +
test eax eax +
jnz loc_102B414  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov eax ebx +
jmp loc_102B520  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 0  +
push offset aSoftwareMic_46  +
mov ebx 80000002h +
push ebx  +
call esi  +
test eax eax +
jnz loc_102B4A8  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push 0  +
push [ebp+hKey]  +
mov [ebp+cbData] 104h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102B487  +
cmp [ebp+Type] 1 +
jnz loc_102B487  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_102B487  +
mov [ebp+var_21C] 1 +
jmp loc_102B48E  +
and [ebp+var_21C] 0 +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp [ebp+var_21C] 0 +
jz loc_102B4A8  +
xor eax eax +
inc eax  +
jmp loc_102B520  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 0  +
push offset aSoftwareMic_47  +
push ebx  +
call esi  +
test eax eax +
jnz loc_102B51E  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push 0  +
push [ebp+hKey]  +
mov [ebp+cbData] 104h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102B50C  +
xor esi esi +
inc esi  +
cmp [ebp+Type] esi +
jnz loc_102B50C  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jnz loc_102B50E  +
xor esi esi +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov eax esi +
jmp loc_102B520  +
xor eax eax +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 640h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
push edi  +
xor edi edi +
mov [ebp+var_640] eax +
mov [ebp+hKey] edi +
mov [ebp+phkResult] edi +
mov [ebp+var_63C] edi +
cmp eax edi +
jnz loc_102B575  +
mov eax 80004005h +
jmp loc_102B80F  +
push ebx  +
mov ebx ds:RegOpenKeyExW +
push esi  +
mov [ebp+var_630] edi +
mov esi 105h +
lea eax [ebp+SubKey] +
cmp [ebp+var_630] edi +
jz loc_102B59D  +
push offset aSoftwareNets_0  +
jmp loc_102B5A2  +
push offset aSoftwareNets_1  +
push 103h  +
push eax  +
call sub_1027E68  +
lea eax [ebp+hKey] +
push eax  +
push 20019h  +
push edi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000002h  +
call ebx  +
test eax eax +
jnz loc_102B7F4  +
push esi  +
lea eax [ebp+Name] +
push eax  +
push edi  +
push [ebp+hKey]  +
mov [ebp+cbData] esi +
mov [ebp+dwIndex] edi +
call ds:RegEnumKeyW  +
test eax eax +
jnz loc_102B7E8  +
inc [ebp+dwIndex]  +
lea eax [ebp+Name] +
push eax  +
push offset aSMain  +
lea eax [ebp+SubKey] +
push 103h  +
mov edi 20Ah +
push eax  +
mov [ebp+cbData] edi +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+phkResult] +
push eax  +
push 20019h  +
push 0  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+hKey]  +
call ebx  +
test eax eax +
jnz loc_102B7BE  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aPluginsDirecto  +
push [ebp+phkResult]  +
mov [ebp+Type] 1 +
mov [ebp+cbData] edi +
call ds:RegQueryValueExW  +
mov edi eax +
test edi edi +
jnz loc_102B696  +
cmp [ebp+Type] 1 +
jz loc_102B6FF  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aInstallDirecto  +
push [ebp+phkResult]  +
call ds:RegQueryValueExW  +
mov edi eax +
test edi edi +
jnz loc_102B75B  +
cmp [ebp+Type] 1 +
jnz loc_102B828  +
lea eax [ebp+Name] +
push eax  +
call sub_102E61A  +
lea eax [ebp+Name] +
cmp [ebp+var_630] edi +
jnz loc_102B81E  +
push offset aProgramPlugins  +
push esi  +
push eax  +
call sub_1027EDD  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_620] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aJavaDirectory  +
push [ebp+phkResult]  +
mov [ebp+cbData] 208h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102B73E  +
cmp [ebp+Type] 1 +
jz loc_102B75B  +
push 103h  +
push offset aJava  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+var_620] +
push eax  +
call sub_102D262  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
test edi edi +
jnz loc_102B7BE  +
lea eax [ebp+Name] +
push eax  +
call sub_102FE6A  +
test eax eax +
jz loc_102B7BE  +
push esi  +
lea eax [ebp+Name] +
push eax  +
push eax  +
call ds:GetShortPathNameW  +
lea eax [ebp+Name] +
push eax  +
call sub_102E61A  +
lea eax [ebp+var_620] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push [ebp+var_640]  +
call sub_102B1DF  +
mov ecx 0D2AF9h +
cmp eax ecx +
jnz loc_102B7BE  +
mov [ebp+var_63C] ecx +
push esi  +
lea eax [ebp+Name] +
push eax  +
push [ebp+dwIndex]  +
mov [ebp+cbData] esi +
push [ebp+hKey]  +
call ds:RegEnumKeyW  +
test eax eax +
jz loc_102B5F9  +
xor edi edi +
push [ebp+hKey]  +
call ds:RegCloseKey  +
inc [ebp+var_630]  +
cmp [ebp+var_630] 2 +
jl loc_102B588  +
mov eax [ebp+var_63C] +
pop esi  +
pop ebx  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn 4  +
push offset aPlugins  +
jmp loc_102B6F8  +
push 1Fh  +
pop edi  +
jmp loc_102B75B  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 0A4Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
xor esi esi +
push 104h  +
push esi  +
lea eax [ebp+var_20C] +
push eax  +
mov [ebp+var_A44] esi +
mov [ebp+hKey] esi +
mov [ebp+phkResult] esi +
call sub_10302A3  +
test eax eax +
jnz loc_102B87F  +
mov eax 80004005h +
jmp loc_102BA21  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102E61A  +
push offset aSoftwareJavaso  +
push 105h  +
lea eax [ebp+SubKey] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_102BA1B  +
push ebx  +
push edi  +
mov edi ds:RegOpenKeyExW +
lea eax [ebp+hKey] +
push eax  +
mov ebx 20019h +
push ebx  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000002h  +
call edi  +
test eax eax +
jnz loc_102BA19  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
mov esi ds:RegQueryValueExW +
push offset aCurrentversion  +
push [ebp+hKey]  +
mov [ebp+Type] 1 +
mov [ebp+cbData] 208h +
call esi  +
test eax eax +
jnz loc_102BA0D  +
cmp [ebp+Type] 1 +
jnz loc_102BA0D  +
lea eax [ebp+phkResult] +
push eax  +
push ebx  +
xor ebx ebx +
push ebx  +
lea eax [ebp+Data] +
push eax  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jnz loc_102BA0D  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_418] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
push offset aJavahome  +
push [ebp+phkResult]  +
mov [ebp+cbData] 20Ah +
call esi  +
test eax eax +
jnz loc_102BA01  +
cmp [ebp+Type] 1 +
jnz loc_102BA01  +
push offset aLibApplet  +
mov edi 105h +
push edi  +
lea eax [ebp+var_418] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102BA01  +
push ebx  +
push ebx  +
push offset aWmpns_jar_0  +
lea eax [ebp+var_418] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
call sub_10312EE  +
mov esi 0D2AF9h +
cmp eax esi +
jnz loc_102B9CB  +
mov [ebp+var_A44] esi +
push edi  +
lea eax [ebp+Buffer] +
push eax  +
call ds:GetSystemDirectoryW  +
test eax eax +
jz loc_102BA01  +
push ebx  +
push ebx  +
push offset aWmpns_dll  +
lea eax [ebp+Buffer] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
call sub_10312EE  +
cmp eax esi +
jnz loc_102BA01  +
mov [ebp+var_A44] esi +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
pop ebx  +
mov eax [ebp+var_A44] +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 414h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push 104h  +
xor ebx ebx +
push ebx  +
lea eax [ebp+var_20C] +
push eax  +
call sub_10302A3  +
test eax eax +
jnz loc_102BA6B  +
mov eax 80004005h +
jmp loc_102BB0D  +
push esi  +
push edi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102E61A  +
push offset aNpdsplay_dll  +
lea eax [ebp+var_20C] +
push eax  +
mov edi offset aSS_0 +
push edi  +
mov esi 103h +
lea eax [ebp+FileName] +
push esi  +
push eax  +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jnz loc_102BAE4  +
push offset aNpwmsdrm_dll  +
lea eax [ebp+var_20C] +
push eax  +
push edi  +
lea eax [ebp+FileName] +
push esi  +
push eax  +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jnz loc_102BAE4  +
mov eax 80070002h +
jmp loc_102BB0B  +
call sub_102B3B4  +
test eax eax +
jz loc_102BB04  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102B534  +
mov ecx 0D2AF9h +
cmp eax ecx +
jnz loc_102BB04  +
mov ebx ecx +
call sub_102B835  +
mov eax ebx +
pop edi  +
pop esi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push edi  +
xor edi edi +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 3  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMicr_6  +
push 80000001h  +
mov [ebp+hKey] edi +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_102BB9C  +
push esi  +
push [ebp+lpData]  +
push offset aShortcut  +
push [ebp+hKey]  +
call sub_102F670  +
mov esi eax +
cmp esi edi +
jz loc_102BB92  +
mov eax [ebp+lpData] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_102BB67  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push [ebp+lpData]  +
push 1  +
push edi  +
push esi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
push esi  +
call ds:free  +
pop ecx  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop esi  +
pop edi  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
mov esi [ebp+arg_4] +
push edi  +
xor edi edi +
cmp [ebp+arg_8] edi +
jnz loc_102BBBE  +
mov eax 80070057h +
jmp loc_102BC0F  +
cmp esi edi +
jnz loc_102BBED  +
push 208h  +
call ??_U@YAPAXI@Z  +
mov esi eax +
pop ecx  +
cmp esi edi +
jnz loc_102BBDA  +
mov eax 8007000Eh +
jmp loc_102BC0F  +
push offset aSystemrootSyst  +
push 104h  +
xor edi edi +
push esi  +
inc edi  +
call sub_1027EA2  +
push ebx  +
push [ebp+arg_8]  +
push esi  +
push [ebp+arg_0]  +
call ds:SHSetLocalizedName  +
mov ebx eax +
test edi edi +
jz loc_102BC0C  +
test esi esi +
jz loc_102BC0C  +
push esi  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov eax ebx +
pop ebx  +
pop edi  +
pop esi  +
pop ebp  +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push esi  +
mov esi [ebp+ppv] +
test esi esi +
jz loc_102BC8F  +
push edi  +
lea eax [ebp+var_4] +
push eax  +
push offset dword_1004E10  +
push 0  +
push esi  +
call ds:SHCreateItemFromParsingName  +
push 80h  +
push esi  +
mov edi eax +
call ds:SetFileAttributesW  +
push esi  +
call ds:DeleteFileW  +
test edi edi +
pop edi  +
jl loc_102BC8F  +
lea eax [ebp+ppv] +
push eax  +
push offset stru_1004E00  +
push 1  +
push 0  +
push offset stru_100C3E8  +
call ds:CoCreateInstance  +
test eax eax +
jl loc_102BC86  +
mov eax [ebp+ppv] +
push [ebp+var_4]  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+0Ch]  +
mov eax [ebp+ppv] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov eax [ebp+var_4] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
pop esi  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov eax 1880h +
call __alloca_probe  +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
and [ebp+var_1870] 0 +
mov dword ptr [ebp+dwItem1] eax +
test eax eax +
jz loc_102C0B9  +
xor ecx ecx +
cmp cx [eax] +
jz loc_102C0B9  +
push ebx  +
push esi  +
push edi  +
mov esi 104h +
mov ebx offset unk_1040C60 +
cmp dword_1040C58 ecx +
jnz loc_102BDA8  +
xor eax eax +
inc eax  +
push esi  +
push eax  +
push ebx  +
mov dword_1040C58 eax +
call sub_10302A3  +
mov edi offset aNomatch +
test eax eax +
jz loc_102BD35  +
push ebx  +
call sub_102E61A  +
push offset aWmplayer_exe  +
push esi  +
push ebx  +
call sub_1027EDD  +
push esi  +
push offset szShortPath  +
push ebx  +
call ds:GetShortPathNameW  +
test eax eax +
jnz loc_102BD49  +
push edi  +
push esi  +
push offset szShortPath  +
jmp loc_102BD44  +
push edi  +
push esi  +
push offset szShortPath  +
call sub_1027E68  +
push edi  +
push esi  +
push ebx  +
call sub_1027E68  +
push esi  +
push offset szLongPath  +
call sub_102D1F5  +
test eax eax +
jz loc_102BD90  +
push offset szLongPath  +
call sub_102E61A  +
push offset aWmplayer_exe  +
push esi  +
push offset szLongPath  +
call sub_1027EDD  +
push esi  +
push offset word_1040640  +
push offset szLongPath  +
call ds:GetShortPathNameW  +
test eax eax +
jnz loc_102BDA8  +
push edi  +
push esi  +
push offset word_1040640  +
jmp loc_102BDA3  +
push edi  +
push esi  +
push offset word_1040640  +
call sub_1027E68  +
push edi  +
push esi  +
push offset szLongPath  +
call sub_1027E68  +
lea eax [ebp+PathName] +
push eax  +
push esi  +
call ds:GetCurrentDirectoryW  +
test eax eax +
jz loc_102C0AE  +
push dword ptr [ebp+dwItem1]  +
call ds:SetCurrentDirectoryW  +
test eax eax +
jz loc_102C0A1  +
lea eax [ebp+FindFileData] +
push eax  +
push offset FileName  +
call ds:FindFirstFileW  +
mov [ebp+hFindFile] eax +
cmp eax 0FFFFFFFFh +
jz loc_102BF8A  +
lea eax [ebp+ppv] +
push eax  +
push offset stru_100C3C8  +
push 1  +
push 0  +
push offset stru_100C3D8  +
call ds:CoCreateInstance  +
test eax eax +
jl loc_102BF7E  +
mov eax [ebp+ppv] +
mov ecx [eax] +
lea edx [ebp+var_1880] +
push edx  +
push offset dword_100C3F8  +
push eax  +
call dword ptr [ecx]  +
test eax eax +
jl loc_102BF72  +
mov edi ds:_wcsicmp +
mov eax [ebp+var_1880] +
mov ecx [eax] +
push 0  +
lea edx [ebp+FindFileData.cFileName] +
push edx  +
push eax  +
call dword ptr [ecx+14h]  +
test eax eax +
jl loc_102BF4B  +
mov eax [ebp+ppv] +
mov ecx [eax] +
push 0  +
push 0  +
push esi  +
lea edx [ebp+FileName] +
push edx  +
push eax  +
call dword ptr [ecx+0Ch]  +
test eax eax +
jl loc_102BF4B  +
lea eax [ebp+FileName] +
push eax  +
push ebx  +
call edi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102BEC8  +
lea eax [ebp+FileName] +
push eax  +
push offset szShortPath  +
call edi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102BEC8  +
lea eax [ebp+FileName] +
push eax  +
push offset szLongPath  +
call edi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102BEC8  +
lea eax [ebp+FileName] +
push eax  +
push offset word_1040640  +
call edi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_102BF4B  +
mov eax [ebp+ppv] +
mov ecx [eax] +
push 800h  +
lea edx [ebp+pszPath] +
push edx  +
push eax  +
call dword ptr [ecx+28h]  +
test eax eax +
jl loc_102BF4B  +
lea eax [ebp+pszPath] +
push eax  +
call ds:PathRemoveBlanksW  +
cmp [ebp+pszPath] 0 +
jz loc_102BF0F  +
lea eax [ebp+pszPath] +
push offset aPrefetch1  +
push eax  +
call edi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_102BF4B  +
lea eax [ebp+FindFileData.cFileName] +
push eax  +
push dword ptr [ebp+dwItem1]  +
lea eax [ebp+var_414] +
push offset aSS  +
push 208h  +
push eax  +
call sub_1027F9F  +
add esp 14h +
test eax eax +
jl loc_102BF4B  +
lea eax [ebp+var_414] +
push eax  +
call sub_102BC1A  +
inc [ebp+var_1870]  +
lea eax [ebp+FindFileData] +
push eax  +
push [ebp+hFindFile]  +
call ds:FindNextFileW  +
test eax eax +
jnz loc_102BE3B  +
mov eax [ebp+var_1880] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov eax [ebp+ppv] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
push [ebp+hFindFile]  +
call ds:FindClose  +
cmp [ebp+arg_4] 1 +
jnz loc_102C083  +
push dword ptr [ebp+dwItem1]  +
lea eax [ebp+FileName] +
push esi  +
push eax  +
call sub_1027E68  +
push offset asc_1004E2C  +
push esi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102C083  +
xor eax eax +
push eax  +
push eax  +
push 1  +
lea ecx [ebp+FindFileData] +
push ecx  +
push eax  +
lea eax [ebp+FileName] +
push eax  +
call ds:FindFirstFileExW  +
mov edi eax +
cmp edi 0FFFFFFFFh +
jz loc_102C083  +
mov ebx ds:lstrcmpW +
push offset String2  +
lea eax [ebp+FindFileData.cFileName] +
push eax  +
call ebx  +
test eax eax +
jz loc_102C066  +
push offset a__  +
lea eax [ebp+FindFileData.cFileName] +
push eax  +
call ebx  +
test eax eax +
jz loc_102C066  +
push dword ptr [ebp+dwItem1]  +
lea eax [ebp+FileName] +
push esi  +
push eax  +
call sub_1027E68  +
push offset SubBlock  +
push esi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102C066  +
lea eax [ebp+FindFileData.cFileName] +
push eax  +
push esi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102C066  +
push 1  +
lea eax [ebp+FileName] +
push eax  +
call sub_102BC9B  +
add [ebp+var_1870] eax +
lea eax [ebp+FindFileData] +
push eax  +
push edi  +
call ds:FindNextFileW  +
test eax eax +
jnz loc_102BFED  +
push edi  +
call ds:FindClose  +
cmp [ebp+var_1870] 0 +
jz loc_102C0A1  +
push 0  +
push dword ptr [ebp+dwItem1]  +
push 5  +
push 1000h  +
call ds:SHChangeNotify  +
lea eax [ebp+PathName] +
push eax  +
call ds:SetCurrentDirectoryW  +
mov eax [ebp+var_1870] +
pop edi  +
pop esi  +
pop ebx  +
jmp loc_102C0BB  +
xor eax eax +
mov ecx [ebp+var_4] +
xor ecx ebp +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 464h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push edi  +
mov edi [ebp+arg_0] +
test edi edi +
jz loc_102C293  +
mov eax edi +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_102C0F4  +
push ebx  +
push esi  +
sub eax edx +
sar eax 1 +
push edi  +
mov esi eax +
mov ebx 104h +
push ebx  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_102C291  +
test esi esi +
jz loc_102C151  +
movzx eax word ptr [edi+esi*2-2] +
cmp ax 3Ah +
jz loc_102C151  +
cmp ax 5Ch +
jz loc_102C151  +
push offset SubBlock  +
push ebx  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102C291  +
inc esi  +
lea eax [esi+2] +
cmp eax ebx +
ja loc_102C291  +
push offset asc_1002FC4  +
push ebx  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102C291  +
lea eax [ebp+FindFileData] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
call ds:FindFirstFileW  +
mov [ebp+hFindFile] eax +
cmp eax 0FFFFFFFFh +
jz loc_102C291  +
push 4  +
lea edi [ebp+esi*2+FileName] +
pop esi  +
xor eax eax +
mov [edi] ax +
lea eax [ebp+FindFileData.cAlternateFileName] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_102C1B1  +
sub eax edx +
sar eax 1 +
lea eax [ebp+FindFileData.cAlternateFileName] +
jnz loc_102C1CD  +
lea eax [ebp+FindFileData.cFileName] +
push eax  +
push ebx  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102C285  +
test byte ptr [ebp+FindFileData.dwFileAttributes] 10h +
jz loc_102C26A  +
mov ecx offset String2 +
lea eax [ebp+FindFileData.cFileName] +
mov dx [eax] +
cmp dx [ecx] +
jnz loc_102C21B  +
test dx dx +
jz loc_102C217  +
mov dx [eax+2] +
cmp dx [ecx+2] +
jnz loc_102C21B  +
add eax esi +
add ecx esi +
test dx dx +
jnz loc_102C1F7  +
xor eax eax +
jmp loc_102C220  +
sbb eax eax +
sbb eax 0FFFFFFFFh +
test eax eax +
jz loc_102C26A  +
mov ecx offset a__ +
lea eax [ebp+FindFileData.cFileName] +
mov dx [eax] +
cmp dx [ecx] +
jnz loc_102C253  +
test dx dx +
jz loc_102C24F  +
mov dx [eax+2] +
cmp dx [ecx+2] +
jnz loc_102C253  +
add eax esi +
add ecx esi +
test dx dx +
jnz loc_102C22F  +
xor eax eax +
jmp loc_102C258  +
sbb eax eax +
sbb eax 0FFFFFFFFh +
test eax eax +
jz loc_102C26A  +
push 1  +
lea eax [ebp+FileName] +
push eax  +
call sub_102BC9B  +
lea eax [ebp+FindFileData] +
push eax  +
push [ebp+hFindFile]  +
call ds:FindNextFileW  +
test eax eax +
jnz loc_102C1A3  +
push [ebp+hFindFile]  +
call ds:FindClose  +
pop esi  +
pop ebx  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 210h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
push edi  +
push 0  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_20C] +
mov edi 208h +
push eax  +
mov [ebp+var_210] edi +
call sub_102D7B3  +
mov esi ds:wcsrchr +
test eax eax +
jz loc_102C2F8  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102FE6A  +
test eax eax +
jnz loc_102C327  +
push 0  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
mov [ebp+var_210] edi +
call sub_102D913  +
test eax eax +
jz loc_102C349  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102FE6A  +
test eax eax +
jz loc_102C349  +
lea eax [ebp+var_20C] +
push 5Ch  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102C349  +
xor ecx ecx +
mov [eax] cx +
lea eax [ebp+var_20C] +
push eax  +
call sub_102C0CE  +
push 1  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
mov [ebp+var_210] edi +
call sub_102D7B3  +
test eax eax +
jz loc_102C378  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102FE6A  +
test eax eax +
jnz loc_102C3A7  +
push 1  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
mov [ebp+var_210] edi +
call sub_102D913  +
test eax eax +
jz loc_102C3C9  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102FE6A  +
test eax eax +
jz loc_102C3C9  +
lea eax [ebp+var_20C] +
push 5Ch  +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102C3C9  +
xor ecx ecx +
mov [eax] cx +
lea eax [ebp+var_20C] +
push eax  +
call sub_102C0CE  +
mov ecx [ebp+var_4] +
pop edi  +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 2E4h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
lea eax [ebp+hKey] +
push eax  +
push 2001Fh  +
xor ebx ebx +
push ebx  +
push offset aSoftwareMicr_6  +
push 80000001h  +
mov [ebp+hKey] ebx +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102C52A  +
push esi  +
push ebx  +
mov esi offset aShortcutLu +
push esi  +
lea eax [ebp+ValueName] +
push 63h  +
push eax  +
mov [ebp+cbData] 208h +
mov [ebp+Type] 1 +
call sub_1027F64  +
add esp 10h +
mov dword ptr [ebp+var_2E0] 1 +
jmp loc_102C4E8  +
cmp [ebp+Type] 1 +
jnz loc_102C51D  +
lea eax [ebp+ppv] +
push eax  +
call sub_102BC1A  +
push ebx  +
lea eax [ebp+ppv] +
push eax  +
push 5  +
push 4  +
call ds:SHChangeNotify  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
lea eax [ebp+ppv] +
push 5Ch  +
push eax  +
call ds:wcsrchr  +
pop ecx  +
pop ecx  +
cmp eax ebx +
jz loc_102C4C0  +
xor ecx ecx +
mov [eax] cx +
push ebx  +
lea eax [ebp+ppv] +
push eax  +
call sub_102BC9B  +
push dword ptr [ebp+var_2E0]  +
lea eax [ebp+ValueName] +
push esi  +
push 63h  +
push eax  +
mov [ebp+cbData] 208h +
call sub_1027F64  +
add esp 10h +
inc dword ptr [ebp+var_2E0]  +
test eax eax +
jl loc_102C51D  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+ppv] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+hKey]  +
call ds:RegQueryValueExW  +
test eax eax +
jz loc_102C45B  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop esi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 21Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
push edi  +
xor edi edi +
push edi  +
mov [ebp+lpData] eax +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 3  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMicr_6  +
push 80000001h  +
mov [ebp+hKey] edi +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_102C637  +
push ebx  +
push esi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
mov esi offset aAppname +
push esi  +
push [ebp+hKey]  +
xor ebx ebx +
inc ebx  +
mov [ebp+cbData] 208h +
mov [ebp+Type] ebx +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102C5F3  +
cmp [ebp+Type] ebx +
jnz loc_102C5F3  +
cmp [ebp+cbData] ebx +
jbe loc_102C5F8  +
push [ebp+lpData]  +
lea eax [ebp+Data] +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102C5F8  +
call sub_102C3DC  +
mov eax [ebp+lpData] +
lea ecx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_102C601  +
sub eax ecx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push [ebp+lpData]  +
push ebx  +
push edi  +
push esi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop esi  +
pop ebx  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 44Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov edx [ebp+arg_18] +
mov eax [ebp+arg_0] +
mov ecx [ebp+arg_14] +
push ebx  +
mov ebx [ebp+arg_10] +
mov [ebp+var_428] edx +
mov edx [ebp+arg_20] +
push esi  +
mov [ebp+var_434] eax +
mov eax dword ptr [ebp+arg_4] +
xor esi esi +
mov [ebp+var_43C] edx +
mov edx [ebp+arg_28] +
push edi  +
mov edi [ebp+arg_8] +
mov [ebp+var_42C] ecx +
mov [ebp+var_430] edx +
mov [ebp+ppv] esi +
cmp eax esi +
jz loc_102C8DE  +
cmp [ebp+arg_C] esi +
jz loc_102C8DE  +
cmp edi esi +
jz loc_102C8DE  +
cmp ecx esi +
jnz loc_102C6C8  +
mov [ebp+var_42C] offset byte_1002720 +
push edi  +
push eax  +
push offset aSS_lnk  +
lea eax [ebp+Data] +
push 207h  +
push eax  +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+ppv] +
push eax  +
push offset stru_100C3C8  +
push 1  +
push esi  +
push offset stru_100C3D8  +
call ds:CoCreateInstance  +
mov esi eax +
test esi esi +
jl loc_102C8CA  +
mov eax [ebp+ppv] +
and [ebp+var_424] 0 +
mov ecx [eax] +
lea edx [ebp+var_420] +
push edx  +
push offset loc_1004EC0  +
push eax  +
call dword ptr [ecx]  +
test eax eax +
jl loc_102C765  +
mov eax [ebp+var_420] +
mov ecx [eax] +
lea edx [ebp+var_438] +
push edx  +
push eax  +
call dword ptr [ecx+18h]  +
test eax eax +
jl loc_102C759  +
mov edx [ebp+var_438] +
mov eax [ebp+var_420] +
mov ecx [eax] +
or edx 2000100h +
push edx  +
push eax  +
call dword ptr [ecx+1Ch]  +
mov eax [ebp+var_420] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov eax [ebp+ppv] +
push [ebp+var_434]  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+50h]  +
xor esi esi +
cmp ebx esi +
jz loc_102C77F  +
mov edi ebx +
mov eax [ebp+ppv] +
mov ecx [eax] +
push edi  +
push eax  +
call dword ptr [ecx+1Ch]  +
mov eax [ebp+ppv] +
push [ebp+var_42C]  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+2Ch]  +
cmp [ebp+var_428] esi +
jz loc_102C7BB  +
push [ebp+arg_1C]  +
mov eax [ebp+ppv] +
push [ebp+var_428]  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+44h]  +
cmp [ebp+var_430] esi +
jz loc_102C7D5  +
mov eax [ebp+ppv] +
push [ebp+var_430]  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+24h]  +
mov eax [ebp+ppv] +
lea edx [ebp+var_41C] +
push edx  +
push offset dword_100C41C  +
mov [ebp+var_41C] esi +
mov ecx [eax] +
push eax  +
call dword ptr [ecx]  +
mov esi eax +
test esi esi +
jl loc_102C8CA  +
xor eax eax +
lea edi [ebp+pvar] +
stos   +
stos   +
stos   +
push 8  +
stos   +
pop eax  +
push offset aMicrosoft_wind  +
mov [ebp+pvar.vt] ax +
call ds:SysAllocString  +
lea edx [ebp+pvar] +
push edx  +
mov dword ptr [ebp+pvar.anonymous_0] eax +
mov eax [ebp+var_41C] +
mov ecx [eax] +
push offset dword_100C408  +
push eax  +
call dword ptr [ecx+18h]  +
mov eax [ebp+var_41C] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+1Ch]  +
mov eax [ebp+var_41C] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
lea eax [ebp+pvar] +
push eax  +
call sub_103D3C9  +
mov eax [ebp+ppv] +
mov ecx [eax] +
lea edx [ebp+var_424] +
push edx  +
push offset dword_100C3F8  +
push eax  +
call dword ptr [ecx]  +
mov esi eax +
test esi esi +
jl loc_102C8CA  +
mov eax [ebp+var_424] +
mov ecx [eax] +
push 1  +
lea edx [ebp+Data] +
push edx  +
push eax  +
call dword ptr [ecx+18h]  +
mov esi eax +
mov eax [ebp+var_424] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
test esi esi +
jl loc_102C8CA  +
cmp [ebp+arg_24] 0 +
jz loc_102C8BE  +
push [ebp+arg_24]  +
lea eax [ebp+Data] +
push [ebp+var_43C]  +
push eax  +
call sub_102BBA6  +
lea eax [ebp+Data] +
push eax  +
call sub_102BB1F  +
mov eax [ebp+ppv] +
test eax eax +
jz loc_102C8DA  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov eax esi +
jmp loc_102C8E3  +
mov eax 80004003h +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 2Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 61Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push 0  +
push 17h  +
lea eax [ebp+pszPath] +
push eax  +
push 0  +
call ds:SHGetSpecialFolderPathW  +
test eax eax +
jz loc_102CA02  +
push esi  +
push edi  +
lea eax [ebp+pszPath] +
push eax  +
mov edi 104h +
push edi  +
lea eax [ebp+pMore] +
push eax  +
call sub_1027E68  +
mov esi ds:PathRemoveFileSpecW +
lea eax [ebp+pszPath] +
push eax  +
call esi  +
lea eax [ebp+pszPath] +
push eax  +
call esi  +
lea eax [ebp+pszPath] +
push eax  +
call ds:lstrlenW  +
lea eax [ebp+eax*2+pMore] +
push eax  +
push edi  +
lea eax [ebp+var_61C] +
push eax  +
call sub_1027E68  +
push edi  +
lea eax [ebp+pMore] +
push eax  +
push 0A6h  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_102CA00  +
lea eax [ebp+pszPath] +
push eax  +
call esi  +
mov edi ds:PathAppendW +
lea eax [ebp+pMore] +
push eax  +
lea eax [ebp+pszPath] +
push eax  +
call edi  +
lea eax [ebp+pszPath] +
push eax  +
call ds:PathIsDirectoryW  +
test eax eax +
jnz loc_102C9E2  +
lea eax [ebp+pszPath] +
push eax  +
call esi  +
push offset pMore  +
lea eax [ebp+pszPath] +
push eax  +
call edi  +
lea eax [ebp+var_61C] +
push eax  +
lea eax [ebp+pszPath] +
push eax  +
call edi  +
push 0  +
lea eax [ebp+pszPath] +
push eax  +
call sub_102BC9B  +
pop edi  +
pop esi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 0AC8h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push edi  +
xor edi edi +
mov [ebp+var_AC4] edi +
mov [ebp+var_AB0] edi +
mov [ebp+var_AB8] edi +
call sub_103133C  +
test eax eax +
jz loc_102CA51  +
mov [ebp+var_AC8] edi +
cmp [ebp+arg_0] edi +
jz loc_102CA5B  +
mov [ebp+var_AC8] 1 +
mov [ebp+var_AA8] edi +
call sub_102EB23  +
cmp eax 6 +
jnz loc_102CA7E  +
call sub_102D126  +
test eax eax +
jz loc_102CA7E  +
mov [ebp+var_AB8] 1 +
push edi  +
push edi  +
push edi  +
push 6  +
call sub_102FFFB  +
test eax eax +
jz loc_102CA99  +
call sub_103BAF0  +
test eax eax +
jnz loc_102CF98  +
push esi  +
push edi  +
call ds:CoInitialize  +
push offset aProgramfiles_0  +
mov esi 208h +
push esi  +
lea eax [ebp+var_28C] +
push eax  +
call sub_1027EA2  +
test eax eax +
jl loc_102CF91  +
push offset aProgramfiles_3  +
push esi  +
lea eax [ebp+var_AA4] +
push eax  +
call sub_1027EA2  +
test eax eax +
jl loc_102CF91  +
push 9Bh  +
push offset a@SystemrootSys  +
lea eax [ebp+var_89C] +
push 200h  +
push eax  +
call sub_1027F9F  +
add esp 10h +
test eax eax +
jl loc_102CF91  +
push offset aPrefetch1_0  +
push 80h  +
lea eax [ebp+var_84] +
push eax  +
call sub_1027EA2  +
test eax eax +
jl loc_102CF91  +
push ebx  +
push esi  +
call ??_U@YAPAXI@Z  +
mov ebx eax +
pop ecx  +
mov [ebp+var_AC0] ebx +
cmp ebx edi +
jz loc_102CB56  +
lea eax [ebp+var_AA8] +
push eax  +
push ebx  +
mov [ebp+var_AA8] esi +
call sub_102D396  +
test eax eax +
jnz loc_102CB56  +
push ebx  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [ebp+var_AC0] edi +
cmp [ebp+var_AB8] edi +
jnz loc_102CBD7  +
push esi  +
call ??_U@YAPAXI@Z  +
mov ebx eax +
pop ecx  +
mov [ebp+var_AC4] ebx +
cmp ebx edi +
jz loc_102CB96  +
lea eax [ebp+var_AA8] +
push eax  +
push ebx  +
push edi  +
mov [ebp+var_AA8] esi +
call sub_102D2AB  +
test eax eax +
jnz loc_102CB96  +
push ebx  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [ebp+var_AC4] edi +
push esi  +
call ??_U@YAPAXI@Z  +
pop ecx  +
mov [ebp+var_AB0] eax +
cmp eax edi +
jz loc_102CBD7  +
lea eax [ebp+var_AA8] +
push eax  +
push [ebp+var_AB0]  +
mov [ebp+var_AA8] esi +
push 1  +
call sub_102D2AB  +
test eax eax +
jnz loc_102CBD7  +
push [ebp+var_AB0]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [ebp+var_AB0] edi +
push esi  +
call ??_U@YAPAXI@Z  +
pop ecx  +
mov [ebp+dwItem1] eax +
mov ebx 104h +
cmp eax edi +
jz loc_102CC26  +
lea ecx [ebp+var_AA8] +
push ecx  +
push eax  +
push edi  +
mov [ebp+var_AA8] ebx +
call sub_102D6EF  +
test eax eax +
jz loc_102CC14  +
push [ebp+dwItem1]  +
call sub_102FE6A  +
test eax eax +
jnz loc_102CC26  +
push [ebp+dwItem1]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [ebp+dwItem1] edi +
push esi  +
call ??_U@YAPAXI@Z  +
pop ecx  +
mov [ebp+var_ABC] eax +
cmp eax edi +
jz loc_102CC71  +
lea ecx [ebp+var_AA8] +
push ecx  +
push eax  +
push 1  +
mov [ebp+var_AA8] ebx +
call sub_102D6EF  +
test eax eax +
jz loc_102CC5F  +
push [ebp+var_ABC]  +
call sub_102FE6A  +
test eax eax +
jnz loc_102CC71  +
push [ebp+var_ABC]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [ebp+var_ABC] edi +
push esi  +
call ??_U@YAPAXI@Z  +
pop ecx  +
mov [ebp+lpPathName] eax +
cmp eax edi +
jz loc_102CCBB  +
push edi  +
lea ecx [ebp+var_AA8] +
push ecx  +
push eax  +
mov [ebp+var_AA8] ebx +
call sub_102D913  +
test eax eax +
jz loc_102CCA9  +
push [ebp+lpPathName]  +
call sub_102FE6A  +
test eax eax +
jnz loc_102CCBB  +
push [ebp+lpPathName]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [ebp+lpPathName] edi +
push edi  +
push [ebp+lpPathName]  +
call sub_102BC9B  +
cmp [ebp+var_AB8] edi +
jnz loc_102CCEF  +
push edi  +
push [ebp+var_AC4]  +
call sub_102BC9B  +
cmp [ebp+var_AC8] edi +
jnz loc_102CCEF  +
push edi  +
push [ebp+var_AB0]  +
call sub_102BC9B  +
push edi  +
push [ebp+var_ABC]  +
call sub_102BC9B  +
call sub_102C2A7  +
cmp [ebp+var_ABC] edi +
jz loc_102CD14  +
push [ebp+var_ABC]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
cmp [ebp+var_AC4] edi +
jz loc_102CD28  +
push [ebp+var_AC4]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
cmp [ebp+var_AB8] edi +
jnz loc_102CD3B  +
push [ebp+var_AB0]  +
call sub_102E61A  +
push [ebp+lpPathName]  +
call sub_102E61A  +
push [ebp+dwItem1]  +
call sub_102E61A  +
cmp [ebp+var_AB8] edi +
jnz loc_102CD65  +
cmp [ebp+var_AC8] edi +
jz loc_102CF34  +
push offset aSystemrootSy_0  +
push esi  +
lea eax [ebp+var_69C] +
push eax  +
call sub_1027EA2  +
lea eax [ebp+var_28C] +
push eax  +
call sub_102C53C  +
push offset aWindowsMediaPl  +
push esi  +
lea eax [ebp+var_494] +
push eax  +
call sub_1027EA2  +
mov esi ds:SHChangeNotify +
mov ebx 1000h +
cmp [ebp+dwItem1] edi +
jz loc_102CE2E  +
push edi  +
push offset aDesktopshortcu  +
call sub_102F07A  +
test eax eax +
jz loc_102CE12  +
call sub_102C8F9  +
lea eax [ebp+var_AA4] +
push eax  +
push 4  +
push edi  +
push edi  +
lea eax [ebp+var_28C] +
push eax  +
lea eax [ebp+var_84] +
push eax  +
lea eax [ebp+var_89C] +
push eax  +
lea eax [ebp+var_69C] +
push eax  +
lea eax [ebp+var_494] +
push eax  +
push [ebp+dwItem1]  +
lea eax [ebp+var_28C] +
push eax  +
call sub_102C64B  +
test eax eax +
jl loc_102CE2E  +
push edi  +
push [ebp+dwItem1]  +
push 5  +
push ebx  +
call esi  +
jmp loc_102CE2E  +
push 1  +
push offset aDesktopshortcu  +
call sub_102F07A  +
test eax eax +
jnz loc_102CE2E  +
push edi  +
push [ebp+dwItem1]  +
call sub_102BC9B  +
cmp [ebp+var_AC0] edi +
jz loc_102CE51  +
push edi  +
push offset aQuicklaunchsho  +
call sub_102F07A  +
test eax eax +
jnz loc_102CE51  +
push edi  +
push [ebp+var_AC0]  +
call sub_102BC9B  +
cmp [ebp+var_AB0] edi +
jz loc_102CF34  +
push 1  +
push offset aCommonfavorite  +
call sub_102F07A  +
test eax eax +
jz loc_102CEDB  +
cmp [ebp+var_AB8] edi +
jnz loc_102CF34  +
lea eax [ebp+var_AA4] +
push eax  +
push 4  +
push edi  +
push edi  +
lea eax [ebp+var_28C] +
push eax  +
lea eax [ebp+var_84] +
push eax  +
lea eax [ebp+var_89C] +
push eax  +
lea eax [ebp+var_69C] +
push eax  +
lea eax [ebp+var_494] +
push eax  +
push [ebp+var_AB0]  +
lea eax [ebp+var_28C] +
push eax  +
call sub_102C64B  +
cmp eax edi +
jl loc_102CEC9  +
push edi  +
push [ebp+var_AB0]  +
push 5  +
push ebx  +
jmp loc_102CF32  +
push eax  +
push offset aErrorCreateCom  +
push 2  +
call sub_1039F55  +
add esp 0Ch +
jmp loc_102CF34  +
cmp [ebp+lpPathName] edi +
jz loc_102CF34  +
lea eax [ebp+var_AA4] +
push eax  +
push 4  +
push edi  +
push edi  +
lea eax [ebp+var_28C] +
push eax  +
lea eax [ebp+var_84] +
push eax  +
lea eax [ebp+var_89C] +
push eax  +
lea eax [ebp+var_69C] +
push eax  +
lea eax [ebp+var_494] +
push eax  +
push [ebp+lpPathName]  +
lea eax [ebp+var_28C] +
push eax  +
call sub_102C64B  +
test eax eax +
jl loc_102CF34  +
push edi  +
push [ebp+lpPathName]  +
push 5  +
push 10h  +
call esi  +
pop ebx  +
cmp [ebp+dwItem1] edi +
jz loc_102CF49  +
push [ebp+dwItem1]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
cmp [ebp+lpPathName] edi +
jz loc_102CF69  +
push [ebp+lpPathName]  +
call ds:RemoveDirectoryW  +
push [ebp+lpPathName]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
cmp [ebp+var_AC0] edi +
jz loc_102CF7D  +
push [ebp+var_AC0]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
cmp [ebp+var_AB0] edi +
jz loc_102CF91  +
push [ebp+var_AB0]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
call ds:CoUninitialize  +
pop esi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 210h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
push edi  +
xor ebx ebx +
push ebx  +
mov [ebp+var_210] ebx +
call ds:CoInitialize  +
call sub_102C3DC  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
mov esi 208h +
push ebx  +
mov [ebp+var_210] esi +
call sub_102D6EF  +
xor edi edi +
inc edi  +
test eax eax +
jz loc_102D00B  +
push edi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102BC9B  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
push edi  +
mov [ebp+var_210] esi +
call sub_102D6EF  +
test eax eax +
jz loc_102D036  +
push ebx  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102BC9B  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
push ebx  +
mov [ebp+var_210] esi +
call sub_102D2AB  +
test eax eax +
jz loc_102D061  +
push edi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102BC9B  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
push edi  +
mov [ebp+var_210] esi +
call sub_102D2AB  +
test eax eax +
jz loc_102D08C  +
push edi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102BC9B  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
mov [ebp+var_210] esi +
call sub_102D396  +
test eax eax +
jz loc_102D0B6  +
push edi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102BC9B  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
push ebx  +
mov [ebp+var_210] esi +
call sub_102DB78  +
test eax eax +
jz loc_102D0E1  +
push edi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102BC9B  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_20C] +
push eax  +
push edi  +
mov [ebp+var_210] esi +
call sub_102DB78  +
test eax eax +
jz loc_102D10C  +
push edi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102BC9B  +
call ds:CoUninitialize  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 210h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
xor esi esi +
push esi  +
push esi  +
push esi  +
push 4  +
mov [ebp+hKey] esi +
call sub_102FFFB  +
test eax eax +
jz loc_102D1E3  +
push edi  +
lea eax [ebp+hKey] +
push eax  +
xor edi edi +
inc edi  +
push edi  +
push esi  +
push offset aSystemCurren_0  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102D1E0  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aProducttype  +
push [ebp+hKey]  +
mov [ebp+cbData] 200h +
mov [ebp+Type] edi +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102D1D4  +
cmp [ebp+Type] edi +
jnz loc_102D1D4  +
lea eax [ebp+Data] +
push offset aWinnt  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102D1D4  +
mov esi edi +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov eax esi +
pop edi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 20Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
mov esi [ebp+arg_0] +
push edi  +
xor eax eax +
lea ecx [ebp+var_20C] +
push ecx  +
push eax  +
push eax  +
push 2Ah  +
push eax  +
xor edi edi +
call ds:SHGetFolderPathW  +
test eax eax +
jl loc_102D24B  +
push offset aWindowsMediaPl  +
lea eax [ebp+var_20C] +
push eax  +
push offset aSS  +
push [ebp+arg_4]  +
push esi  +
call sub_1027F64  +
add esp 14h +
test eax eax +
jl loc_102D24B  +
inc edi  +
mov ecx [ebp+var_4] +
mov eax edi +
pop edi  +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push edi  +
mov edi [ebp+arg_0] +
test edi edi +
jz loc_102D2A1  +
cmp [ebp+arg_4] 0 +
jz loc_102D2A1  +
cmp [ebp+arg_8] 0 +
jz loc_102D2A1  +
push esi  +
push [ebp+arg_4]  +
mov esi [ebp+arg_C] +
lea eax [esi-1] +
push eax  +
push edi  +
call sub_1027E68  +
test eax eax +
jl loc_102D2A0  +
push edi  +
call sub_102E61A  +
push [ebp+arg_8]  +
push esi  +
push edi  +
call sub_1027EDD  +
pop esi  +
pop edi  +
pop ebp  +
retn 10h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 214h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push edi  +
mov edi [ebp+arg_4] +
test edi edi +
jnz loc_102D2CF  +
xor eax eax +
jmp loc_102D382  +
push esi  +
lea eax [ebp+ppMalloc] +
push eax  +
call ds:SHGetMalloc  +
mov esi eax +
test esi esi +
jl loc_102D37A  +
lea eax [ebp+pidl] +
push eax  +
mov eax [ebp+arg_0] +
neg eax  +
sbb eax eax +
and eax 15h +
inc eax  +
inc eax  +
push eax  +
push 0  +
call ds:SHGetSpecialFolderLocation  +
mov esi eax +
test esi esi +
jl loc_102D34D  +
lea eax [ebp+pszPath] +
push eax  +
push [ebp+pidl]  +
call ds:SHGetPathFromIDListW  +
test eax eax +
jz loc_102D336  +
lea eax [ebp+pszPath] +
push eax  +
mov eax [ebp+arg_8] +
push dword ptr [eax]  +
push edi  +
call sub_1027EA2  +
mov esi eax +
jmp loc_102D33B  +
mov esi 80004005h +
mov eax [ebp+ppMalloc] +
push [ebp+pidl]  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+14h]  +
mov eax [ebp+ppMalloc] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
test esi esi +
jl loc_102D37A  +
mov eax edi +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_102D362  +
sub eax edx +
sar eax 1 +
cmp eax 8 +
jnb loc_102D37A  +
mov esi 80004005h +
xor eax eax +
test esi esi +
setnl al  +
pop esi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 21Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
mov ebx [ebp+arg_0] +
xor edx edx +
xor ecx ecx +
inc ecx  +
push esi  +
mov esi [ebp+arg_4] +
mov [ebp+hKey] edx +
mov [ebp+var_210] edx +
mov [ebp+Type] ecx +
cmp ebx edx +
jnz loc_102D3D5  +
xor eax eax +
jmp loc_102D6DA  +
mov eax [esi] +
push edi  +
mov edi ds:RegQueryValueExW +
mov [ebp+cbData] eax +
cmp eax 208h +
jb loc_102D63B  +
lea eax [ebp+hKey] +
push eax  +
push ecx  +
push edx  +
push offset aSoftwareMic_48  +
push 80000001h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102D559  +
mov eax [esi] +
mov [ebp+cbData] eax +
lea eax [ebp+cbData] +
push eax  +
push ebx  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aQuickLaunch  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jnz loc_102D499  +
cmp [ebp+Type] 1 +
jnz loc_102D44D  +
push ebx  +
call sub_102FE6A  +
test eax eax +
jnz loc_102D48A  +
cmp [ebp+Type] 2 +
jnz loc_102D499  +
push 104h  +
lea eax [ebp+Dst] +
push eax  +
push ebx  +
call ds:ExpandEnvironmentStringsW  +
test eax eax +
jz loc_102D499  +
lea eax [ebp+Dst] +
push eax  +
push dword ptr [esi]  +
push ebx  +
call sub_1027EA2  +
test eax eax +
jl loc_102D499  +
push ebx  +
call sub_102FE6A  +
test eax eax +
jz loc_102D499  +
mov [ebp+var_210] 1 +
jmp loc_102D540  +
mov eax [esi] +
mov [ebp+cbData] eax +
lea eax [ebp+cbData] +
push eax  +
push ebx  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aAppdata  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jnz loc_102D540  +
cmp [ebp+Type] 1 +
jnz loc_102D4D6  +
push ebx  +
call sub_102FE6A  +
test eax eax +
jnz loc_102D513  +
cmp [ebp+Type] 2 +
jnz loc_102D540  +
push 104h  +
lea eax [ebp+Dst] +
push eax  +
push ebx  +
call ds:ExpandEnvironmentStringsW  +
test eax eax +
jz loc_102D540  +
lea eax [ebp+Dst] +
push eax  +
push dword ptr [esi]  +
push ebx  +
call sub_1027EA2  +
test eax eax +
jl loc_102D540  +
push ebx  +
call sub_102FE6A  +
test eax eax +
jz loc_102D540  +
push ebx  +
mov [ebp+var_210] 1 +
call sub_102E61A  +
push offset aMicrosoftInter  +
push dword ptr [esi]  +
push ebx  +
call sub_1027F1E  +
push ebx  +
call sub_102FE6A  +
test eax eax +
jnz loc_102D540  +
and [ebp+var_210] eax +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp [ebp+var_210] 0 +
jnz loc_102D6CB  +
lea eax [ebp+hKey] +
push eax  +
push 1  +
push 0  +
push offset aSoftwareMic_49  +
push 80000001h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102D63B  +
mov eax [esi] +
mov [ebp+cbData] eax +
lea eax [ebp+cbData] +
push eax  +
push ebx  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aQuickLaunch  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jnz loc_102D5C5  +
cmp [ebp+Type] 1 +
jnz loc_102D5C5  +
push ebx  +
call sub_102FE6A  +
test eax eax +
jz loc_102D5C5  +
mov [ebp+var_210] 1 +
jmp loc_102D622  +
mov eax [esi] +
mov [ebp+cbData] eax +
lea eax [ebp+cbData] +
push eax  +
push ebx  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aAppdata  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jnz loc_102D61B  +
inc eax  +
cmp [ebp+Type] eax +
jnz loc_102D61B  +
push ebx  +
mov [ebp+var_210] eax +
call sub_102E61A  +
push offset aMicrosoftInter  +
push dword ptr [esi]  +
push ebx  +
call sub_1027F1E  +
push ebx  +
call sub_102FE6A  +
test eax eax +
jnz loc_102D622  +
and [ebp+var_210] 0 +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp [ebp+var_210] 0 +
jnz loc_102D6CB  +
lea eax [ebp+hKey] +
push eax  +
push 1  +
push 0  +
push offset aSoftwareMicr_7  +
push 80000001h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102D6CB  +
push 96h  +
lea eax [ebp+ValueName] +
push eax  +
push 9Dh  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_102D6BF  +
mov eax [esi] +
mov [ebp+cbData] eax +
lea eax [ebp+cbData] +
push eax  +
push ebx  +
lea eax [ebp+Type] +
push eax  +
push 0  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jnz loc_102D6B8  +
inc eax  +
cmp [ebp+Type] eax +
jnz loc_102D6B8  +
mov [ebp+var_210] eax +
jmp loc_102D6BF  +
and [ebp+var_210] 0 +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov eax [ebp+cbData] +
mov [esi] eax +
mov eax [ebp+var_210] +
pop edi  +
mov ecx [ebp+var_4] +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 214h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push edi  +
mov edi [ebp+arg_4] +
test edi edi +
jnz loc_102D713  +
xor eax eax +
jmp loc_102D79F  +
push esi  +
lea eax [ebp+ppMalloc] +
push eax  +
call ds:SHGetMalloc  +
mov esi eax +
test esi esi +
jl loc_102D797  +
lea eax [ebp+pidl] +
push eax  +
mov eax [ebp+arg_0] +
neg eax  +
sbb eax eax +
and eax 19h +
push eax  +
push 0  +
call ds:SHGetSpecialFolderLocation  +
mov esi eax +
test esi esi +
jl loc_102D78B  +
lea eax [ebp+pszPath] +
push eax  +
push [ebp+pidl]  +
call ds:SHGetPathFromIDListW  +
test eax eax +
jz loc_102D774  +
lea eax [ebp+pszPath] +
push eax  +
mov eax [ebp+arg_8] +
push dword ptr [eax]  +
push edi  +
call sub_1027EA2  +
mov esi eax +
jmp loc_102D779  +
mov esi 80004005h +
mov eax [ebp+ppMalloc] +
push [ebp+pidl]  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+14h]  +
mov eax [ebp+ppMalloc] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
xor eax eax +
test esi esi +
setnl al  +
pop esi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 348h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
mov esi [ebp+arg_0] +
push edi  +
xor edi edi +
mov [ebp+var_348] esi +
mov [ebp+hKey] edi +
cmp esi edi +
jz loc_102D8FB  +
push [ebp+arg_4]  +
push esi  +
push [ebp+arg_8]  +
call sub_102D2AB  +
test eax eax +
jz loc_102D8FB  +
xor ebx ebx +
inc ebx  +
cmp [ebp+arg_8] edi +
jz loc_102D81F  +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
push 15h  +
push hInstance  +
call ds:LoadStringW  +
jmp loc_102D8DF  +
lea eax [ebp+hKey] +
push eax  +
push ebx  +
push edi  +
push offset aSoftwareMicr_7  +
push 80000001h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102D8FB  +
mov edi ds:LoadStringW +
push 96h  +
lea eax [ebp+ValueName] +
push eax  +
push 23h  +
push hInstance  +
mov [ebp+cbData] 208h +
xor esi esi +
mov [ebp+Type] ebx +
call edi  +
test eax eax +
jz loc_102D8C9  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+hKey]  +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102D8AB  +
cmp [ebp+Type] ebx +
jnz loc_102D8AB  +
mov esi ebx +
jmp loc_102D8C9  +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
push 15h  +
push hInstance  +
call edi  +
mov esi eax +
neg esi  +
sbb esi esi +
neg esi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
test esi esi +
jz loc_102D8FB  +
mov esi [ebp+var_348] +
push esi  +
call sub_102E61A  +
lea eax [ebp+Buffer] +
push eax  +
mov eax [ebp+arg_4] +
push dword ptr [eax]  +
push esi  +
call sub_1027F1E  +
mov eax ebx +
jmp loc_102D8FD  +
xor eax eax +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 54Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
and [ebp+hKey] 0 +
push ebx  +
push esi  +
push edi  +
mov edi [ebp+arg_0] +
test edi edi +
jz loc_102DB60  +
push [ebp+arg_4]  +
push edi  +
push [ebp+arg_8]  +
call sub_102D2AB  +
test eax eax +
jz loc_102DB60  +
lea eax [ebp+hKey] +
push eax  +
push 1  +
push 0  +
push offset aSoftwareMicr_7  +
push 80000001h  +
call ds:RegOpenKeyExW  +
mov ebx ds:LoadStringW +
mov esi 104h +
test eax eax +
jnz loc_102DA64  +
push 96h  +
lea eax [ebp+ValueName] +
push eax  +
push 24h  +
push hInstance  +
mov [ebp+cbData] 208h +
mov [ebp+Type] 1 +
call ebx  +
test eax eax +
jz loc_102DA58  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+hKey]  +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102DA58  +
cmp [ebp+Type] 1 +
jnz loc_102DA58  +
push edi  +
push esi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_102DA58  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102E61A  +
lea eax [ebp+Buffer] +
push eax  +
push esi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102DA58  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102FE6A  +
test eax eax +
jz loc_102DA58  +
lea eax [ebp+var_20C] +
push eax  +
mov eax [ebp+arg_4] +
push dword ptr [eax]  +
push edi  +
call sub_1027EA2  +
test eax eax +
jl loc_102DA58  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
xor eax eax +
inc eax  +
jmp loc_102DB62  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push [ebp+arg_4]  +
push edi  +
push [ebp+arg_8]  +
call sub_102D2AB  +
test eax eax +
jz loc_102DAEA  +
push esi  +
lea eax [ebp+Buffer] +
push eax  +
push 21h  +
push hInstance  +
call ebx  +
test eax eax +
jz loc_102DAEA  +
push edi  +
push esi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_102DAEA  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102E61A  +
lea eax [ebp+Buffer] +
push eax  +
push esi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102DAEA  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102FE6A  +
test eax eax +
jz loc_102DAEA  +
lea eax [ebp+var_20C] +
push eax  +
mov eax [ebp+arg_4] +
push dword ptr [eax]  +
push edi  +
call sub_1027EA2  +
test eax eax +
jge loc_102DA50  +
push [ebp+arg_4]  +
push edi  +
push [ebp+arg_8]  +
call sub_102D2AB  +
test eax eax +
jz loc_102DB60  +
push esi  +
lea eax [ebp+Buffer] +
push eax  +
push 25h  +
push hInstance  +
call ebx  +
test eax eax +
jz loc_102DB60  +
push edi  +
push esi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_102DB60  +
lea eax [ebp+var_20C] +
push eax  +
call sub_102E61A  +
lea eax [ebp+Buffer] +
push eax  +
push esi  +
lea eax [ebp+var_20C] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_102DB60  +
lea eax [ebp+var_20C] +
push eax  +
mov eax [ebp+arg_4] +
push dword ptr [eax]  +
push edi  +
call sub_1027EA2  +
test eax eax +
jge loc_102DA50  +
xor eax eax +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 214h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push edi  +
mov edi [ebp+arg_4] +
test edi edi +
jnz loc_102DB9C  +
xor eax eax +
jmp loc_102DC50  +
push esi  +
lea eax [ebp+ppMalloc] +
push eax  +
call ds:SHGetMalloc  +
mov esi eax +
test esi esi +
jl loc_102DC48  +
lea eax [ebp+pidl] +
push eax  +
mov eax [ebp+arg_0] +
neg eax  +
sbb eax eax +
and eax 19h +
add eax 6 +
push eax  +
push 0  +
call ds:SHGetSpecialFolderLocation  +
mov esi eax +
test esi esi +
jl loc_102DC1B  +
lea eax [ebp+pszPath] +
push eax  +
push [ebp+pidl]  +
call ds:SHGetPathFromIDListW  +
test eax eax +
jz loc_102DC04  +
lea eax [ebp+pszPath] +
push eax  +
mov eax [ebp+arg_8] +
push dword ptr [eax]  +
push edi  +
call sub_1027EA2  +
mov esi eax +
jmp loc_102DC09  +
mov esi 80004005h +
mov eax [ebp+ppMalloc] +
push [ebp+pidl]  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+14h]  +
mov eax [ebp+ppMalloc] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
test esi esi +
jl loc_102DC48  +
mov eax edi +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_102DC30  +
sub eax edx +
sar eax 1 +
cmp eax 8 +
jnb loc_102DC48  +
mov esi 80004005h +
xor eax eax +
test esi esi +
setnl al  +
pop esi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
mov esi [ebp+arg_0] +
xor eax eax +
jmp loc_102DC80  +
test eax eax +
jnz loc_102DC85  +
mov ecx [esi] +
test ecx ecx +
jz loc_102DC7D  +
call ecx  +
add esi 4 +
cmp esi [ebp+arg_4] +
jb loc_102DC71  +
pop esi  +
pop ebp  +
retn   +
***
mov eax dword_1040E8C +
push offset dword_1040E7C  +
push dword_1040E88  +
mov dword_1040E7C eax +
push offset unk_1040E6C  +
push offset unk_1040E70  +
push offset unk_1040E68  +
call ds:__getmainargs  +
add esp 14h +
mov dword_1040E78 eax +
retn   +
***
call __SEH_prolog4  +
xor ebx ebx +
mov [ebp+var_1C] ebx +
mov [ebp+ms_exc.disabled] ebx +
lea eax [ebp+StartupInfo] +
push eax  +
call ds:GetStartupInfoA  +
mov [ebp+ms_exc.disabled] 0FFFFFFFEh +
mov [ebp+ms_exc.disabled] 1 +
mov eax large fs:18h +
mov esi [eax+4] +
mov edi offset Destination +
push 0  +
push esi  +
push edi  +
call ds:InterlockedCompareExchange  +
test eax eax +
jz loc_102DD25  +
cmp eax esi +
jnz loc_102DD18  +
xor esi esi +
inc esi  +
mov ebx esi +
jmp loc_102DD28  +
push 3E8h  +
call ds:Sleep  +
jmp loc_102DCFF  +
xor esi esi +
inc esi  +
mov eax dword_1041754 +
cmp eax esi +
jnz loc_102DD3B  +
push 1Fh  +
call _amsg_exit  +
pop ecx  +
jmp loc_102DD6A  +
mov eax dword_1041754 +
test eax eax +
jnz loc_102DD64  +
mov dword_1041754 esi +
push offset dword_1001338  +
push offset dword_100132C  +
call sub_102DC64  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102DD6A  +
jmp loc_102DE92  +
mov dword_1040E84 esi +
mov eax dword_1041754 +
cmp eax esi +
jnz loc_102DD8E  +
push offset dword_1001328  +
push offset dword_10012D0  +
call _initterm  +
pop ecx  +
pop ecx  +
mov dword_1041754 2 +
test ebx ebx +
jnz loc_102DD9A  +
push ebx  +
push edi  +
call ds:InterlockedExchange  +
cmp dword_104175C 0 +
jz loc_102DDBE  +
push offset dword_104175C  +
call sub_102E0E9  +
pop ecx  +
test eax eax +
jz loc_102DDBE  +
push 0  +
push 2  +
push 0  +
call dword_104175C  +
mov eax ds:_acmdln +
mov esi [eax] +
mov [ebp+var_20] esi +
mov al [esi] +
cmp al 20h +
ja $LN61  +
test al al +
jz loc_102DDD8  +
cmp [ebp+var_1C] 0 +
jnz $LN61  +
mov al [esi] +
test al al +
jz loc_102DDE8  +
cmp al 20h +
ja loc_102DDE8  +
inc esi  +
mov [ebp+var_20] esi +
jmp loc_102DDD8  +
test byte ptr [ebp+StartupInfo.dwFlags] 1 +
jz loc_102DDF4  +
movzx eax [ebp+StartupInfo.wShowWindow] +
jmp loc_102DDF7  +
push 0Ah  +
pop eax  +
push eax  +
push esi  +
push 0  +
push 1000000h  +
call _WinMain@16  +
mov dword_1040E80 eax +
cmp dword_1040E74 0 +
jnz $LN62  +
push eax  +
call ds:exit  +
cmp al 22h +
jnz loc_102DE29  +
xor ecx ecx +
cmp [ebp+var_1C] ecx +
setz cl  +
mov [ebp+var_1C] ecx +
movzx eax al +
push eax  +
call ds:_ismbblead  +
pop ecx  +
test eax eax +
jz loc_102DE3C  +
inc esi  +
mov [ebp+var_20] esi +
inc esi  +
jmp loc_102DDC5  +
mov eax [ebp-14h] +
mov ecx [eax] +
mov ecx [ecx] +
mov [ebp-24h] ecx +
push eax  +
push ecx  +
call _XcptFilter  +
pop ecx  +
pop ecx  +
retn   +
mov esp [ebp-18h] +
mov eax [ebp-24h] +
mov dword_1040E80 eax +
cmp dword_1040E74 0 +
jnz $LN62  +
push eax  +
call ds:_exit  +
cmp dword_1040E84 0 +
jnz loc_102DE7D  +
call ds:_cexit  +
mov [ebp+ms_exc.disabled] 0FFFFFFFEh +
mov eax dword_1040E80 +
jmp loc_102DE9E  +
xor eax eax +
inc eax  +
retn   +
mov esp [ebp-18h] +
mov [ebp+ms_exc.disabled] 0FFFFFFFEh +
mov eax 0FFh +
call __SEH_epilog4  +
retn   +
***
mov eax 5A4Dh +
cmp ds:1000000h ax +
jz loc_102DEBB  +
xor eax eax +
jmp loc_102DF08  +
mov eax ds:100003Ch +
lea eax [eax+1000000h] +
cmp dword ptr [eax] 4550h +
jnz loc_102DEB7  +
movzx ecx word ptr [eax+18h] +
cmp ecx 10Bh +
jz loc_102DEF5  +
cmp ecx 20Bh +
jnz loc_102DEB7  +
cmp dword ptr [eax+84h] 0Eh +
jbe loc_102DEB7  +
xor ecx ecx +
cmp [eax+0F8h] ecx +
jmp loc_102DF03  +
cmp dword ptr [eax+74h] 0Eh +
jbe loc_102DEB7  +
xor ecx ecx +
cmp [eax+0E8h] ecx +
setnz cl  +
mov eax ecx +
push 2  +
mov dword_1040E74 eax +
call sub_102E328  +
push eax  +
call ds:__set_app_type  +
or dword_104174C 0FFFFFFFFh +
or dword_1041750 0FFFFFFFFh +
pop ecx  +
pop ecx  +
call ds:__p__fmode  +
mov ecx dword_1040E94 +
mov [eax] ecx +
call ds:__p__commode  +
mov ecx dword_1040E90 +
mov [eax] ecx +
call sub_102E214  +
cmp dword_103F068 0 +
jnz loc_102DF61  +
push offset sub_102E214  +
call ds:__setusermatherr  +
pop ecx  +
call sub_102E1FC  +
xor eax eax +
retn   +
***
call sub_102E367  +
jmp ___tmainCRTStartup  +
***
cmp ecx dword_103F058 +
jnz loc_102DF88  +
retn 0  +
jmp loc_102E3FD  +
***
sub ecx eax +
sbb eax eax +
not eax  +
and ecx eax +
mov eax esp +
and eax 0FFFFF000h +
cmp ecx eax +
jb cs20  +
mov eax ecx +
pop ecx  +
xchg eax esp +
mov eax [eax] +
mov [esp+0] eax +
retn   +
sub eax 1000h +
test [eax] eax +
jmp cs10  +
***
push ebp  +
mov ebp esp +
mov eax [ebp+8] +
mov eax [eax] +
cmp dword ptr [eax] 0E06D7363h +
jnz loc_102E030  +
cmp dword ptr [eax+10h] 3 +
jnz loc_102E030  +
mov eax [eax+14h] +
cmp eax 19930520h +
jz loc_102E02A  +
cmp eax 19930521h +
jz loc_102E02A  +
cmp eax 19930522h +
jz loc_102E02A  +
cmp eax 1994000h +
jnz loc_102E030  +
call ds:?terminate@@YAXXZ  +
xor eax eax +
pop ebp  +
retn 4  +
***
push (offset dword_102DFF0+3)  +
call ds:SetUnhandledExceptionFilter  +
xor eax eax +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov ecx [ebp+arg_0] +
mov eax 5A4Dh +
cmp [ecx] ax +
jz loc_102E076  +
xor eax eax +
pop ebp  +
retn   +
mov eax [ecx+3Ch] +
add eax ecx +
cmp dword ptr [eax] 4550h +
jnz loc_102E072  +
xor edx edx +
mov ecx 10Bh +
cmp [eax+18h] cx +
setz dl  +
mov eax edx +
pop ebp  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov eax [ebp+arg_0] +
mov ecx [eax+3Ch] +
add ecx eax +
movzx eax word ptr [ecx+14h] +
push ebx  +
push esi  +
movzx esi word ptr [ecx+6] +
xor edx edx +
push edi  +
lea eax [eax+ecx+18h] +
test esi esi +
jbe loc_102E0DD  +
mov edi [ebp+arg_4] +
mov ecx [eax+0Ch] +
cmp edi ecx +
jb loc_102E0D5  +
mov ebx [eax+8] +
add ebx ecx +
cmp edi ebx +
jb loc_102E0DF  +
inc edx  +
add eax 28h +
cmp edx esi +
jb loc_102E0C5  +
xor eax eax +
pop edi  +
pop esi  +
pop ebx  +
pop ebp  +
retn   +
***
call __SEH_prolog4  +
and [ebp+ms_exc.disabled] 0 +
mov esi 1000000h +
push esi  +
call sub_102E060  +
pop ecx  +
test eax eax +
jz loc_102E146  +
mov eax [ebp+arg_0] +
sub eax esi +
push eax  +
push esi  +
call sub_102E0A0  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102E146  +
mov eax [eax+24h] +
shr eax 1Fh +
not eax  +
and eax 1 +
mov [ebp+ms_exc.disabled] 0FFFFFFFEh +
jmp loc_102E14F  +
mov eax [ebp-14h] +
mov eax [eax] +
mov eax [eax] +
xor ecx ecx +
cmp eax 0C0000005h +
setz cl  +
mov eax ecx +
retn   +
mov esp [ebp-18h] +
mov [ebp+ms_exc.disabled] 0FFFFFFFEh +
xor eax eax +
call __SEH_epilog4  +
retn   +
***
mov eax [esp+8+arg_4] +
mov ecx [ebp-10h] +
mov large fs:0 ecx +
pop ecx  +
pop edi  +
pop edi  +
pop esi  +
pop ebx  +
mov esp ebp +
pop ebp  +
push ecx  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push dword ptr [ebp+14h]  +
push dword ptr [ebp+10h]  +
push dword ptr [ebp+0Ch]  +
push dword ptr [ebp+8]  +
push offset sub_102DF7D  +
push offset dword_103F058  +
call _except_handler4_common  +
add esp 18h +
pop ebp  +
retn   +
***
call ds:_controlfp  +
pop ecx  +
pop ecx  +
retn   +
***
retn   +
***
call __SEH_prolog4  +
pop ecx  +
retn   +
***
push ebp  +
mov ebp esp +
push dword ptr [ebp+8]  +
call sub_102E21C  +
neg eax  +
sbb eax eax +
neg eax  +
pop ecx  +
dec eax  +
pop ebp  +
retn   +
***
call __SEH_prolog4  +
xor eax eax +
mov ecx [ebp+arg_0] +
test ecx ecx +
jz loc_102E31B  +
cmp ecx 0FFFFFFFFh +
jz loc_102E31B  +
and [ebp+ms_exc.disabled] eax +
mov edx 5A4Dh +
cmp [ecx] dx +
jnz loc_102E314  +
mov edx [ecx+3Ch] +
test edx edx +
jl loc_102E314  +
cmp edx 10000000h +
jnb loc_102E314  +
lea eax [edx+ecx] +
mov [ebp+var_1C] eax +
cmp dword ptr [eax] 4550h +
jz loc_102E314  +
jmp loc_102E30F  +
xor eax eax +
inc eax  +
retn   +
mov esp [ebp-18h] +
xor eax eax +
mov [ebp+var_1C] eax +
mov [ebp+ms_exc.disabled] 0FFFFFFFEh +
call __SEH_epilog4  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push 0  +
call ds:GetModuleHandleA  +
test eax eax +
jz loc_102E35D  +
push eax  +
call sub_102E2C2  +
test eax eax +
jz loc_102E35D  +
movzx eax word ptr [eax+5Ch] +
cmp ax 2 +
jnz loc_102E352  +
push 2  +
pop eax  +
pop ebp  +
retn   +
cmp ax 3 +
jnz loc_102E35D  +
xor eax eax +
inc eax  +
pop ebp  +
retn   +
mov eax [ebp+arg_0] +
pop ebp  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 10h +
mov eax dword_103F058 +
and [ebp+SystemTimeAsFileTime.dwLowDateTime] 0 +
and [ebp+SystemTimeAsFileTime.dwHighDateTime] 0 +
push ebx  +
push edi  +
mov edi 0BB40E64Eh +
mov ebx 0FFFF0000h +
cmp eax edi +
jz loc_102E399  +
test eax ebx +
jz loc_102E399  +
not eax  +
mov dword_103F05C eax +
jmp loc_102E3F4  +
push esi  +
lea eax [ebp+SystemTimeAsFileTime] +
push eax  +
call ds:GetSystemTimeAsFileTime  +
mov esi [ebp+SystemTimeAsFileTime.dwHighDateTime] +
xor esi [ebp+SystemTimeAsFileTime.dwLowDateTime] +
call ds:GetCurrentProcessId  +
xor esi eax +
call ds:GetCurrentThreadId  +
xor esi eax +
call ds:GetTickCount  +
xor esi eax +
lea eax [ebp+PerformanceCount] +
push eax  +
call ds:QueryPerformanceCounter  +
mov eax dword ptr [ebp+PerformanceCount+4] +
xor eax dword ptr [ebp+PerformanceCount] +
xor esi eax +
cmp esi edi +
jz loc_102E3E0  +
test dword_103F058 ebx +
jnz loc_102E3E5  +
mov esi 0BB40E64Fh +
mov dword_103F058 esi +
not esi  +
mov dword_103F05C esi +
pop esi  +
pop edi  +
pop ebx  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 328h +
mov dword_1040F98 eax +
mov dword_1040F94 ecx +
mov dword_1040F90 edx +
mov dword_1040F8C ebx +
mov dword_1040F88 esi +
mov dword_1040F84 edi +
mov word_1040FB0 ss +
mov word_1040FA4 cs +
mov word_1040F80 ds +
mov word_1040F7C es +
mov word_1040F78 fs +
mov word_1040F74 gs +
pushf   +
pop dword_1040FA8  +
mov eax [ebp+0] +
mov dword_1040F9C eax +
mov eax [ebp+4] +
mov dword_1040FA0 eax +
lea eax [ebp+8] +
mov dword_1040FAC eax +
mov eax [ebp-320h] +
mov dword_1040EE8 10001h +
mov eax dword_1040FA0 +
mov dword_1040EA4 eax +
mov dword_1040E98 0C0000409h +
mov dword_1040E9C 1 +
mov eax dword_103F058 +
mov [ebp-328h] eax +
mov eax dword_103F05C +
mov [ebp-324h] eax +
push 0  +
call ds:SetUnhandledExceptionFilter  +
push offset ExceptionInfo  +
call ds:UnhandledExceptionFilter  +
push 0C0000409h  +
call ds:GetCurrentProcess  +
push eax  +
call ds:TerminateProcess  +
leave   +
retn   +
***
mov edi edi +
push esi  +
mov esi eax +
xor eax eax +
mov ecx edx +
test edx edx +
jz loc_102E52C  +
cmp [esi] al +
jz loc_102E528  +
inc esi  +
dec edx  +
jnz loc_102E520  +
test edx edx +
jnz loc_102E531  +
mov eax 80070057h +
pop esi  +
test edi edi +
jz locret_102E542  +
test eax eax +
jl loc_102E53F  +
sub ecx edx +
mov [edi] ecx +
retn   +
and dword ptr [edi] 0 +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ebx  +
push esi  +
push edi  +
mov ebx eax +
mov esi edx +
xor eax eax +
xor edi edi +
test esi esi +
jz loc_102E578  +
cmp [ebp+arg_4] eax +
jz loc_102E574  +
mov dl [ebx] +
test dl dl +
jz loc_102E574  +
mov [ecx] dl +
inc ecx  +
inc ebx  +
dec esi  +
dec [ebp+arg_4]  +
inc edi  +
test esi esi +
jnz loc_102E55C  +
test esi esi +
jnz loc_102E57F  +
dec ecx  +
dec edi  +
mov eax 8007007Ah +
mov byte ptr [ecx] 0 +
mov ecx [ebp+arg_0] +
test ecx ecx +
jz loc_102E58B  +
mov [ecx] edi +
pop edi  +
pop esi  +
pop ebx  +
pop ebp  +
retn 8  +
***
mov eax [ecx+4] +
test eax eax +
jz locret_102E5A5  +
push eax  +
call ds:FreeLibrary  +
retn   +
***
mov edi edi +
push esi  +
mov esi ecx +
cmp dword ptr [esi+4] 0 +
jz loc_102E5BB  +
xor eax eax +
inc eax  +
pop esi  +
retn   +
push offset LibFileName  +
call ds:LoadLibraryW  +
mov [esi+4] eax +
test eax eax +
jz loc_102E5DB  +
push offset ProcName  +
push eax  +
call ds:GetProcAddress  +
mov [esi] eax +
mov eax [esi+4] +
test eax eax +
jz loc_102E5F2  +
cmp dword ptr [esi] 0 +
jnz loc_102E5B6  +
test eax eax +
jz loc_102E5F2  +
push eax  +
call ds:FreeLibrary  +
and dword ptr [esi+4] 0 +
xor eax eax +
pop esi  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
cmp [ebp+arg_0] 0 +
jz loc_102E611  +
pop ebp  +
jmp ds:PathAddBackslashA  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
cmp [ebp+arg_0] 0 +
jz loc_102E62C  +
pop ebp  +
jmp ds:PathAddBackslashW  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
mov esi [ebp+arg_0] +
xor eax eax +
test esi esi +
jz loc_102E668  +
push ebx  +
mov bl [ebp+arg_4] +
test bl bl +
jz loc_102E667  +
mov ecx esi +
push edi  +
lea edi [ecx+1] +
mov dl [ecx] +
inc ecx  +
test dl dl +
jnz loc_102E652  +
sub ecx edi +
pop edi  +
jz loc_102E667  +
xor eax eax +
cmp [ecx+esi-1] bl +
setz al  +
pop ebx  +
pop esi  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
mov esi [ebp+arg_0] +
xor eax eax +
test esi esi +
jz loc_102E6AF  +
push ebx  +
mov bx [ebp+arg_4] +
xor ecx ecx +
cmp cx bx +
jz loc_102E6AE  +
mov ecx esi +
push edi  +
lea edi [ecx+2] +
mov dx [ecx] +
inc ecx  +
inc ecx  +
test dx dx +
jnz loc_102E693  +
sub ecx edi +
sar ecx 1 +
pop edi  +
jz loc_102E6AE  +
xor eax eax +
cmp [esi+ecx*2-2] bx +
setz al  +
pop ebx  +
pop esi  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
mov esi [ebp+arg_0] +
jmp loc_102E6D8  +
mov eax esi +
lea edx [eax+1] +
mov cl [eax] +
inc eax  +
test cl cl +
jnz loc_102E6C9  +
sub eax edx +
jz loc_102E6E5  +
mov [eax+esi-1] cl +
push [ebp+arg_4]  +
push esi  +
call sub_102E635  +
test eax eax +
jnz loc_102E6C4  +
pop esi  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
mov esi [ebp+arg_0] +
jmp loc_102E716  +
mov eax esi +
lea ecx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
test dx dx +
jnz loc_102E6FF  +
sub eax ecx +
sar eax 1 +
jz loc_102E723  +
xor ecx ecx +
mov [esi+eax*2-2] cx +
push [ebp+arg_4]  +
push esi  +
call sub_102E672  +
test eax eax +
jnz loc_102E6FA  +
pop esi  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 10h +
push ebx  +
mov ebx [ebp+arg_0] +
push esi  +
push edi  +
xor edi edi +
xor ecx ecx +
xor esi esi +
cmp ebx edi +
jz loc_102E8A9  +
mov esi ds:wcschr +
push 2Eh  +
mov [ebp+var_4] edi +
mov [ebp+arg_0] edi +
mov [ebp+var_C] edi +
mov [ebp+var_10] edi +
mov [ebp+var_8] edi +
push ebx  +
jmp loc_102E76C  +
inc [ebp+var_8]  +
push 2Eh  +
add eax 2 +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
cmp eax edi +
jnz loc_102E763  +
mov eax [ebp+var_8] +
dec eax  +
jz loc_102E843  +
dec eax  +
jz loc_102E826  +
dec eax  +
jz loc_102E805  +
cmp [ebp+var_8] edi +
jnz loc_102E7F8  +
push 2Ch  +
push ebx  +
jmp loc_102E79B  +
inc [ebp+var_8]  +
push 2Ch  +
add eax 2 +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
cmp eax edi +
jnz loc_102E792  +
mov eax [ebp+var_8] +
dec eax  +
jz loc_102E7E9  +
dec eax  +
jz loc_102E7D6  +
dec eax  +
jz loc_102E7BF  +
push ebx  +
call ds:_wtoi  +
pop ecx  +
mov [ebp+var_4] eax +
jmp loc_102E85A  +
lea eax [ebp+var_10] +
push eax  +
lea eax [ebp+var_C] +
push eax  +
lea eax [ebp+arg_0] +
push eax  +
lea eax [ebp+var_4] +
push eax  +
push offset aLuLuLuLu  +
jmp loc_102E81A  +
lea eax [ebp+var_C] +
push eax  +
lea eax [ebp+arg_0] +
push eax  +
lea eax [ebp+var_4] +
push eax  +
push offset aLuLuLu  +
jmp loc_102E837  +
lea eax [ebp+arg_0] +
push eax  +
lea eax [ebp+var_4] +
push eax  +
push offset aLuLu  +
jmp loc_102E850  +
push ebx  +
call ds:_wtoi  +
pop ecx  +
mov [ebp+var_C] eax +
jmp loc_102E85A  +
lea eax [ebp+var_10] +
push eax  +
lea eax [ebp+var_C] +
push eax  +
lea eax [ebp+arg_0] +
push eax  +
lea eax [ebp+var_4] +
push eax  +
push offset aLu_Lu_Lu_Lu  +
push ebx  +
call ds:swscanf  +
add esp 18h +
jmp loc_102E85A  +
lea eax [ebp+var_C] +
push eax  +
lea eax [ebp+arg_0] +
push eax  +
lea eax [ebp+var_4] +
push eax  +
push offset aLu_Lu_Lu  +
push ebx  +
call ds:swscanf  +
add esp 14h +
jmp loc_102E85A  +
lea eax [ebp+arg_0] +
push eax  +
lea eax [ebp+var_4] +
push eax  +
push offset aLu_Lu  +
push ebx  +
call ds:swscanf  +
add esp 10h +
mov eax [ebp+var_4] +
shl eax 10h +
add [ebp+arg_0] eax +
mov eax [ebp+var_C] +
shl eax 10h +
add [ebp+var_10] eax +
mov eax [ebp+arg_0] +
shr eax 10h +
cdq   +
shld edx eax +
shl eax 10h +
mov ecx eax +
movzx eax word ptr [ebp+arg_0] +
mov esi edx +
cdq   +
or ecx eax +
mov eax [ebp+var_10] +
or esi edx +
shld esi ecx +
shr eax 10h +
shl ecx 10h +
cdq   +
or ecx eax +
movzx eax word ptr [ebp+var_10] +
or esi edx +
shld esi ecx +
cdq   +
shl ecx 10h +
or ecx eax +
or esi edx +
pop edi  +
mov edx esi +
pop esi  +
mov eax ecx +
pop ebx  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
cmp [ebp+lpFileName] 0 +
jz loc_102E8DB  +
push [ebp+lpFileName]  +
call ds:GetFileAttributesW  +
cmp eax 0FFFFFFFFh +
jz loc_102E8DB  +
test al 10h +
jnz loc_102E8DB  +
xor eax eax +
inc eax  +
jmp loc_102E8DD  +
xor eax eax +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
cmp [ebp+lpFileName] 0 +
push esi  +
jz loc_102E920  +
mov esi [ebp+arg_4] +
test esi esi +
jz loc_102E920  +
push [ebp+lpFileName]  +
and dword ptr [esi] 0 +
call ds:GetFileAttributesW  +
cmp eax 0FFFFFFFFh +
jnz loc_102E90F  +
push 2  +
pop eax  +
jmp loc_102E925  +
test eax 800h +
jz loc_102E91C  +
mov dword ptr [esi] 1 +
xor eax eax +
jmp loc_102E925  +
mov eax 0A0h +
pop esi  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 1ACh +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
lea eax [ebp+VersionInformation] +
xor ebx ebx +
push eax  +
mov [ebp+hKey] ebx +
mov [ebp+cbData] 80h +
mov [ebp+Type] 1 +
mov [ebp+VersionInformation.dwOSVersionInfoSize] 114h +
call ds:GetVersionExW  +
test eax eax +
jnz loc_102E983  +
xor edx edx +
jmp loc_102EAA8  +
push esi  +
mov esi [ebp+VersionInformation.dwMajorVersion] +
xor eax eax +
shld eax esi +
mov eax [ebp+VersionInformation.dwMinorVersion] +
shl esi 10h +
or esi eax +
cmp [ebp+VersionInformation.dwPlatformId] 2 +
lea eax [ebp+hKey] +
push eax  +
push 1  +
mov [ebp+var_1AC] ebx +
push ebx  +
jnz loc_102EA2D  +
push offset aSoftwareMicr_9  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102EA9F  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
push offset aCurrentbuildnu  +
push [ebp+hKey]  +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102EA93  +
cmp [ebp+Type] 1 +
jnz loc_102EA93  +
lea eax [ebp+Data] +
push eax  +
call ds:_wtol  +
pop ecx  +
mov ecx 10000h +
mov [ebp+cbData] eax +
mul  ecx +
add [ebp+var_1AC] eax +
adc esi edx +
jmp loc_102EA93  +
push offset aSoftwareMic_29  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102EA9F  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
push offset aVersionnumber  +
push [ebp+hKey]  +
mov [ebp+cbData] 80h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102EA93  +
cmp [ebp+Type] 1 +
jnz loc_102EA93  +
lea eax [ebp+Data] +
push eax  +
call sub_102E72D  +
mov [ebp+var_1AC] eax +
mov esi edx +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov eax [ebp+var_1AC] +
mov edx esi +
pop esi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 98h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
lea eax [ebp+VersionInformation] +
push eax  +
mov [ebp+VersionInformation.dwOSVersionInfoSize] 94h +
call ds:GetVersionExA  +
test eax eax +
jz loc_102EB0E  +
cmp [ebp+VersionInformation.dwPlatformId] 2 +
jz loc_102EB0E  +
mov eax [ebp+VersionInformation.dwMajorVersion] +
cmp eax [ebp+arg_0] +
jb loc_102EB0E  +
mov eax [ebp+VersionInformation.dwMinorVersion] +
cmp eax [ebp+arg_4] +
jb loc_102EB0E  +
xor eax eax +
inc eax  +
jmp loc_102EB10  +
xor eax eax +
mov ecx [ebp+var_4] +
xor ecx ebp +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 118h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
lea eax [ebp+VersionInformation] +
push eax  +
xor esi esi +
mov [ebp+VersionInformation.dwOSVersionInfoSize] 114h +
call ds:GetVersionExW  +
test eax eax +
jz loc_102EB67  +
cmp [ebp+VersionInformation.dwPlatformId] 2 +
jnz loc_102EB65  +
mov esi [ebp+VersionInformation.dwMajorVersion] +
mov eax esi +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn   +
***
push ebp  +
mov ebp esp +
push ecx  +
push ecx  +
push esi  +
lea eax [ebp-4] +
push eax  +
push 1  +
xor esi esi +
push esi  +
push offset aSystemCurren_1  +
push 80000002h  +
mov [ebp-8] esi +
mov [ebp-4] esi +
call ds:RegOpenKeyExA  +
test eax eax +
jnz loc_102EBC2  +
lea eax [ebp-8] +
push eax  +
push esi  +
push esi  +
push esi  +
push offset aPendingfileren  +
push dword ptr [ebp-4]  +
call ds:RegQueryValueExA  +
push dword ptr [ebp-4]  +
call ds:RegCloseKey  +
mov eax [ebp-8] +
pop esi  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 0E4h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_4] +
mov ecx [ebp+arg_8] +
push ebx  +
push esi  +
push edi  +
mov edi [ebp+lptstrFilename] +
xor esi esi +
mov [ebp+var_D0] eax +
mov [ebp+var_CC] ecx +
cmp edi esi +
jz loc_102EF11  +
cmp eax esi +
jz loc_102EF11  +
cmp ecx esi +
jz loc_102EF11  +
lea eax [ebp+dwHandle] +
push eax  +
push edi  +
mov [ebp+dwHandle] esi +
call GetFileVersionInfoSizeW  +
mov ebx eax +
cmp ebx esi +
jnz loc_102EE8A  +
push edi  +
call sub_102E8B9  +
test eax eax +
jnz loc_102ECBA  +
mov eax 80070002h +
jmp loc_102EF16  +
push esi  +
push 80h  +
push 3  +
push esi  +
push 1  +
push esi  +
push edi  +
call ds:CreateFileW  +
mov [ebp+hObject] eax +
cmp eax 0FFFFFFFFh +
jz loc_102EF11  +
lea ecx [ebp+lpBuffer] +
push ecx  +
push esi  +
push esi  +
push eax  +
mov [ebp+pBlock] 80004005h +
call ds:GetFileTime  +
test eax eax +
jz loc_102EE73  +
lea eax [ebp+SystemTime] +
push eax  +
lea eax [ebp+lpBuffer] +
push eax  +
call ds:FileTimeToSystemTime  +
test eax eax +
jz loc_102EE73  +
push 0ACh  +
lea eax [ebp+TimeZoneInformation] +
push esi  +
push eax  +
call memset  +
movzx eax [ebp+SystemTime.wYear] +
mov edi [ebp+var_D0] +
movzx ecx [ebp+SystemTime.wDay] +
mov ebx [ebp+var_CC] +
mov [edi] eax +
movzx eax [ebp+SystemTime.wMonth] +
shl eax 10h +
or eax ecx +
mov [ebx] eax +
add esp 0Ch +
lea eax [ebp+TimeZoneInformation] +
push eax  +
mov [ebp+pBlock] esi +
call ds:GetTimeZoneInformation  +
cmp eax 0FFFFFFFFh +
jz loc_102EE73  +
mov ecx [ebp+TimeZoneInformation.Bias] +
cmp ecx esi +
jle loc_102ED84  +
movzx eax cx +
jmp loc_102ED8B  +
mov eax ecx +
neg eax  +
movzx eax ax +
movzx eax ax +
cdq   +
push 3Ch  +
pop esi  +
idiv  esi +
cmp ecx 1 +
movzx eax ax +
jge loc_102EDA5  +
add [ebp+SystemTime.wHour] ax +
jmp loc_102EDC9  +
cmp [ebp+SystemTime.wHour] ax +
jnb loc_102EDC2  +
mov ecx 0FFFFh +
add [ebp+SystemTime.wDay] cx +
add [ebp+SystemTime.wHour] 18h +
sub [ebp+SystemTime.wHour] ax +
cmp [ebp+SystemTime.wHour] 17h +
jbe loc_102EE19  +
mov eax 0FFE8h +
add [ebp+SystemTime.wHour] ax +
inc [ebp+SystemTime.wDay]  +
cmp [ebp+SystemTime.wDay] 20h +
jnz loc_102EE19  +
xor eax eax +
inc eax  +
inc [ebp+SystemTime.wMonth]  +
cmp [ebp+SystemTime.wMonth] 0Dh +
mov [ebp+SystemTime.wDay] ax +
jnz loc_102EE19  +
inc [ebp+SystemTime.wYear]  +
mov [ebp+SystemTime.wMonth] ax +
fldz   +
lea eax [ebp+puLen] +
push eax  +
fstp  qword ptr [ebp+puLen] +
lea eax [ebp+SystemTime] +
push eax  +
call ds:SystemTimeToVariantTime  +
test eax eax +
jz loc_102EE73  +
fld  qword ptr [ebp+puLen] +
lea eax [ebp+SystemTime] +
push eax  +
push ecx  +
push ecx  +
fstp  [esp+0FCh+var_FC] +
call ds:VariantTimeToSystemTime  +
test eax eax +
jz loc_102EE73  +
movzx eax [ebp+SystemTime.wYear] +
movzx ecx [ebp+SystemTime.wDay] +
mov [edi] eax +
movzx eax [ebp+SystemTime.wMonth] +
shl eax 10h +
or eax ecx +
mov [ebx] eax +
push [ebp+hObject]  +
call ds:CloseHandle  +
mov eax [ebp+pBlock] +
jmp loc_102EF16  +
push ebx  +
call ??_U@YAPAXI@Z  +
pop ecx  +
mov [ebp+pBlock] eax +
cmp eax esi +
jnz loc_102EEA2  +
mov eax 8007000Eh +
jmp loc_102EF16  +
push eax  +
push ebx  +
push esi  +
push edi  +
mov [ebp+hObject] 80004005h +
call GetFileVersionInfoW  +
test eax eax +
jz loc_102EEFD  +
lea eax [ebp-0E0h] +
push eax  +
lea eax [ebp-0D8h] +
push eax  +
push offset SubBlock  +
push [ebp+pBlock]  +
call VerQueryValueW  +
test eax eax +
jz loc_102EEFD  +
mov eax [ebp-0D8h] +
mov ecx [eax+8] +
mov edx [ebp+var_D0] +
mov [edx] ecx +
mov eax [eax+0Ch] +
mov ecx [ebp+var_CC] +
mov [ecx] eax +
mov [ebp+hObject] esi +
push [ebp+pBlock]  +
call ??_V@YAXPAX@Z  +
mov eax [ebp+hObject] +
pop ecx  +
jmp loc_102EF16  +
mov eax 80004005h +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push ecx  +
push esi  +
push edi  +
xor edi edi +
xor esi esi +
cmp [ebp+lptstrFilename] edi +
jz loc_102EF9B  +
lea eax [ebp+var_8] +
push eax  +
lea eax [ebp+var_4] +
push eax  +
push [ebp+lptstrFilename]  +
mov [ebp+var_4] edi +
mov [ebp+var_8] edi +
call sub_102EC42  +
test eax eax +
jl loc_102EF9B  +
mov eax [ebp+var_4] +
shr eax 10h +
cdq   +
shld edx eax +
shl eax 10h +
mov ecx eax +
movzx eax word ptr [ebp+var_4] +
mov esi edx +
cdq   +
or ecx eax +
mov eax [ebp+var_8] +
or esi edx +
shld esi ecx +
shr eax 10h +
cdq   +
or esi edx +
shl ecx 10h +
or ecx eax +
mov edi esi +
mov eax ecx +
shld edi eax +
shl eax 10h +
mov esi eax +
movzx eax word ptr [ebp+var_8] +
cdq   +
or esi eax +
or edi edx +
mov edx edi +
pop edi  +
mov eax esi +
pop esi  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 44h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+lpValueName] +
mov ecx [ebp+arg_8] +
push ebx  +
mov ebx [ebp+hKey] +
push esi  +
xor esi esi +
inc esi  +
mov [ebp+var_44] eax +
mov [ebp+var_40] ecx +
mov [ebp+cbData] 28h +
mov [ebp+Type] esi +
mov [ebp+var_38] esi +
test ebx ebx +
jz loc_102F060  +
test eax eax +
jz loc_102F060  +
push edi  +
mov edi ds:RegQueryValueExW +
lea ecx [ebp+cbData] +
push ecx  +
lea ecx [ebp+Data] +
push ecx  +
lea ecx [ebp+Type] +
push ecx  +
push 0  +
push eax  +
push ebx  +
call edi  +
test eax eax +
jnz loc_102F05A  +
cmp [ebp+Type] esi +
jnz loc_102F01F  +
lea eax [ebp+Data] +
push eax  +
push offset aYes  +
call ds:_wcsicmp  +
neg eax  +
pop ecx  +
sbb eax eax +
pop ecx  +
inc eax  +
jmp loc_102F051  +
push 4  +
pop eax  +
cmp [ebp+Type] eax +
jnz loc_102F05A  +
mov [ebp+cbData] eax +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_3C] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push [ebp+var_44]  +
mov [ebp+var_3C] esi +
push ebx  +
call edi  +
test eax eax +
jnz loc_102F05A  +
cmp [ebp+Type] 4 +
jnz loc_102F05A  +
cmp [ebp+var_3C] esi +
setz al  +
mov ecx [ebp+var_40] +
and [ebp+var_38] 0 +
mov [ecx] eax +
mov eax [ebp+var_38] +
pop edi  +
jmp loc_102F065  +
mov eax 80070057h +
mov ecx [ebp+var_4] +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push ecx  +
mov eax [ebp+arg_4] +
push ebx  +
push esi  +
mov esi ds:RegOpenKeyExW +
push edi  +
mov [ebp+var_8] eax +
lea eax [ebp+hKey] +
push eax  +
push 1  +
xor ebx ebx +
push ebx  +
push offset aSoftwareMicr_0  +
mov edi 80000002h +
push edi  +
mov [ebp+hKey] ebx +
mov [ebp+arg_4] ebx +
call esi  +
test eax eax +
jnz loc_102F0D2  +
lea eax [ebp+arg_4] +
push eax  +
push [ebp+lpValueName]  +
push [ebp+hKey]  +
call sub_102EFAA  +
test eax eax +
jnz loc_102F0C9  +
mov eax [ebp+arg_4] +
mov [ebp+var_8] eax +
push [ebp+hKey]  +
call ds:RegCloseKey  +
lea eax [ebp+hKey] +
push eax  +
push 1  +
push ebx  +
push offset aSoftwareMicr_8  +
push 80000001h  +
call esi  +
test eax eax +
jnz loc_102F10B  +
lea eax [ebp+arg_4] +
push eax  +
push [ebp+lpValueName]  +
push [ebp+hKey]  +
call sub_102EFAA  +
test eax eax +
jnz loc_102F102  +
mov eax [ebp+arg_4] +
mov [ebp+var_8] eax +
push [ebp+hKey]  +
call ds:RegCloseKey  +
lea eax [ebp+hKey] +
push eax  +
push 1  +
push ebx  +
push offset aSoftwarePoli_0  +
push edi  +
call esi  +
pop edi  +
pop esi  +
pop ebx  +
test eax eax +
jnz loc_102F143  +
lea eax [ebp+arg_4] +
push eax  +
push [ebp+lpValueName]  +
push [ebp+hKey]  +
call sub_102EFAA  +
test eax eax +
jnz loc_102F13A  +
mov eax [ebp+arg_4] +
mov [ebp+var_8] eax +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov eax [ebp+var_8] +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push ecx  +
and [ebp+hKey] 0 +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push 2  +
push 0  +
push offset aSystemCurren_2  +
push 80000002h  +
call ds:RegOpenKeyExW  +
mov esi eax +
test esi esi +
jnz loc_102F1A6  +
push 4  +
lea eax [ebp+Data] +
push eax  +
push 4  +
push esi  +
push offset aAllowprotected  +
push [ebp+hKey]  +
mov dword ptr [ebp+Data] 1 +
call ds:RegSetValueExW  +
push [ebp+hKey]  +
mov esi eax +
call ds:RegCloseKey  +
test esi esi +
jz loc_102F1B6  +
push esi  +
push offset aErrorCouldNotS  +
push 2  +
call sub_1039F55  +
add esp 0Ch +
pop esi  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push ecx  +
cmp dword ptr [ebp+lpFileName] 0 +
jnz loc_102F1D2  +
xor eax eax +
jmp locret_102F288  +
push ebx  +
push esi  +
mov esi ds:GetFileAttributesW +
push edi  +
push [ebp+lpExistingFileName]  +
call esi  +
mov ebx ds:GetLastError +
mov edi 4000h +
test eax edi +
jz loc_102F22C  +
and [ebp+var_8] 0 +
and [ebp+var_4] 0 +
lea ecx [ebp+var_8] +
call sub_102E5AB  +
test eax eax +
jz loc_102F224  +
push 0  +
push [ebp+lpExistingFileName]  +
call [ebp+var_8]  +
test eax eax +
jnz loc_102F224  +
call ebx  +
push eax  +
push dword ptr [ebp+lpFileName]  +
push offset aErrorDecryptio  +
push 2  +
call sub_1039F55  +
add esp 10h +
lea ecx [ebp+var_8] +
call sub_102E597  +
push 0  +
push dword ptr [ebp+lpFileName]  +
push [ebp+lpExistingFileName]  +
call ds:CopyFileW  +
push dword ptr [ebp+lpFileName]  +
mov [ebp+lpExistingFileName] eax +
call esi  +
test eax edi +
jz loc_102F282  +
xor esi esi +
lea ecx [ebp+var_8] +
mov [ebp+var_8] esi +
mov [ebp+var_4] esi +
call sub_102E5AB  +
test eax eax +
jz loc_102F27A  +
push esi  +
push dword ptr [ebp+lpFileName]  +
call [ebp+var_8]  +
test eax eax +
jnz loc_102F27A  +
call ebx  +
push eax  +
push dword ptr [ebp+lpFileName]  +
push offset aErrorDecryptio  +
push 2  +
call sub_1039F55  +
add esp 10h +
lea ecx [ebp+var_8] +
call sub_102E597  +
mov eax [ebp+lpExistingFileName] +
pop edi  +
pop esi  +
pop ebx  +
leave   +
retn 10h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 43Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_4] +
push ebx  +
mov ebx [ebp+arg_0] +
push esi  +
push edi  +
mov edi ds:RegEnumValueW +
mov [ebp+hKey] eax +
xor esi esi +
lea eax [ebp+cbData] +
push eax  +
push esi  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
lea eax [ebp+cbValueName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
mov [ebp+var_438] ebx +
mov [ebp+dwType] 4 +
mov dword ptr [ebp+Data] esi +
mov [ebp+dwIndex] esi +
mov [ebp+lpData] esi +
mov [ebp+var_424] 1 +
mov [ebp+cbValueName] 104h +
push esi  +
jmp loc_102F54C  +
cmp [ebp+cbData] esi +
jz loc_102F522  +
mov eax [ebp+dwType] +
cmp eax esi +
jbe loc_102F512  +
cmp eax 2 +
jbe loc_102F496  +
cmp eax 3 +
jz loc_102F3FE  +
jbe loc_102F512  +
cmp eax 5 +
jbe loc_102F3B2  +
cmp eax 7 +
jnz loc_102F512  +
push [ebp+cbData]  +
call ??_U@YAPAXI@Z  +
pop ecx  +
mov [ebp+lpData] eax +
cmp eax esi +
jz loc_102F512  +
lea ecx [ebp+cbData] +
push ecx  +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
lea eax [ebp+cbValueName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+dwIndex]  +
push ebx  +
call edi  +
test eax eax +
jnz loc_102F473  +
push [ebp+cbData]  +
lea eax [ebp+lpData] +
push eax  +
jmp loc_102F44F  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
lea eax [ebp+cbValueName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+dwIndex]  +
mov [ebp+cbData] 4 +
push ebx  +
call edi  +
test eax eax +
jnz loc_102F518  +
push 4  +
lea eax [ebp+Data] +
jmp loc_102F4F3  +
push [ebp+cbData]  +
call ??_U@YAPAXI@Z  +
pop ecx  +
mov [ebp+lpData] eax +
cmp eax esi +
jz loc_102F512  +
lea ecx [ebp+cbData] +
push ecx  +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
lea eax [ebp+cbValueName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+dwIndex]  +
push ebx  +
call edi  +
test eax eax +
jnz loc_102F473  +
push [ebp+cbData]  +
push [ebp+lpData]  +
push [ebp+dwType]  +
lea eax [ebp+SubKey] +
push esi  +
push eax  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
test eax eax +
jz loc_102F473  +
mov [ebp+var_424] esi +
cmp [ebp+lpData] esi +
jz loc_102F518  +
push [ebp+lpData]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [ebp+lpData] esi +
jmp loc_102F518  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_414] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
lea eax [ebp+cbValueName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+dwIndex]  +
mov [ebp+cbData] 208h +
push ebx  +
call edi  +
test eax eax +
jnz loc_102F518  +
lea eax [ebp+var_414] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_102F4DA  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_414] +
push eax  +
push [ebp+dwType]  +
lea eax [ebp+SubKey] +
push esi  +
push eax  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
test eax eax +
jz loc_102F518  +
mov [ebp+var_424] esi +
mov [ebp+cbValueName] 104h +
inc [ebp+dwIndex]  +
lea eax [ebp+cbData] +
push eax  +
push esi  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
lea eax [ebp+cbValueName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+dwIndex]  +
push ebx  +
mov [ebp+cbData] 208h +
call edi  +
mov [ebp+cbValueName] 104h +
test eax eax +
jz loc_102F317  +
mov edi ds:RegEnumKeyExW +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbValueName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
xor ebx ebx +
push esi  +
jmp loc_102F644  +
lea eax [ebp+phkResult] +
push eax  +
push 20019h  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+var_438]  +
mov [ebp+phkResult] esi +
mov [ebp+dwIndex] esi +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_102F620  +
push esi  +
lea eax [ebp+dwIndex] +
push eax  +
push esi  +
push 2001Fh  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+hKey]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_102F60C  +
push [ebp+dwIndex]  +
push [ebp+phkResult]  +
call sub_102F291  +
test eax eax +
jnz loc_102F5FE  +
mov [ebp+var_424] esi +
push [ebp+dwIndex]  +
call ds:RegCloseKey  +
jmp loc_102F612  +
mov [ebp+var_424] esi +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
jmp loc_102F626  +
mov [ebp+var_424] esi +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbValueName] +
push eax  +
lea eax [ebp+SubKey] +
inc ebx  +
push eax  +
mov [ebp+cbValueName] 104h +
push ebx  +
push [ebp+var_438]  +
call edi  +
test eax eax +
jz loc_102F58B  +
mov ecx [ebp+var_4] +
mov eax [ebp+var_424] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 20h +
push ebx  +
push esi  +
push edi  +
xor ebx ebx +
push ebx  +
push ebx  +
lea eax [ebp+cbMaxValueLen] +
push eax  +
lea eax [ebp+cbMaxValueNameLen] +
push eax  +
lea eax [ebp+cValues] +
push eax  +
push ebx  +
push ebx  +
push ebx  +
push ebx  +
push ebx  +
push ebx  +
push [ebp+hKey]  +
mov [ebp+cValues] ebx +
mov [ebp+cbMaxValueNameLen] ebx +
mov [ebp+cbMaxValueLen] ebx +
call ds:RegQueryInfoKeyW  +
test eax eax +
jnz loc_102F6FC  +
cmp [ebp+arg_4] ebx +
jz loc_102F6FC  +
cmp [ebp+arg_8] ebx +
jz loc_102F6FC  +
xor edi edi +
mov [ebp+var_8] ebx +
cmp [ebp+cValues] ebx +
jbe loc_102F845  +
mov eax [ebp+cbMaxValueNameLen] +
xor ecx ecx +
push 2  +
inc eax  +
pop edx  +
mul  edx +
seto cl  +
neg ecx  +
or ecx eax +
push ecx  +
call ??_U@YAPAXI@Z  +
mov edi eax +
pop ecx  +
cmp edi ebx +
jz loc_102F6FC  +
mov eax [ebp+cbMaxValueLen] +
mov esi ds:malloc +
add eax 2 +
push eax  +
call esi  +
pop ecx  +
mov [ebp+lpData] eax +
cmp eax ebx +
jnz loc_102F705  +
push edi  +
call ??_V@YAXPAX@Z  +
pop ecx  +
xor eax eax +
pop edi  +
pop esi  +
pop ebx  +
leave   +
retn 0Ch  +
mov eax [ebp+cValues] +
lea eax ds:4[eax*4] +
push eax  +
call esi  +
mov ebx eax +
pop ecx  +
test ebx ebx +
jnz loc_102F72B  +
push edi  +
call ??_V@YAXPAX@Z  +
push [ebp+lpData]  +
call ds:free  +
pop ecx  +
jmp loc_102F6FB  +
mov esi [ebp+cValues] +
lea eax ds:4[esi*4] +
push eax  +
push 0FFh  +
push ebx  +
call memset  +
add esp 0Ch +
test esi esi +
jbe loc_102F7EF  +
mov eax [ebp+cbMaxValueNameLen] +
inc eax  +
mov [ebp+cbValueName] eax +
mov eax [ebp+cbMaxValueLen] +
add eax 2 +
mov [ebp+cbData] eax +
lea eax [ebp+cbData] +
push eax  +
push [ebp+lpData]  +
lea eax [ebp+Type] +
push eax  +
push 0  +
lea eax [ebp+cbValueName] +
push eax  +
push edi  +
lea eax [esi-1] +
push eax  +
push [ebp+hKey]  +
call ds:RegEnumValueW  +
test eax eax +
jnz loc_102F7EF  +
mov eax [ebp+arg_4] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_102F785  +
sub eax edx +
sar eax 1 +
push eax  +
push [ebp+arg_4]  +
push edi  +
call ds:_wcsnicmp  +
add esp 0Ch +
test eax eax +
jnz loc_102F7E8  +
cmp [ebp+Type] 1 +
jz loc_102F7B1  +
cmp [ebp+Type] 2 +
jnz loc_102F7C3  +
push [ebp+arg_8]  +
push [ebp+lpData]  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102F81B  +
mov eax [ebp+arg_4] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_102F7C9  +
sub eax edx +
sar eax 1 +
lea eax [edi+eax*2] +
push eax  +
call ds:_wtoi  +
pop ecx  +
mov [ebp+var_8] eax +
mov [ebx+esi*4] eax +
dec esi  +
jnz loc_102F74C  +
push [ebp+lpData]  +
mov esi ds:free +
call esi  +
pop ecx  +
xor eax eax +
inc eax  +
cmp [ebp+cValues] eax +
jb loc_102F832  +
mov ecx [ebx+eax*4] +
cmp ecx [ebp+var_8] +
jz loc_102F811  +
inc eax  +
cmp eax [ebp+cValues] +
jbe loc_102F803  +
cmp eax [ebp+cValues] +
ja loc_102F832  +
inc [ebp+var_8]  +
jmp loc_102F7FB  +
push [ebp+lpData]  +
mov esi ds:free +
call esi  +
push ebx  +
call esi  +
pop ecx  +
pop ecx  +
mov eax edi +
jmp loc_102F6FE  +
push ebx  +
call esi  +
cmp [ebp+var_8] 1869Fh +
pop ecx  +
jg loc_102F6F5  +
xor ebx ebx +
mov eax [ebp+arg_4] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_102F84B  +
sub eax edx +
sar eax 1 +
add eax eax +
lea ecx [eax+6] +
mov [ebp+cValues] eax +
cmp [ebp+cbMaxValueNameLen] ecx +
jnb loc_102F8BF  +
cmp edi ebx +
jz loc_102F874  +
push edi  +
call ??_V@YAXPAX@Z  +
mov eax [ebp+cValues] +
pop ecx  +
xor ecx ecx +
push 2  +
add eax 6 +
pop edx  +
mul  edx +
seto cl  +
neg ecx  +
or ecx eax +
push ecx  +
call ??_U@YAPAXI@Z  +
mov edi eax +
pop ecx  +
cmp edi ebx +
jz loc_102F6FC  +
mov eax [ebp+cValues] +
push eax  +
push [ebp+arg_4]  +
push edi  +
call memcpy  +
mov eax [ebp+cValues] +
shr eax 1 +
push 0Ah  +
lea eax [edi+eax*2] +
push eax  +
push [ebp+var_8]  +
call ds:_itow  +
add esp 18h +
jmp loc_102F82B  +
cmp edi ebx +
jz loc_102F82B  +
jmp loc_102F899  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 21Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
mov ebx [ebp+lpSubKey] +
push edi  +
mov edi [ebp+hKey] +
push ebx  +
push edi  +
mov [ebp+var_21C] edi +
mov [ebp+var_218] ebx +
call ds:RegDeleteKeyW  +
test eax eax +
jz loc_102F9C1  +
push esi  +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
xor esi esi +
push esi  +
push ebx  +
push edi  +
mov [ebp+phkResult] esi +
call ds:RegOpenKeyExW  +
cmp eax esi +
jnz loc_102F9C0  +
mov edi ds:RegEnumKeyExW +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
push [ebp+phkResult]  +
mov [ebp+cbName] 104h +
call edi  +
mov ebx 103h +
jmp loc_102F99E  +
cmp eax esi +
jnz loc_102F9A2  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+phkResult]  +
call sub_102F8CE  +
test eax eax +
jnz loc_102F9A2  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
push [ebp+phkResult]  +
mov [ebp+cbName] 104h +
call edi  +
cmp eax ebx +
jnz loc_102F95F  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push [ebp+var_218]  +
push [ebp+var_21C]  +
call ds:RegDeleteKeyW  +
pop esi  +
mov ecx [ebp+var_4] +
pop edi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push esi  +
xor esi esi +
mov [ebp+cbData] esi +
cmp [ebp+hKey] esi +
jnz loc_102F9EC  +
push 6  +
pop eax  +
jmp loc_102FA32  +
cmp [ebp+arg_0] esi +
jnz loc_102FA1A  +
lea eax [ebp+cbData] +
push eax  +
push esi  +
push esi  +
push esi  +
push [ebp+lpValueName]  +
push [ebp+hKey]  +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102FA1A  +
cmp [ebp+lpValueName] esi +
jnz loc_102FA13  +
cmp [ebp+cbData] 2 +
jbe loc_102FA1A  +
mov eax 0B7h +
jmp loc_102FA32  +
push [ebp+arg_18]  +
push [ebp+lpData]  +
push [ebp+dwType]  +
push [ebp+Reserved]  +
push [ebp+lpValueName]  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
pop esi  +
leave   +
retn 1Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 230h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
mov ebx ds:RegOpenKeyExW +
push esi  +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push 20019h  +
xor esi esi +
push esi  +
push offset aSoftwareMic_50  +
mov edi 80000002h +
push edi  +
mov [ebp+hKey] esi +
call ebx  +
test eax eax +
jnz loc_102FBC2  +
push esi  +
lea eax [ebp+var_218] +
push eax  +
push esi  +
push 2001Fh  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMic_51  +
push edi  +
mov [ebp+var_224] esi +
mov [ebp+var_218] esi +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_102FBB6  +
mov edi ds:RegEnumKeyExW +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+var_220] +
push eax  +
lea eax [ebp+ValueName] +
push eax  +
push esi  +
jmp loc_102FB90  +
inc [ebp+var_224]  +
lea eax [ebp+phkResult] +
push eax  +
push 20019h  +
push esi  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+hKey]  +
mov [ebp+phkResult] esi +
call ebx  +
test eax eax +
jnz loc_102FB78  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aWmplayer_exe  +
push [ebp+phkResult]  +
mov [ebp+Type] 1 +
mov dword ptr [ebp+Data] esi +
mov [ebp+cbData] 4 +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_102FB6C  +
cmp [ebp+Type] 4 +
jnz loc_102FB6C  +
push 4  +
lea eax [ebp+Data] +
push eax  +
push 4  +
push esi  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+var_218]  +
call ds:RegSetValueExW  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+var_220] +
push eax  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+var_224]  +
push [ebp+hKey]  +
mov [ebp+var_220] 105h +
call edi  +
test eax eax +
jz loc_102FAD3  +
push [ebp+var_218]  +
call ds:RegCloseKey  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov edx [ebp+arg_4] +
xor eax eax +
test edx edx +
jz loc_102FBEC  +
cmp edx 7FFFFFFFh +
jbe loc_102FBF1  +
mov eax 80070057h +
test eax eax +
jl loc_102FC07  +
mov eax [ebp+arg_8] +
mov ecx [ebp+arg_0] +
push 7FFFFFFEh  +
push 0  +
call sub_102E548  +
pop ebp  +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov edx [ebp+arg_4] +
push ebx  +
xor eax eax +
push esi  +
mov esi 7FFFFFFFh +
test edx edx +
jz loc_102FC29  +
cmp edx esi +
jbe loc_102FC2E  +
mov eax 80070057h +
mov ebx [ebp+arg_0] +
test eax eax +
jl loc_102FC46  +
push edi  +
lea edi [ebp+arg_0] +
mov eax ebx +
call sub_102E513  +
mov ecx [ebp+arg_0] +
pop edi  +
jmp loc_102FC48  +
xor ecx ecx +
test eax eax +
jl loc_102FC5E  +
mov edx [ebp+arg_4] +
mov eax [ebp+arg_8] +
push esi  +
sub edx ecx +
push 0  +
add ecx ebx +
call sub_102E548  +
pop esi  +
pop ebx  +
pop ebp  +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
mov esi [ebp+arg_0] +
push edi  +
xor edi edi +
test esi esi +
jz loc_102FCB7  +
call sub_102EB23  +
push [ebp+uSize]  +
push esi  +
cmp eax 6 +
jnz loc_102FC98  +
call ds:GetSystemDirectoryW  +
test eax eax +
jz loc_102FCB7  +
push offset aUnregmp2_exe_0  +
jmp loc_102FCA7  +
call ds:GetSystemWindowsDirectoryW  +
test eax eax +
jz loc_102FCB7  +
push offset aInfUnregmp2_ex  +
push [ebp+uSize]  +
push esi  +
call sub_1027EDD  +
test eax eax +
jl loc_102FCB7  +
xor edi edi +
inc edi  +
mov eax edi +
pop edi  +
pop esi  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
cmp [ebp+arg_0] 0 +
jz loc_102FD05  +
push esi  +
mov esi [ebp+arg_4] +
test esi esi +
jz loc_102FD04  +
cmp esi [ebp+arg_0] +
jz loc_102FCE8  +
push [ebp+arg_0]  +
push [ebp+arg_8]  +
push esi  +
call sub_1027E68  +
push 5Ch  +
push esi  +
call ds:wcsrchr  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102FCFF  +
xor ecx ecx +
mov [eax+2] cx +
jmp loc_102FD04  +
xor eax eax +
mov [esi] ax +
pop esi  +
pop ebp  +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
mov esi [ebp+arg_0] +
push edi  +
test esi esi +
jz loc_102FD91  +
cmp [ebp+arg_4] 0 +
jz loc_102FD91  +
mov eax [esi] +
test eax eax +
jz loc_102FD32  +
push eax  +
call ??_V@YAXPAX@Z  +
and dword ptr [esi] 0 +
pop ecx  +
mov eax [ebp+arg_4] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_102FD38  +
sub eax edx +
sar eax 1 +
lea edi [eax+1] +
xor ecx ecx +
push 2  +
pop edx  +
mov eax edi +
mul  edx +
seto cl  +
neg ecx  +
or ecx eax +
push ecx  +
call ??_U@YAPAXI@Z  +
pop ecx  +
mov [esi] eax +
test eax eax +
jnz loc_102FD6D  +
mov eax 8007000Eh +
jmp loc_102FD96  +
push [ebp+arg_4]  +
push edi  +
push eax  +
call sub_1027E68  +
mov edi eax +
test edi edi +
jge loc_102FD8D  +
mov eax [esi] +
test eax eax +
jz loc_102FD8D  +
push eax  +
call ??_V@YAXPAX@Z  +
and dword ptr [esi] 0 +
pop ecx  +
mov eax edi +
jmp loc_102FD96  +
mov eax 80004003h +
pop edi  +
pop esi  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
cmp [ebp+arg_8] 0 +
jnz loc_102FDB4  +
mov eax 80004003h +
jmp locret_102FDED  +
movzx eax word ptr [ebp+arg_0] +
mov edx [ebp+arg_0] +
push eax  +
mov eax [ebp+arg_4] +
mov ecx eax +
shrd edx ecx +
shr ecx 10h +
mov ecx 0FFFFh +
and edx ecx +
push edx  +
movzx edx ax +
push edx  +
shr eax 10h +
and eax ecx +
push eax  +
push offset aLu_Lu_Lu_Lu  +
push [ebp+arg_C]  +
push [ebp+arg_8]  +
call sub_1027F64  +
add esp 1Ch +
leave   +
retn 10h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 108h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
push esi  +
xor esi esi +
test eax eax +
jz loc_102FE54  +
push eax  +
push 104h  +
lea eax [ebp+FileName] +
push eax  +
call sub_102FBD6  +
test eax eax +
jl loc_102FE54  +
push 5Ch  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E6B9  +
lea eax [ebp+FileName] +
push eax  +
call ds:GetFileAttributesA  +
cmp eax 0FFFFFFFFh +
jz loc_102FE52  +
test al 10h +
jz loc_102FE52  +
inc esi  +
jmp loc_102FE54  +
xor esi esi +
mov ecx [ebp+var_4] +
mov eax esi +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 20Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
push esi  +
xor esi esi +
test eax eax +
jz loc_102FEC8  +
push eax  +
push 104h  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_102FEC8  +
push 5Ch  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E6EF  +
lea eax [ebp+FileName] +
push eax  +
call ds:GetFileAttributesW  +
cmp eax 0FFFFFFFFh +
jz loc_102FEC6  +
test al 10h +
jz loc_102FEC6  +
inc esi  +
jmp loc_102FEC8  +
xor esi esi +
mov ecx [ebp+var_4] +
mov eax esi +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov eax [ebp+arg_0] +
sub esp 0Ch +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_102FEEC  +
push ebx  +
sub eax edx +
sar eax 1 +
push esi  +
lea ebx [eax+14h] +
xor ecx ecx +
push 2  +
pop edx  +
mov eax ebx +
mul  edx +
seto cl  +
neg ecx  +
or ecx eax +
push ecx  +
call ??_U@YAPAXI@Z  +
mov esi eax +
pop ecx  +
test esi esi +
jz loc_102FFE8  +
push edi  +
push [ebp+arg_0]  +
push ebx  +
push esi  +
call sub_1027E68  +
mov edi ds:wcsstr +
push offset asc_1005894  +
push esi  +
call edi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102FFE0  +
add eax 4 +
and [ebp+var_4] 0 +
jmp loc_102FF4F  +
mov eax [ebp+var_C] +
push offset SubBlock  +
push eax  +
call edi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_102FFD7  +
xor ecx ecx +
mov [eax] cx +
add eax 2 +
push esi  +
mov [ebp+var_C] eax +
call sub_102FE6A  +
test eax eax +
jnz loc_102FFAF  +
push eax  +
push esi  +
call ds:CreateDirectoryW  +
call ds:GetLastError  +
test eax eax +
jnz loc_102FF89  +
push 57h  +
pop eax  +
test eax eax +
jle loc_102FF95  +
and eax 0FFFFh +
or eax 80070000h +
push esi  +
mov [ebp+var_8] eax +
call sub_102FE6A  +
test eax eax +
jz loc_102FFC4  +
push 0  +
push esi  +
push 5  +
push 8  +
call ds:SHChangeNotify  +
push [ebp+arg_0]  +
push ebx  +
push esi  +
call sub_1027E68  +
inc [ebp+var_4]  +
cmp [ebp+var_4] 0Ah +
jl loc_102FF4C  +
jmp loc_102FFD7  +
push [ebp+var_8]  +
push esi  +
push offset aErrorCouldNotC  +
push 2  +
call sub_1039F55  +
add esp 10h +
push 0  +
push esi  +
call ds:CreateDirectoryW  +
push esi  +
call ??_V@YAXPAX@Z  +
pop ecx  +
pop edi  +
push [ebp+arg_0]  +
call sub_102FE6A  +
pop esi  +
pop ebx  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 32Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
lea eax [ebp+VersionInformation] +
push eax  +
xor ebx ebx +
xor esi esi +
mov [ebp+VersionInformation.dwOSVersionInfoSize] 114h +
call ds:GetVersionExW  +
test eax eax +
jz loc_1030172  +
cmp [ebp+VersionInformation.dwPlatformId] 2 +
jnz loc_1030170  +
mov eax [ebp+VersionInformation.dwMajorVersion] +
cmp eax [ebp+arg_0] +
jz loc_103005B  +
jbe loc_1030170  +
xor esi esi +
inc esi  +
jmp loc_1030170  +
mov eax [ebp+VersionInformation.dwMinorVersion] +
cmp eax [ebp+arg_4] +
jnz loc_103004D  +
xor esi esi +
push edi  +
mov edi [ebp+arg_8] +
inc esi  +
cmp edi ebx +
jbe loc_103016F  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push ebx  +
push offset aSoftwareMicr_9  +
push 80000002h  +
mov [ebp+hKey] ebx +
mov [ebp+cbData] 208h +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_103010C  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+tstrFilename] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
push offset aCurrentbuildnu  +
push [ebp+hKey]  +
mov [ebp+Type] esi +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10300F4  +
cmp [ebp+Type] esi +
jnz loc_10300F4  +
lea eax [ebp+tstrFilename] +
push eax  +
call ds:_wtol  +
cmp eax edi +
sbb esi esi +
pop ecx  +
mov [ebp+cbData] eax +
inc esi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp [ebp+cbData] edi +
ja loc_103016F  +
cmp esi ebx +
jz loc_103016F  +
cmp [ebp+arg_C] ebx +
jz loc_103016F  +
mov edi 104h +
push edi  +
lea eax [ebp+tstrFilename] +
push eax  +
call ds:GetSystemDirectoryW  +
test eax eax +
jz loc_103016F  +
push offset aKernel32_dll  +
push edi  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_103016F  +
lea eax [ebp+Type] +
push eax  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+tstrFilename] +
push eax  +
mov [ebp+Type] ebx +
call sub_102EC42  +
test eax eax +
jl loc_103016F  +
movzx eax word ptr [ebp+Type] +
cmp eax [ebp+arg_C] +
sbb esi esi +
inc esi  +
pop edi  +
mov eax esi +
mov ecx [ebp+var_4] +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 10h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ebx  +
push esi  +
push edi  +
mov esi ecx +
mov ecx [ebp+arg_0] +
or [esi+108h] ecx +
mov eax [esi+108h] +
push 2  +
pop ebx  +
sub ecx ebx +
jz loc_103027C  +
sub ecx ebx +
jz loc_10301CF  +
sub ecx 4 +
jnz loc_1030297  +
mov eax dword ptr [ebp+arg_4] +
test eax eax +
jnz loc_10301C4  +
mov eax offset aUnknown +
push eax  +
push offset aRebootRequeste  +
jmp loc_103028E  +
xor edi edi +
cmp dword ptr [ebp+arg_4] edi +
jnz loc_10301E3  +
or eax ebx +
mov [esi+108h] eax +
jmp loc_1030297  +
cmp [esi+100h] edi +
jbe loc_103020F  +
mov eax [esi+edi*4] +
test eax eax +
jz loc_1030206  +
push dword ptr [ebp+arg_4]  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1030297  +
inc edi  +
cmp edi [esi+100h] +
jb loc_10301EB  +
mov eax dword ptr [ebp+arg_4] +
lea edx [eax+2] +
mov cx [eax] +
add eax ebx +
test cx cx +
jnz loc_1030215  +
sub eax edx +
sar eax 1 +
lea edi [eax+1] +
xor ecx ecx +
mov eax edi +
mov edx ebx +
mul  edx +
seto cl  +
neg ecx  +
or ecx eax +
push ecx  +
call ??_U@YAPAXI@Z  +
pop ecx  +
mov ecx [esi+100h] +
mov [esi+ecx*4] eax +
mov eax [esi+100h] +
cmp dword ptr [esi+eax*4] 0 +
jz loc_1030297  +
push dword ptr [ebp+arg_4]  +
push offset aRebootRequired  +
push ebx  +
call sub_1039F55  +
mov eax [esi+100h] +
add esp 0Ch +
push dword ptr [ebp+arg_4]  +
push edi  +
push dword ptr [esi+eax*4]  +
call sub_1027E68  +
inc dword ptr [esi+100h]  +
jmp loc_1030297  +
mov eax dword ptr [ebp+arg_4] +
test eax eax +
jnz loc_1030288  +
mov eax offset aUnknown +
push eax  +
push offset aRebootReques_0  +
push ebx  +
call sub_1039F55  +
add esp 0Ch +
pop edi  +
pop esi  +
pop ebx  +
pop ebp  +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 42Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
push esi  +
xor esi esi +
mov [ebp+var_42C] eax +
mov [ebp+hKey] esi +
mov [ebp+var_428] 1 +
cmp eax esi +
jnz loc_10302DF  +
xor eax eax +
jmp loc_1030532  +
push ebx  +
push edi  +
mov edi ds:RegCreateKeyExW +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 3  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMic_10  +
mov ebx 80000002h +
push ebx  +
call edi  +
test eax eax +
jz loc_103032D  +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 1  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMic_10  +
push ebx  +
mov [ebp+var_428] esi +
call edi  +
test eax eax +
jz loc_103032D  +
xor eax eax +
jmp loc_1030530  +
mov edi ds:RegQueryValueExW +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+szShortPath] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
mov ebx offset aInstallationDi +
push ebx  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
mov [ebp+Type] 1 +
call edi  +
cmp [ebp+Type] 2 +
mov [ebp+var_41C] eax +
jnz loc_10303B1  +
cmp eax esi +
jnz loc_10303C2  +
mov edi 104h +
push edi  +
lea eax [ebp+Buffer] +
push eax  +
lea eax [ebp+szShortPath] +
push eax  +
call ds:ExpandEnvironmentStringsW  +
lea eax [ebp+Buffer] +
push eax  +
push edi  +
lea eax [ebp+szShortPath] +
push eax  +
call sub_1027E68  +
jmp loc_10304EA  +
cmp [ebp+Type] 1 +
jnz loc_10303C2  +
cmp eax esi +
jz loc_10304E5  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+szShortPath] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMp2_savedir  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
call edi  +
xor ecx ecx +
cmp [ebp+Type] 1 +
mov [ebp+var_41C] eax +
mov [ebp+var_6] cx +
jnz loc_1030408  +
cmp eax esi +
jz loc_103046D  +
mov edi 104h +
push edi  +
lea eax [ebp+szShortPath] +
push eax  +
call sub_103BB43  +
test eax eax +
jnz loc_1030461  +
lea eax [ebp+szShortPath] +
push eax  +
call sub_102E61A  +
push edi  +
lea eax [ebp+Buffer] +
push eax  +
push 26FDh  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_1030461  +
lea eax [ebp+Buffer] +
push eax  +
push edi  +
lea eax [ebp+szShortPath] +
push eax  +
call sub_1027EDD  +
mov [ebp+var_41C] esi +
cmp [ebp+var_41C] esi +
jnz loc_1030519  +
cmp [ebp+var_428] esi +
jz loc_10304DD  +
lea eax [ebp+szShortPath] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_103047E  +
mov edi ds:RegSetValueExW +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+szShortPath] +
push eax  +
push 1  +
push esi  +
push ebx  +
push [ebp+hKey]  +
call edi  +
lea eax [ebp+szShortPath] +
lea ecx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx si +
jnz loc_10304B3  +
sub eax ecx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+szShortPath] +
push eax  +
push 1  +
push esi  +
push offset aInstallation_0  +
push [ebp+hKey]  +
call edi  +
cmp [ebp+var_41C] esi +
jnz loc_1030519  +
mov edi 104h +
xor eax eax +
mov [ebp+var_6] ax +
cmp [ebp+arg_4] esi +
jnz loc_1030504  +
push edi  +
lea eax [ebp+szShortPath] +
push eax  +
push eax  +
call ds:GetShortPathNameW  +
lea eax [ebp+szShortPath] +
push eax  +
push [ebp+arg_8]  +
push [ebp+var_42C]  +
call sub_1027E68  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
xor eax eax +
cmp [ebp+var_41C] esi +
setz al  +
pop edi  +
pop ebx  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 210h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
push ebx  +
xor ebx ebx +
mov [ebp+var_210] eax +
test eax eax +
jz loc_103060B  +
push esi  +
push edi  +
mov edi ds:GetSystemDirectoryW +
mov esi 104h +
push esi  +
lea eax [ebp+FileName] +
push eax  +
call edi  +
test eax eax +
jz loc_10305B2  +
push offset aWmploc_dll_0  +
push esi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_10305B2  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
mov ebx eax +
test ebx ebx +
jnz loc_10305E8  +
push esi  +
lea eax [ebp+FileName] +
push eax  +
call edi  +
test eax eax +
jz loc_1030607  +
push offset aMsdxm_ocx  +
push esi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_1030607  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
mov ebx eax +
test ebx ebx +
jz loc_1030607  +
lea eax [ebp+FileName] +
push eax  +
mov eax [ebp+arg_4] +
shr eax 1 +
push eax  +
push [ebp+var_210]  +
call sub_1027E68  +
xor ebx ebx +
test eax eax +
setnl bl  +
pop edi  +
mov eax ebx +
pop esi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 20Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push 208h  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_1030546  +
test eax eax +
jz loc_1030657  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102EF2C  +
jmp loc_103065B  +
xor eax eax +
xor edx edx +
mov ecx [ebp+var_4] +
xor ecx ebp +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push ecx  +
push esi  +
mov esi [ebp+arg_0] +
push edi  +
xor edi edi +
mov [ebp+var_8] edi +
mov [ebp+var_4] edi +
cmp esi edi +
jz loc_10306CB  +
push [ebp+arg_4]  +
push esi  +
call sub_1030546  +
test eax eax +
jz loc_10306CB  +
lea eax [ebp+var_4] +
push eax  +
lea eax [ebp+var_8] +
push eax  +
push esi  +
call sub_102EC42  +
test eax eax +
jl loc_10306CB  +
mov eax [ebp+var_4] +
movzx ecx ax +
push ecx  +
shr eax 10h +
push eax  +
mov eax [ebp+var_8] +
movzx ecx ax +
push ecx  +
shr eax 10h +
push eax  +
push offset aLu_Lu_Lu_Lu  +
push [ebp+arg_4]  +
inc edi  +
push esi  +
call sub_1027F64  +
add esp 1Ch +
mov eax edi +
pop edi  +
pop esi  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push ecx  +
push esi  +
xor esi esi +
mov [ebp+hKey] esi +
cmp dword ptr [ebp+lpData] esi +
jnz loc_10306F4  +
mov eax 80004003h +
jmp loc_10308BA  +
push 14h  +
pop eax  +
xor ecx ecx +
push 2  +
pop edx  +
mul  edx +
seto cl  +
neg ecx  +
or ecx eax +
push ecx  +
call ??_U@YAPAXI@Z  +
pop ecx  +
mov [ebp+lpValueName] eax +
cmp eax esi +
jnz loc_103071D  +
mov eax 8007000Eh +
jmp loc_10308BA  +
push ebx  +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push 2  +
push esi  +
push offset aSoftwareMic_52  +
push 80000001h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10307A1  +
push 208h  +
call ??_U@YAPAXI@Z  +
mov ebx eax +
pop ecx  +
cmp ebx esi +
jz loc_1030798  +
mov edi 104h +
push edi  +
push ebx  +
call sub_102FC69  +
test eax eax +
jz loc_1030791  +
push offset aFixups_0  +
push edi  +
push ebx  +
call sub_1027EDD  +
mov eax ebx +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_103076C  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ebx  +
push 1  +
push esi  +
push offset aMplayer2_fixup  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
push ebx  +
call ??_V@YAXPAX@Z  +
pop ecx  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 3  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMic_11  +
push 80000001h  +
call ds:RegCreateKeyExW  +
mov edi eax +
cmp edi esi +
jnz loc_103085E  +
push dword_10411B8  +
mov ebx offset aLu +
push ebx  +
push 14h  +
push [ebp+lpValueName]  +
call sub_1027F64  +
mov edi ds:RegQueryValueExW +
jmp loc_1030807  +
cmp dword_10411B8 3E8h +
jge loc_103081A  +
inc dword_10411B8  +
push dword_10411B8  +
push ebx  +
push 14h  +
push [ebp+lpValueName]  +
call sub_1027F64  +
add esp 10h +
push esi  +
push esi  +
push esi  +
push esi  +
push [ebp+lpValueName]  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jz loc_10307E4  +
mov eax dword ptr [ebp+lpData] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1030820  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push dword ptr [ebp+lpData]  +
push 2  +
push esi  +
push [ebp+lpValueName]  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
mov edi eax +
cmp edi esi +
jnz loc_1030851  +
inc dword_10411B8  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp edi esi +
jz loc_1030881  +
jle loc_103086C  +
and edi 0FFFFh +
or edi 80070000h +
push edi  +
push dword ptr [ebp+lpData]  +
push offset aErrorCouldNo_0  +
push 2  +
call sub_1039F55  +
add esp 10h +
jmp loc_10308AD  +
push dword ptr [ebp+lpData]  +
push offset aFileReplacemen  +
push 4  +
call sub_1039F55  +
add esp 0Ch +
cmp [ebp+arg_8] esi +
jz loc_10308A8  +
push esi  +
push dword ptr [ebp+lpData]  +
mov ecx offset unk_10411C0 +
push 8  +
call sub_1030187  +
mov edi 0D2AF9h +
push [ebp+lpValueName]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov eax edi +
pop edi  +
pop ebx  +
pop esi  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 110h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
lea eax [ebp+pidl] +
push eax  +
xor ebx ebx +
push 23h  +
push ebx  +
mov [ebp+pidl] ebx +
mov [ebp+ppMalloc] ebx +
xor esi esi +
call ds:SHGetSpecialFolderLocation  +
test eax eax +
jl loc_1030993  +
lea eax [ebp+PathName] +
push eax  +
push [ebp+pidl]  +
call ds:SHGetPathFromIDListA  +
test eax eax +
jz loc_103091B  +
inc esi  +
lea eax [ebp+ppMalloc] +
push eax  +
call ds:SHGetMalloc  +
test eax eax +
jl loc_1030942  +
mov eax [ebp+ppMalloc] +
cmp eax ebx +
jz loc_1030942  +
push [ebp+pidl]  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+14h]  +
cmp esi ebx +
jz loc_1030993  +
lea esi [ebp+PathName] +
mov eax esi +
push eax  +
call sub_102FDF6  +
test eax eax +
jnz loc_1030993  +
push edi  +
mov edi ds:CreateDirectoryA +
cmp [ebp+PathName] bl +
jz loc_1030988  +
cmp byte ptr [esi] 5Ch +
jnz loc_103097B  +
push ebx  +
lea eax [ebp+PathName] +
push eax  +
mov [esi] bl +
call edi  +
mov byte ptr [esi] 5Ch +
push esi  +
call ds:CharNextA  +
mov esi eax +
cmp [esi] bl +
jnz loc_1030967  +
push ebx  +
lea eax [ebp+PathName] +
push eax  +
call edi  +
pop edi  +
mov eax [ebp+ppMalloc] +
cmp eax ebx +
jz loc_10309A3  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
mov ecx [ebp+var_4] +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 210h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
mov esi [ebp+arg_0] +
push edi  +
xor edi edi +
cmp esi edi +
jz loc_1030A09  +
push 105h  +
lea eax [ebp+tstrFilename] +
push eax  +
push edi  +
call ds:GetModuleFileNameW  +
test eax eax +
jz loc_1030A09  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102EF2C  +
push [ebp+arg_4]  +
push esi  +
push edx  +
push eax  +
call sub_102FDA1  +
test eax eax +
jl loc_1030A09  +
inc edi  +
mov ecx [ebp+var_4] +
mov eax edi +
pop edi  +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 424h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_10] +
push esi  +
mov esi [ebp+lpFileName] +
push edi  +
mov edi [ebp+arg_4] +
mov dword ptr [ebp+lpExistingFileName] esi +
mov dword ptr [ebp+lpNewFileName] edi +
mov [ebp+var_424] eax +
test esi esi +
jnz loc_1030A60  +
mov eax 80004003h +
jmp loc_1030E2C  +
test edi edi +
jnz loc_1030A6F  +
test eax eax +
jnz loc_1030A6F  +
push esi  +
call ds:DeleteFileW  +
push esi  +
call sub_102E8B9  +
test eax eax +
jnz loc_1030A89  +
mov eax edi +
neg eax  +
sbb eax eax +
and eax 80070002h +
jmp loc_1030E2C  +
push ebx  +
mov ebx 208h +
test edi edi +
jz loc_1030BA3  +
cmp [ebp+arg_C] 0 +
jz loc_1030AAF  +
lea eax [ebp+var_420] +
push eax  +
push edi  +
call sub_102E8E6  +
call sub_102F14F  +
cmp [ebp+arg_8] 0 +
jz loc_1030BA3  +
push ebx  +
call ??_U@YAPAXI@Z  +
mov edi eax +
pop ecx  +
test edi edi +
jnz loc_1030AD0  +
mov eax 8007000Eh +
jmp loc_1030E2B  +
mov esi 104h +
push esi  +
push edi  +
push dword ptr [ebp+lpNewFileName]  +
call sub_102FCC4  +
push edi  +
call sub_102E61A  +
cmp [ebp+var_424] 0 +
jz loc_1030B0F  +
push [ebp+var_424]  +
lea eax [ebp+FileName] +
push edi  +
push offset aSS_0  +
push esi  +
push eax  +
call sub_1027F64  +
add esp 14h +
jmp loc_1030B41  +
push dword_10412D0  +
lea eax [ebp+FileName] +
push edi  +
push offset aSsetbLu_tmp  +
push esi  +
push eax  +
call sub_1027F64  +
add esp 14h +
inc dword_10412D0  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jnz loc_1030B0F  +
push edi  +
call ??_V@YAXPAX@Z  +
pop ecx  +
push 1  +
lea eax [ebp+FileName] +
push eax  +
push dword ptr [ebp+lpExistingFileName]  +
call ds:CopyFileW  +
test eax eax +
jnz loc_1030BB8  +
call ds:GetLastError  +
test eax eax +
jnz loc_1030B70  +
push 57h  +
pop eax  +
test eax eax +
jle loc_1030B7C  +
and eax 0FFFFh +
or eax 80070000h +
push eax  +
lea eax [ebp+FileName] +
push eax  +
push dword ptr [ebp+lpExistingFileName]  +
push offset aErrorReplacefi  +
push 0  +
call sub_1039F55  +
add esp 14h +
mov eax 80004005h +
jmp loc_1030E2B  +
push esi  +
mov esi 104h +
push esi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027E68  +
jmp loc_1030BBE  +
mov edi dword ptr [ebp+lpNewFileName] +
push ebx  +
call ??_U@YAPAXI@Z  +
pop ecx  +
mov dword ptr [ebp+var_420] eax +
mov ebx offset unk_10411C0 +
test eax eax +
jz loc_1030D73  +
and dword ptr [ebp+lpExistingFileName] 0 +
push eax  +
push esi  +
mov edi 80004005h +
call ds:GetTempPathW  +
test eax eax +
jz loc_1030D51  +
push dword ptr [ebp+var_420]  +
call sub_102FEDE  +
push dword ptr [ebp+var_420]  +
call sub_102E61A  +
and dword_10412D0 0 +
cmp [ebp+var_424] 0 +
jz loc_1030C3D  +
push [ebp+var_424]  +
lea eax [ebp+lpData] +
push dword ptr [ebp+var_420]  +
push offset aSS_0  +
push esi  +
push eax  +
call sub_1027F64  +
add esp 14h +
jmp loc_1030C74  +
push dword_10412D0  +
lea eax [ebp+lpData] +
push dword ptr [ebp+var_420]  +
push offset aSsetbLu_tmp  +
push esi  +
push eax  +
call sub_1027F64  +
add esp 14h +
inc dword_10412D0  +
lea eax [ebp+lpData] +
push eax  +
call sub_102E8B9  +
test eax eax +
jnz loc_1030C3D  +
xor esi esi +
lea eax [ebp+lpData] +
push eax  +
cmp dword ptr [ebp+lpNewFileName] esi +
jz loc_1030CF2  +
push dword ptr [ebp+lpNewFileName]  +
mov esi ds:MoveFileW +
call esi  +
test eax eax +
jz loc_1030D51  +
push dword ptr [ebp+lpNewFileName]  +
call sub_102E8B9  +
test eax eax +
jz loc_1030CBF  +
push dword ptr [ebp+lpNewFileName]  +
push offset aErrorReplaceFi  +
push 1  +
call sub_1039F55  +
add esp 0Ch +
push dword ptr [ebp+lpNewFileName]  +
lea eax [ebp+FileName] +
push eax  +
call esi  +
push 0  +
mov dword ptr [ebp+lpExistingFileName] eax +
push 0  +
lea eax [ebp+lpData] +
push eax  +
call sub_10306D8  +
mov edi eax +
cmp edi 0D2AF9h +
jnz loc_1030D51  +
push 0  +
jmp loc_1030D3C  +
lea eax [ebp+FileName] +
push eax  +
call ds:MoveFileW  +
test eax eax +
jz loc_1030D51  +
lea eax [ebp+FileName] +
push eax  +
push offset aMovedFileSToTe  +
push 4  +
call sub_1039F55  +
add esp 0Ch +
push esi  +
push esi  +
lea eax [ebp+lpData] +
push eax  +
mov dword ptr [ebp+lpExistingFileName] 1 +
call sub_10306D8  +
mov edi eax +
cmp edi 0D2AF9h +
jnz loc_1030D51  +
push esi  +
lea eax [ebp+lpData] +
push eax  +
push 2  +
mov ecx ebx +
mov edi 0D2AF8h +
call sub_1030187  +
push dword ptr [ebp+var_420]  +
call ??_V@YAXPAX@Z  +
cmp dword ptr [ebp+lpExistingFileName] 0 +
pop ecx  +
jz loc_1030D6D  +
mov eax edi +
jmp loc_1030E2B  +
mov edi dword ptr [ebp+lpNewFileName] +
push 5  +
push edi  +
lea eax [ebp+FileName] +
push eax  +
call ds:MoveFileExW  +
test eax eax +
jz loc_1030DEC  +
test edi edi +
jz loc_1030DA7  +
push 5Ch  +
push edi  +
call sub_102E672  +
test eax eax +
jz loc_1030DA7  +
push edi  +
push offset aErrorBadFileDe  +
push 2  +
call sub_1039F55  +
add esp 0Ch +
lea eax [ebp+FileName] +
push eax  +
push offset aWarningRebootR  +
push 2  +
call sub_1039F55  +
add esp 0Ch +
cmp [ebp+arg_14] 0 +
lea eax [ebp+FileName] +
mov ecx ebx +
jz loc_1030DDB  +
push edi  +
push eax  +
push 8  +
call sub_1030187  +
mov eax 0D2AF9h +
jmp loc_1030E2B  +
push 0  +
push eax  +
push 2  +
call sub_1030187  +
mov eax 0D2AF8h +
jmp loc_1030E2B  +
call ds:GetLastError  +
test eax eax +
jnz loc_1030DFB  +
push 57h  +
pop eax  +
test eax eax +
jle loc_1030E07  +
and eax 0FFFFh +
or eax 80070000h +
mov esi eax +
test esi esi +
jl loc_1030E12  +
mov esi 80004005h +
push esi  +
lea eax [ebp+FileName] +
push eax  +
push offset aErrorMovefilee  +
push 2  +
call sub_1039F55  +
add esp 10h +
mov eax esi +
pop ebx  +
mov ecx [ebp+var_4] +
pop edi  +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 18h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 414h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push edi  +
mov edi [ebp+arg_0] +
test edi edi +
jz loc_1030F15  +
push esi  +
mov esi 104h +
push esi  +
lea eax [ebp+lpFileName] +
push eax  +
call ds:GetSystemDirectoryW  +
test eax eax +
jz loc_1030F04  +
push edi  +
push esi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027E68  +
push offset aDllcache  +
push esi  +
lea eax [ebp+lpFileName] +
push eax  +
call sub_1027EDD  +
lea eax [ebp+FileName] +
push 5Ch  +
push eax  +
call ds:wcsrchr  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1030F04  +
push eax  +
push esi  +
lea eax [ebp+lpFileName] +
push eax  +
call sub_1027EDD  +
lea eax [ebp+lpFileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_1030F04  +
xor esi esi +
inc esi  +
push esi  +
push esi  +
lea eax [ebp+lpFileName] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
call sub_102F1BE  +
test eax eax +
jnz loc_1030F04  +
push eax  +
push eax  +
push esi  +
push esi  +
lea eax [ebp+lpFileName] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
call sub_1030A20  +
push edi  +
push offset aCopiedFileSToD  +
push 4  +
call sub_1039F55  +
add esp 0Ch +
pop esi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 430h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov ecx [ebp+arg_C] +
mov eax [ebp+arg_0] +
mov [ebp+var_424] ecx +
mov ecx [ebp+arg_10] +
mov [ebp+var_41C] ecx +
mov ecx [ebp+arg_1C] +
push ebx  +
mov ebx [ebp+arg_4] +
mov [ebp+var_430] ecx +
push esi  +
xor ecx ecx +
push edi  +
mov edi [ebp+arg_8] +
cmp eax ecx +
jz loc_10312D3  +
cmp edi ecx +
jz loc_10312D3  +
push eax  +
mov esi 103h +
push esi  +
lea eax [ebp+FileName] +
push eax  +
mov [ebp+var_418] ecx +
mov [ebp+var_420] ecx +
mov [ebp+var_428] ecx +
mov [ebp+var_42C] ecx +
call sub_1027E68  +
push edi  +
push esi  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_1027E68  +
xor edi edi +
inc esi  +
cmp ebx edi +
jz loc_1030FD1  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E61A  +
push ebx  +
push esi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
cmp [ebp+var_424] edi +
jz loc_103102B  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102E61A  +
push [ebp+var_424]  +
lea eax [ebp+tstrFilename] +
push esi  +
push eax  +
call sub_1027EDD  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jnz loc_103102B  +
cmp ebx edi +
jnz loc_103102B  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E61A  +
push [ebp+var_424]  +
lea eax [ebp+FileName] +
push esi  +
push eax  +
call sub_1027EDD  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jnz loc_1031070  +
call ds:GetLastError  +
cmp eax edi +
jle loc_103104F  +
and eax 0FFFFh +
or eax 80070000h +
push eax  +
lea eax [ebp+FileName] +
push eax  +
push offset aErrorWmc_copyf  +
push 2  +
call sub_1039F55  +
add esp 10h +
mov eax 80070002h +
jmp loc_10312D8  +
mov ebx [ebp+arg_14] +
test ebx 400h +
jz loc_10310A9  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102E8B9  +
test eax eax +
jnz loc_10310A9  +
lea eax [ebp+FileName] +
push eax  +
push offset aWmc_copyfileFi  +
push 4  +
call sub_1039F55  +
xor eax eax +
add esp 0Ch +
inc eax  +
jmp loc_10312D8  +
test bl 10h +
jz loc_10310CC  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_10310CC  +
lea eax [ebp+FileName] +
push eax  +
push offset aWmc_copyfile_0  +
jmp loc_1031097  +
test bl 4 +
jz loc_103115E  +
lea eax [ebp+FileName] +
push eax  +
push offset aWmc_copyfile_1  +
push 4  +
call sub_1039F55  +
add esp 0Ch +
cmp [ebp+arg_18] edi +
jz loc_10310FC  +
lea eax [ebp+FileName] +
push eax  +
call sub_1030E41  +
xor ebx 8 +
jz loc_1031123  +
push edi  +
push [ebp+arg_18]  +
lea eax [ebp+tstrFilename] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
call sub_102F1BE  +
test eax eax +
jz loc_1031123  +
xor eax eax +
jmp loc_10312D8  +
lea eax [ebp+tstrFilename] +
push eax  +
push offset aWmc_copyfileCo  +
push 2  +
call sub_1039F55  +
add esp 0Ch +
push 1  +
push [ebp+var_41C]  +
lea eax [ebp+tstrFilename] +
push [ebp+arg_18]  +
push 1  +
push eax  +
lea eax [ebp+FileName] +
push eax  +
call sub_1030A20  +
jmp loc_10312D8  +
lea eax [ebp+var_418] +
push eax  +
lea eax [ebp+var_420] +
push eax  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_102EC42  +
test eax eax +
jz loc_103118D  +
lea eax [ebp+tstrFilename] +
push eax  +
push offset aWmc_copyfile_2  +
jmp loc_10310E1  +
lea eax [ebp+var_428] +
push eax  +
lea eax [ebp+var_42C] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
call sub_102EC42  +
test eax eax +
jz loc_10311BC  +
lea eax [ebp+FileName] +
push eax  +
push offset aErrorWmc_cop_0  +
jmp loc_1031097  +
mov eax [ebp+var_42C] +
shr eax 10h +
cdq   +
shld edx eax +
shl eax 10h +
mov ecx eax +
movzx eax word ptr [ebp+var_42C] +
mov esi edx +
cdq   +
or ecx eax +
mov eax [ebp+var_428] +
or esi edx +
shr eax 10h +
shld esi ecx +
cdq   +
or esi edx +
mov edi esi +
shl ecx 10h +
or ecx eax +
movzx eax word ptr [ebp+var_428] +
cdq   +
shld edi ecx +
shl ecx 10h +
or ecx eax +
mov eax [ebp+var_420] +
shr eax 10h +
or edi edx +
cdq   +
shld edx eax +
shl eax 10h +
mov esi eax +
movzx eax word ptr [ebp+var_420] +
mov ebx edx +
cdq   +
or esi eax +
mov eax [ebp+var_418] +
or ebx edx +
shld ebx esi +
shr eax 10h +
shl esi 10h +
cdq   +
or esi eax +
movzx eax word ptr [ebp+var_418] +
or ebx edx +
shld ebx esi +
cdq   +
shl esi 10h +
or esi eax +
or ebx edx +
cmp esi ecx +
jnz loc_103125D  +
cmp edi ebx +
jnz loc_103125F  +
xor eax eax +
inc eax  +
jmp loc_103126E  +
cmp edi ebx +
jb loc_103126B  +
ja loc_1031267  +
cmp ecx esi +
jbe loc_103126B  +
xor eax eax +
jmp loc_103126E  +
push 2  +
pop eax  +
mov ecx [ebp+var_430] +
test ecx ecx +
jz loc_103127A  +
mov [ecx] eax +
test eax eax +
jz loc_103129A  +
test byte ptr [ebp+arg_14] 40h +
jnz loc_1031289  +
cmp eax 1 +
jz loc_103129A  +
lea eax [ebp+tstrFilename] +
push eax  +
push offset aWmc_copyfile_3  +
jmp loc_1031097  +
lea eax [ebp+FileName] +
push eax  +
push offset aWmc_copyfile_4  +
push 4  +
call sub_1039F55  +
add esp 0Ch +
cmp [ebp+arg_18] 0 +
jz loc_10312C2  +
lea eax [ebp+FileName] +
push eax  +
call sub_1030E41  +
test byte ptr [ebp+arg_14] 8 +
jnz loc_1031123  +
push 0  +
jmp loc_1031102  +
mov eax 80004003h +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 20h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov eax [ebp+arg_C] +
push 0  +
push [ebp+arg_10]  +
neg eax  +
sbb eax eax +
and eax 0FFFFFFC0h +
add eax 40h +
push eax  +
push 0  +
push [ebp+arg_8]  +
push [ebp+arg_4]  +
push [ebp+arg_8]  +
push [ebp+arg_0]  +
call sub_1030F29  +
pop ebp  +
retn 14h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push [ebp+arg_0]  +
add ecx 8 +
push ecx  +
call sub_102FD0E  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 10h +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push 1  +
xor esi esi +
push esi  +
push offset aSoftwareClient  +
push 80000002h  +
mov [ebp+hKey] esi +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10313B5  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aIconsvisible  +
push [ebp+hKey]  +
mov dword ptr [ebp+Data] esi +
mov [ebp+Type] 3 +
mov [ebp+cbData] 4 +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10313AC  +
cmp [ebp+Type] 4 +
jz loc_10313A1  +
cmp [ebp+Type] 3 +
jnz loc_10313AC  +
xor eax eax +
cmp dword ptr [ebp+Data] 1 +
setnz al  +
mov esi eax +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov eax esi +
pop esi  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov eax [ebp+arg_0] +
test eax eax +
jz loc_10313D7  +
xor ecx ecx +
cmp cx [eax] +
jz loc_10313D7  +
xor eax eax +
inc eax  +
jmp loc_10313D9  +
xor eax eax +
pop ebp  +
retn 4  +
***
mov edi edi +
push esi  +
xor esi esi +
call sub_103133C  +
test eax eax +
jnz loc_103140A  +
call sub_103BAF0  +
test eax eax +
jnz loc_103140A  +
push 1  +
push offset aShellexhandler  +
call sub_102F07A  +
test eax eax +
jz loc_103140A  +
inc esi  +
mov eax esi +
pop esi  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 1Ch +
or eax 0FFFFFFFFh +
push ebx  +
mov dword ptr [ebp+Data] eax +
mov [ebp+var_10] eax +
mov [ebp+var_18] eax +
mov [ebp+var_C] eax +
mov [ebp+var_14] eax +
mov [ebp+var_1C] eax +
lea eax [ebp+Data] +
push eax  +
xor ebx ebx +
push offset aMsmpeg2vdecMpe  +
mov [ebp+hKey] ebx +
call SLGetWindowsInformationDWORD  +
lea eax [ebp+var_C] +
push eax  +
push offset aMsmpeg2adecDol  +
call SLGetWindowsInformationDWORD  +
lea eax [ebp+var_10] +
push eax  +
push offset aMsmpeg2vdecM_0  +
call SLGetWindowsInformationDWORD  +
lea eax [ebp+var_18] +
push eax  +
push offset aMsmpeg2vdecM_1  +
call SLGetWindowsInformationDWORD  +
lea eax [ebp+var_14] +
push eax  +
push offset aMsmpeg2adecD_0  +
call SLGetWindowsInformationDWORD  +
lea eax [ebp+var_1C] +
push eax  +
push offset aMsmpeg2adecD_1  +
call SLGetWindowsInformationDWORD  +
push ebx  +
lea eax [ebp+hKey] +
push eax  +
push ebx  +
push 3  +
push ebx  +
push ebx  +
push ebx  +
push offset aSoftwareMicr_0  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1031525  +
push esi  +
mov esi ds:RegSetValueExW +
push edi  +
push 4  +
pop edi  +
push edi  +
lea eax [ebp+Data] +
push eax  +
push edi  +
push ebx  +
push offset aMpeg2in  +
push [ebp+hKey]  +
call esi  +
push edi  +
lea eax [ebp+var_10] +
push eax  +
push edi  +
push ebx  +
push offset aMpeg2addin  +
push [ebp+hKey]  +
call esi  +
push edi  +
lea eax [ebp+var_18] +
push eax  +
push edi  +
push ebx  +
push offset aMpeg2addinenab  +
push [ebp+hKey]  +
call esi  +
push edi  +
lea eax [ebp+var_C] +
push eax  +
push edi  +
push ebx  +
push offset aDolbyin  +
push [ebp+hKey]  +
call esi  +
push edi  +
lea eax [ebp+var_14] +
push eax  +
push edi  +
push ebx  +
push offset aDolbyaddin  +
push [ebp+hKey]  +
call esi  +
push edi  +
lea eax [ebp+var_1C] +
push eax  +
push edi  +
push ebx  +
push offset aDolbyaddinenab  +
push [ebp+hKey]  +
call esi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
pop esi  +
cmp dword ptr [ebp+Data] ebx +
jz loc_103152F  +
cmp [ebp+var_C] ebx +
jnz loc_1031543  +
cmp [ebp+var_10] ebx +
jz loc_1031548  +
cmp [ebp+var_14] ebx +
jz loc_1031548  +
cmp [ebp+var_18] ebx +
jz loc_1031548  +
cmp [ebp+var_1C] ebx +
jz loc_1031548  +
xor eax eax +
inc eax  +
jmp loc_103154A  +
xor eax eax +
pop ebx  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
push off_103F000  +
mov esi ds:wcsstr +
push [ebp+arg_0]  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1031591  +
push off_103F004  +
push [ebp+arg_0]  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1031591  +
push off_103F008  +
push [ebp+arg_0]  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1031594  +
xor eax eax +
inc eax  +
pop esi  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push [ebp+arg_0]  +
call sub_1031552  +
test eax eax +
jnz loc_10315C4  +
push off_103F010  +
push [ebp+arg_0]  +
call ds:wcsstr  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_10315C7  +
xor eax eax +
inc eax  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push off_103F00C  +
push [ebp+arg_0]  +
call ds:wcsstr  +
neg eax  +
pop ecx  +
sbb eax eax +
pop ecx  +
neg eax  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push offset aIexplore_exe  +
push [ebp+arg_0]  +
call ds:wcsstr  +
neg eax  +
pop ecx  +
sbb eax eax +
pop ecx  +
neg eax  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
push edi  +
mov edi [ebp+arg_0] +
push edi  +
call sub_1031552  +
test eax eax +
jnz loc_10316BF  +
push edi  +
call sub_103159E  +
test eax eax +
jnz loc_10316BF  +
push edi  +
call sub_10315D0  +
test eax eax +
jnz loc_10316BF  +
mov esi ds:wcsstr +
push offset aMplay32_exe  +
push edi  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10316BF  +
push offset aMplayer_exe  +
push edi  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10316BF  +
push offset aSndrec32_exe  +
push edi  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10316BF  +
push offset aSoundrec_exe  +
push edi  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10316BF  +
push offset aCdplayer_exe  +
push edi  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10316BF  +
push offset aDeluxecd_exe  +
push edi  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10316BF  +
push offset aDvdplay_exe  +
push edi  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10316BF  +
push offset aIexplore_exe  +
push edi  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_10316C2  +
xor eax eax +
inc eax  +
pop edi  +
pop esi  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push edi  +
mov edi [ebp+arg_0] +
test edi edi +
jz loc_1031723  +
push esi  +
mov esi ds:_wcsicmp +
push edi  +
push offset a_wmd  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103171E  +
push edi  +
push offset a_wms  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103171E  +
push edi  +
push offset a_cda  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103171E  +
push edi  +
push offset a_wmz  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103171E  +
xor eax eax +
inc eax  +
jmp loc_1031720  +
xor eax eax +
pop esi  +
jmp loc_1031725  +
xor eax eax +
pop edi  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push edi  +
xor edi edi +
cmp [ebp+arg_0] edi +
jz loc_10317AC  +
cmp [ebp+arg_4] edi +
jz loc_10317AC  +
push ebx  +
push esi  +
mov esi ds:wcsrchr +
push 5Ch  +
push [ebp+arg_0]  +
call esi  +
push 5Ch  +
push [ebp+arg_4]  +
mov ebx eax +
call esi  +
add esp 10h +
cmp ebx edi +
jz loc_10317A6  +
cmp eax edi +
jz loc_10317A6  +
push eax  +
push ebx  +
call ds:_wcsicmp  +
mov edi eax +
neg edi  +
sbb edi edi +
inc edi  +
pop ecx  +
pop ecx  +
jz loc_10317A6  +
mov edi ds:wcsstr +
mov ebx offset a86 +
push ebx  +
push [ebp+arg_0]  +
call edi  +
mov esi eax +
neg esi  +
push ebx  +
push [ebp+arg_4]  +
sbb esi esi +
inc esi  +
call edi  +
add esp 10h +
neg eax  +
sbb eax eax +
xor ecx ecx +
inc eax  +
cmp esi eax +
setz cl  +
mov edi ecx +
pop esi  +
mov eax edi +
pop ebx  +
jmp loc_10317AE  +
xor eax eax +
pop edi  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 260h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov ecx [ebp+lpSubKey] +
push ebx  +
push esi  +
mov esi ds:RegOpenKeyExW +
xor eax eax +
inc eax  +
push edi  +
mov [ebp+Type] eax +
mov [ebp+var_25C] eax +
mov [ebp+var_260] eax +
lea eax [ebp+hKey] +
push eax  +
xor edi edi +
mov ebx 2001Fh +
push ebx  +
push edi  +
push ecx  +
push 80000000h  +
mov [ebp+hKey] edi +
mov [ebp+cbData] edi +
call esi  +
test eax eax +
jnz loc_1031D7E  +
lea eax [ebp+phkResult] +
push eax  +
push ebx  +
push edi  +
push offset aShellPlayComma  +
push [ebp+hKey]  +
mov [ebp+phkResult] edi +
call esi  +
mov ebx ds:RegDeleteValueW +
mov esi offset aMplayer2_bak +
test eax eax +
jnz loc_1031984  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push edi  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103196C  +
cmp [ebp+Type] 1 +
jz loc_1031894  +
cmp [ebp+Type] 2 +
jnz loc_103196C  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_103196C  +
lea eax [ebp+Data] +
push eax  +
call ds:_wcslwr  +
pop ecx  +
lea eax [ebp+Data] +
push eax  +
call sub_1031552  +
test eax eax +
jnz loc_10318E1  +
push [ebp+phkResult]  +
mov esi ds:RegCloseKey +
call esi  +
push [ebp+hKey]  +
call esi  +
jmp loc_1031D7E  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push esi  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1031966  +
cmp [ebp+Type] 1 +
jz loc_1031924  +
cmp [ebp+Type] 2 +
jnz loc_1031966  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103192D  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push [ebp+Type]  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push esi  +
push [ebp+phkResult]  +
call ebx  +
jmp loc_103196C  +
mov [ebp+var_25C] edi +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
cmp [ebp+var_25C] edi +
jz loc_1031AD9  +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push edi  +
push offset aShellPlay  +
push [ebp+hKey]  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1031AE9  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push offset aMuiverb  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1031A35  +
cmp [ebp+Type] 1 +
jz loc_10319F1  +
cmp [ebp+Type] 2 +
jnz loc_1031A35  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1031A35  +
lea eax [ebp+Data] +
push eax  +
call ds:_wcslwr  +
lea eax [ebp+Data] +
mov [esp+270h+var_270] offset aUnregmp2_exe +
push eax  +
call ds:wcsstr  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1031A35  +
push offset aMuiverb  +
push [ebp+phkResult]  +
call ebx  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push esi  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1031AC2  +
cmp [ebp+Type] 1 +
jz loc_1031A78  +
cmp [ebp+Type] 2 +
jnz loc_1031AC2  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1031AC2  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1031A91  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push [ebp+Type]  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push esi  +
jmp loc_1031AC3  +
push edi  +
push [ebp+phkResult]  +
call ebx  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
jmp loc_1031AE9  +
push offset aShellPlay  +
push [ebp+hKey]  +
call sub_102F8CE  +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push edi  +
push offset aShell  +
push [ebp+hKey]  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1031C27  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push edi  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1031B7E  +
cmp [ebp+Type] 1 +
jnz loc_1031B7E  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1031B7E  +
lea eax [ebp+Data] +
push offset aPlay  +
push eax  +
call ds:_wcsicmp  +
neg eax  +
sbb eax eax +
pop ecx  +
inc eax  +
pop ecx  +
mov [ebp+var_260] eax +
jz loc_1031C0F  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push esi  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1031BFE  +
cmp [ebp+Type] 1 +
jnz loc_1031BFE  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1031BFE  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1031BD1  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push esi  +
jmp loc_1031C07  +
cmp [ebp+var_25C] edi +
jnz loc_1031C0F  +
push edi  +
push [ebp+phkResult]  +
call ebx  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
cmp [ebp+var_260] edi +
jz loc_1031D72  +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push edi  +
push offset aDefaulticon  +
push [ebp+hKey]  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1031CEC  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push esi  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1031CE0  +
cmp [ebp+Type] 1 +
jz loc_1031C90  +
cmp [ebp+Type] 2 +
jnz loc_1031CE0  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1031CE0  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1031CA9  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push [ebp+Type]  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push esi  +
push [ebp+phkResult]  +
call ebx  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push esi  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1031D72  +
cmp [ebp+Type] 1 +
jnz loc_1031D72  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1031D72  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1031D3F  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
push esi  +
push [ebp+hKey]  +
call ebx  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push edi  +
xor edi edi +
mov [ebp+hKey] edi +
cmp [ebp+phkResult] edi +
jz loc_1031E1D  +
push esi  +
mov esi ds:RegOpenKeyExW +
lea eax [ebp+hKey] +
push eax  +
push 2001Fh  +
push edi  +
push [ebp+phkResult]  +
push 80000000h  +
call esi  +
test eax eax +
jnz loc_1031E1C  +
lea eax [ebp+phkResult] +
push eax  +
push 20006h  +
push edi  +
push offset aShellEnqueue  +
push [ebp+hKey]  +
mov [ebp+phkResult] edi +
call esi  +
mov esi ds:RegCloseKey +
test eax eax +
jnz loc_1031E17  +
cmp [ebp+arg_4] edi +
jz loc_1031E04  +
push 2  +
push offset byte_1002720  +
push 1  +
push edi  +
push offset aLegacydisable  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
jmp loc_1031E12  +
push offset aLegacydisable  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
push [ebp+phkResult]  +
call esi  +
push [ebp+hKey]  +
call esi  +
pop esi  +
pop edi  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
push esi  +
xor esi esi +
mov [ebp+hKey] esi +
call sub_1031413  +
test eax eax +
lea eax [ebp+hKey] +
jz loc_1031E75  +
push esi  +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMic_12  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1031EA4  +
push 2  +
push offset byte_1002720  +
push 1  +
push esi  +
push offset aMsplaydvdmovie  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
jmp loc_1031E9B  +
push eax  +
push 3  +
push esi  +
push offset aSoftwareMic_12  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1031EA4  +
push offset aMsplaydvdmovie  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop esi  +
leave   +
retn   +
***
mov eax ecx +
xor ecx ecx +
mov [eax] ecx +
mov [eax+4] ecx +
mov [eax+8] ecx +
mov [eax+0Ch] ecx +
mov [eax+10h] ecx +
mov [eax+14h] ecx +
mov [eax+18h] ecx +
mov [eax+1Ch] ecx +
retn   +
***
mov edi edi +
push esi  +
mov esi ecx +
mov eax [esi] +
push edi  +
xor edi edi +
cmp eax edi +
jz loc_1031EE4  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi] edi +
mov eax [esi+4] +
cmp eax edi +
jz loc_1031EF5  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+4] edi +
mov eax [esi+8] +
cmp eax edi +
jz loc_1031F06  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+8] edi +
mov eax [esi+0Ch] +
cmp eax edi +
jz loc_1031F17  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+0Ch] edi +
mov eax [esi+10h] +
cmp eax edi +
jz loc_1031F28  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+10h] edi +
mov eax [esi+14h] +
cmp eax edi +
jz loc_1031F39  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+14h] edi +
mov eax [esi+18h] +
cmp eax edi +
jz loc_1031F4A  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+18h] edi +
mov eax [esi+1Ch] +
cmp eax edi +
jz loc_1031F5B  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+1Ch] edi +
pop edi  +
pop esi  +
retn   +
***
mov eax ecx +
xor ecx ecx +
mov [eax] ecx +
mov [eax+4] ecx +
mov [eax+8] ecx +
mov [eax+0Ch] ecx +
mov [eax+10h] ecx +
mov [eax+14h] ecx +
mov [eax+18h] ecx +
mov [eax+1Ch] ecx +
mov [eax+20h] ecx +
mov [eax+34h] ecx +
mov [eax+38h] ecx +
mov [eax+24h] ecx +
mov [eax+28h] ecx +
mov [eax+2Ch] ecx +
mov [eax+30h] ecx +
retn   +
***
mov edi edi +
push esi  +
mov esi ecx +
mov eax [esi] +
push edi  +
xor edi edi +
cmp eax edi +
jz loc_1031FB0  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi] edi +
mov eax [esi+4] +
cmp eax edi +
jz loc_1031FC1  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+4] edi +
mov eax [esi+8] +
cmp eax edi +
jz loc_1031FD2  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+8] edi +
mov eax [esi+0Ch] +
cmp eax edi +
jz loc_1031FE3  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+0Ch] edi +
mov eax [esi+10h] +
cmp eax edi +
jz loc_1031FF4  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+10h] edi +
mov eax [esi+14h] +
cmp eax edi +
jz loc_1032005  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+14h] edi +
mov eax [esi+18h] +
cmp eax edi +
jz loc_1032016  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+18h] edi +
mov eax [esi+1Ch] +
cmp eax edi +
jz loc_1032027  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+1Ch] edi +
mov eax [esi+20h] +
cmp eax edi +
jz loc_1032038  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+20h] edi +
mov eax [esi+24h] +
cmp eax edi +
jz loc_1032049  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+24h] edi +
mov eax [esi+28h] +
cmp eax edi +
jz loc_103205A  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+28h] edi +
mov eax [esi+2Ch] +
cmp eax edi +
jz loc_103206B  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+2Ch] edi +
mov eax [esi+30h] +
cmp eax edi +
jz loc_103207C  +
push eax  +
call ??_V@YAXPAX@Z  +
pop ecx  +
mov [esi+30h] edi +
pop edi  +
pop esi  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 0AF8h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_4] +
and [ebp+hKey] 0 +
mov [ebp+var_AE8] eax +
mov eax [ebp+lpSrc] +
mov [ebp+Type] 1 +
test eax eax +
jz loc_103269F  +
push edi  +
mov edi 117h +
push edi  +
lea ecx [ebp+Dst] +
push ecx  +
push eax  +
call ds:ExpandEnvironmentStringsW  +
lea eax [ebp+Dst] +
push eax  +
call ds:_wcslwr  +
cmp dword_10416EC 0 +
pop ecx  +
lea eax [ebp+Dst] +
jz loc_10320FB  +
push eax  +
call sub_1031619  +
jmp loc_103269E  +
push ebx  +
push esi  +
push eax  +
push edi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027E68  +
lea eax [ebp+FileName] +
push offset a_exe  +
push eax  +
call ds:wcsstr  +
mov ebx ds:wcschr +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_10321FD  +
xor ecx ecx +
mov [eax+8] cx +
lea eax [ebp+FileName] +
push 5Ch  +
push eax  +
call ebx  +
mov esi eax +
neg esi  +
sbb esi esi +
neg esi  +
pop ecx  +
pop ecx  +
jz loc_10321FD  +
lea eax [ebp+FileName] +
push 22h  +
push eax  +
call ebx  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_10321E5  +
add eax 2 +
push eax  +
push 103h  +
lea eax [ebp+var_43C] +
push eax  +
call sub_1027E68  +
lea eax [ebp+var_43C] +
push 22h  +
push eax  +
call ebx  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10321FD  +
lea eax [ebp+var_43C] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_1032192  +
sub eax edx +
sar eax 1 +
cmp eax 8 +
jbe loc_10321FD  +
push dword ptr [ebp+var_43C]  +
call ds:iswalpha  +
pop ecx  +
test eax eax +
jz loc_10321FD  +
push 3Ah  +
pop eax  +
cmp ax [ebp-43Ah] +
jnz loc_10321FD  +
push 5Ch  +
pop eax  +
cmp ax [ebp+var_438] +
jnz loc_10321FD  +
lea eax [ebp+var_43C] +
push eax  +
push edi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027E68  +
xor esi esi +
inc esi  +
test esi esi +
jz loc_10321FD  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_1032699  +
cmp dword_10416E8 0 +
jnz loc_10322F9  +
push lpSubKey  +
lea eax [ebp+FileName] +
push edi  +
push eax  +
call sub_1027E68  +
mov eax [ebp+arg_0] +
sub eax 0 +
mov esi 118h +
jz loc_1032242  +
dec eax  +
dec eax  +
lea eax [ebp+FileName] +
jz loc_103223B  +
push offset aExtensions  +
jmp loc_103224D  +
push offset aDevices  +
jmp loc_103224D  +
push offset aMimeTypes  +
lea eax [ebp+FileName] +
push esi  +
push eax  +
call sub_1027EDD  +
push [ebp+var_AE8]  +
lea eax [ebp+FileName] +
push esi  +
push eax  +
call sub_1027EDD  +
mov edi ds:RegOpenKeyExW +
lea eax [ebp+hKey] +
push eax  +
push 1  +
xor esi esi +
push esi  +
lea eax [ebp+FileName] +
push eax  +
push 80000002h  +
call edi  +
test eax eax +
jnz loc_1032699  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aDisableextensi  +
push [ebp+hKey]  +
mov [ebp+phkResult] esi +
mov esi ds:RegQueryValueExW +
mov [ebp+cbData] 208h +
call esi  +
test eax eax +
jnz loc_1032300  +
cmp [ebp+Type] 1 +
jnz loc_1032300  +
lea eax [ebp+Data] +
push offset aYes  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1032300  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
xor eax eax +
jmp loc_103269C  +
lea eax [ebp+phkResult] +
push eax  +
push 1  +
push 0  +
lea eax [ebp+FileName] +
push eax  +
push hKey  +
call edi  +
mov edi 230h +
test eax eax +
jnz loc_103239B  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aUserapprovedow  +
push [ebp+phkResult]  +
mov [ebp+cbData] edi +
call esi  +
test eax eax +
jnz loc_103238F  +
cmp [ebp+Type] 1 +
jnz loc_103238F  +
push [ebp+phkResult]  +
mov esi ds:RegCloseKey +
call esi  +
push [ebp+hKey]  +
call esi  +
lea eax [ebp+FileName] +
push offset aNo  +
push eax  +
call ds:_wcsicmp  +
neg eax  +
pop ecx  +
sbb eax eax +
pop ecx  +
neg eax  +
jmp loc_103269C  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
and [ebp+var_AF4] 0 +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aAllowownership  +
push [ebp+hKey]  +
mov [ebp+cbData] edi +
call esi  +
test eax eax +
jnz loc_10323FB  +
cmp [ebp+Type] 1 +
jnz loc_10323FB  +
lea eax [ebp+FileName] +
push offset aNo  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10323FB  +
mov [ebp+var_AF4] 1 +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aSuperiorapps  +
push [ebp+hKey]  +
mov [ebp+cbData] edi +
call esi  +
test eax eax +
jnz loc_10324FC  +
cmp [ebp+Type] 1 +
jnz loc_10324FC  +
lea eax [ebp+FileName] +
push eax  +
call ds:_wcslwr  +
pop ecx  +
lea eax [ebp+FileName] +
push eax  +
mov [ebp+var_AE8] eax +
push 103h  +
lea eax [ebp+var_8D8] +
push eax  +
call sub_1027E68  +
lea eax [ebp+var_8D8] +
push 7Ch  +
push eax  +
call ebx  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103247C  +
xor ecx ecx +
mov [eax] cx +
lea eax [ebp+var_8D8] +
push offset asc_1002FC4  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_10324AC  +
lea eax [ebp+var_8D8] +
push offset a__0  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10324B6  +
mov [ebp+var_AF4] 1 +
lea eax [ebp+var_8D8] +
push eax  +
lea eax [ebp+Dst] +
push eax  +
call ds:wcsstr  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10324E7  +
push 7Ch  +
push [ebp+var_AE8]  +
call ebx  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_10324FC  +
inc eax  +
inc eax  +
jmp loc_103244E  +
xor esi esi +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov eax esi +
jmp loc_103269C  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aReplaceapps  +
push [ebp+hKey]  +
mov [ebp+cbData] edi +
call esi  +
test eax eax +
jnz loc_1032569  +
cmp [ebp+Type] 1 +
jnz loc_1032569  +
mov edi ds:_wcsicmp +
cmp [ebp+var_AF4] eax +
jnz loc_1032571  +
lea eax [ebp+FileName] +
push offset asc_1002FC4  +
push eax  +
call edi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1032569  +
lea eax [ebp+FileName] +
push offset a__0  +
push eax  +
call edi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1032571  +
xor esi esi +
inc esi  +
jmp loc_10324E9  +
mov esi ds:_wcslwr +
lea eax [ebp+FileName] +
push eax  +
call esi  +
lea eax [ebp+Dst] +
push eax  +
call esi  +
pop ecx  +
pop ecx  +
lea esi [ebp+FileName] +
push esi  +
push 103h  +
lea eax [ebp+var_43C] +
push eax  +
call sub_1027E68  +
lea eax [ebp+var_43C] +
push 7Ch  +
push eax  +
call ebx  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_10325B9  +
xor ecx ecx +
mov [eax] cx +
lea eax [ebp+var_43C] +
push eax  +
lea eax [ebp+Dst] +
push eax  +
call ds:wcsstr  +
pop ecx  +
pop ecx  +
mov [ebp+var_AE8] eax +
test eax eax +
jnz loc_103260D  +
cmp [ebp+var_AF4] eax +
jnz loc_1032681  +
lea eax [ebp+var_43C] +
push offset asc_1002FC4  +
push eax  +
call edi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103260D  +
lea eax [ebp+var_43C] +
push offset a__0  +
push eax  +
call edi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1032681  +
mov eax [ebp+var_AE8] +
lea ecx [ebp+Dst] +
cmp eax ecx +
jz loc_1032569  +
movzx eax word ptr [eax-2] +
push eax  +
call ds:iswalnum  +
neg eax  +
sbb eax eax +
inc eax  +
pop ecx  +
jnz loc_1032569  +
push 5Ch  +
pop eax  +
cmp ax word ptr [ebp+var_43C] +
jz loc_1032681  +
lea eax [ebp+var_43C] +
push eax  +
push offset aS  +
lea eax [ebp+var_4A0] +
push 31h  +
push eax  +
call sub_1027F64  +
lea eax [ebp+var_4A0] +
push eax  +
lea eax [ebp+Dst] +
push eax  +
call ds:wcsstr  +
add esp 18h +
neg eax  +
sbb eax eax +
neg eax  +
jnz loc_1032569  +
push 7Ch  +
push esi  +
call ebx  +
mov esi eax +
pop ecx  +
pop ecx  +
test esi esi +
jz loc_10324E7  +
inc esi  +
inc esi  +
jmp loc_1032591  +
xor eax eax +
inc eax  +
pop esi  +
pop ebx  +
pop edi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 6B0h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+lpSubKey] +
push ebx  +
mov ebx ds:RegOpenKeyExW +
push esi  +
push edi  +
lea ecx [ebp+hKey] +
push ecx  +
xor edi edi +
push 20019h  +
push edi  +
push eax  +
mov esi 80000000h +
push esi  +
mov [ebp+hKey] edi +
mov [ebp+cbData] edi +
mov [ebp+var_6AC] edi +
mov [ebp+Type] 1 +
call ebx  +
test eax eax +
jnz loc_1032BCB  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push edi  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1032BBF  +
cmp [ebp+Type] 1 +
jnz loc_1032BBF  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1032BBF  +
lea eax [ebp+Data] +
push eax  +
push offset aSShellOpenComm  +
lea eax [ebp+SubKey] +
push 103h  +
push eax  +
mov [ebp+phkResult] edi +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+phkResult] +
push eax  +
push 20019h  +
push edi  +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
call ebx  +
test eax eax +
jnz loc_103284C  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_450] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push edi  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1032840  +
xor edx edx +
inc edx  +
cmp [ebp+Type] edx +
jz loc_10327EF  +
cmp [ebp+Type] 2 +
jnz loc_1032840  +
lea eax [ebp+var_450] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1032840  +
lea eax [ebp+var_450] +
push eax  +
mov [ebp+var_6AC] edx +
call ds:_wcslwr  +
pop ecx  +
lea eax [ebp+var_450] +
push eax  +
call sub_1031552  +
test eax eax +
jnz loc_1032840  +
push [ebp+hKey]  +
mov esi ds:RegCloseKey +
call esi  +
push [ebp+phkResult]  +
call esi  +
xor eax eax +
jmp loc_1032BD1  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
lea eax [ebp+Data] +
push eax  +
push offset aSShellOpenDdee  +
lea eax [ebp+SubKey] +
push 103h  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+phkResult] +
push eax  +
push 20019h  +
push edi  +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
call ebx  +
test eax eax +
jnz loc_103292A  +
lea eax [ebp+Data] +
push eax  +
push offset aSShellOpenDd_0  +
lea eax [ebp+SubKey] +
push 103h  +
push eax  +
mov [ebp+var_698] edi +
call sub_1027F64  +
add esp 10h +
push edi  +
lea eax [ebp+var_698] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_10328F1  +
push [ebp+var_698]  +
push [ebp+phkResult]  +
call sub_102F291  +
push [ebp+var_698]  +
call ds:RegCloseKey  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
lea eax [ebp+Data] +
push eax  +
push offset aSShellOpenDdee  +
lea eax [ebp+SubKey] +
push 103h  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
call sub_102F8CE  +
lea eax [ebp+Data] +
push eax  +
push offset aSShell  +
lea eax [ebp+SubKey] +
push 103h  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+phkResult] +
push eax  +
push 20019h  +
push edi  +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
call ebx  +
test eax eax +
jnz loc_1032BBF  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_450] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push edi  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1032BB3  +
cmp [ebp+Type] 1 +
jnz loc_1032BB3  +
lea eax [ebp+var_450] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1032BB3  +
push offset SubBlock  +
push 104h  +
lea eax [ebp+SubKey] +
push eax  +
mov [ebp+var_698] edi +
call sub_1027EDD  +
lea eax [ebp+var_450] +
push eax  +
push 104h  +
lea eax [ebp+SubKey] +
push eax  +
call sub_1027EDD  +
lea eax [ebp+SubKey] +
push eax  +
push offset aSCommand  +
lea eax [ebp+var_450] +
push 121h  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+var_698] +
push eax  +
push 20019h  +
push edi  +
lea eax [ebp+var_450] +
push eax  +
push esi  +
call ebx  +
test eax eax +
jnz loc_1032AD8  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_450] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push edi  +
push [ebp+var_698]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1032ACC  +
xor edx edx +
inc edx  +
cmp [ebp+Type] edx +
jz loc_1032A77  +
cmp [ebp+Type] 2 +
jnz loc_1032ACC  +
lea eax [ebp+var_450] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1032ACC  +
lea eax [ebp+var_450] +
push eax  +
mov [ebp+var_6AC] edx +
call ds:_wcslwr  +
pop ecx  +
lea eax [ebp+var_450] +
push eax  +
call sub_1031552  +
test eax eax +
jnz loc_1032ACC  +
push [ebp+hKey]  +
mov esi ds:RegCloseKey +
call esi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+var_698]  +
jmp loc_1032837  +
push [ebp+var_698]  +
call ds:RegCloseKey  +
lea eax [ebp+SubKey] +
push eax  +
push offset aSDdeexec  +
lea eax [ebp+var_450] +
push 121h  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+var_698] +
push eax  +
push 20019h  +
push edi  +
lea eax [ebp+var_450] +
push eax  +
push esi  +
call ebx  +
test eax eax +
jnz loc_1032BB3  +
lea eax [ebp+SubKey] +
push eax  +
push offset aSDdeexec_bak  +
mov ebx 121h +
lea eax [ebp+var_450] +
push ebx  +
push eax  +
mov [ebp+var_6B0] edi +
call sub_1027F64  +
add esp 10h +
push edi  +
lea eax [ebp+var_6B0] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1032B7E  +
push [ebp+var_6B0]  +
push [ebp+var_698]  +
call sub_102F291  +
push [ebp+var_6B0]  +
call ds:RegCloseKey  +
push [ebp+var_698]  +
call ds:RegCloseKey  +
lea eax [ebp+SubKey] +
push eax  +
push offset aSDdeexec  +
lea eax [ebp+var_450] +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+var_450] +
push eax  +
push esi  +
call sub_102F8CE  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov eax [ebp+var_6AC] +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 3ECh +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov ecx dword ptr [ebp+arg_0] +
push ebx  +
push esi  +
push edi  +
xor eax eax +
push ecx  +
inc eax  +
push offset aSShellOpenComm  +
mov [ebp+dwType] eax +
mov [ebp+var_3E8] eax +
lea eax [ebp+SubKey] +
xor esi esi +
push 0C7h  +
push eax  +
mov dword ptr [ebp+var_3EC] ecx +
mov [ebp+hKey] esi +
mov [ebp+cbData] esi +
call sub_1027F64  +
mov edi ds:RegOpenKeyExW +
add esp 10h +
lea eax [ebp+hKey] +
push eax  +
mov ebx 2001Fh +
push ebx  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000000h  +
call edi  +
test eax eax +
jnz loc_1032DB2  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
push esi  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1032D8E  +
cmp [ebp+dwType] 1 +
jz loc_1032CB4  +
cmp [ebp+dwType] 2 +
jnz loc_1032D8E  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1032D8E  +
lea eax [ebp+Data] +
push eax  +
call ds:_wcslwr  +
pop ecx  +
lea eax [ebp+Data] +
push eax  +
call sub_1031552  +
test eax eax +
jnz loc_1032CF7  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
jmp loc_1032EB0  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
push offset aMplayer2_bak  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1032D88  +
cmp [ebp+dwType] 1 +
jz loc_1032D3E  +
cmp [ebp+dwType] 2 +
jnz loc_1032D88  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1032D47  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push [ebp+dwType]  +
push esi  +
push esi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
push offset aMplayer2_bak  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
jmp loc_1032D8E  +
mov [ebp+var_3E8] esi +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp [ebp+var_3E8] esi +
jnz loc_1032DB2  +
push dword ptr [ebp+var_3EC]  +
push 80000000h  +
jmp loc_1032EAB  +
push dword ptr [ebp+var_3EC]  +
lea eax [ebp+SubKey] +
push offset aSDefaulticon  +
push 0C7h  +
push eax  +
mov [ebp+var_3E8] 1 +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+hKey] +
push eax  +
push ebx  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
mov ebx 80000000h +
push ebx  +
call edi  +
test eax eax +
jnz loc_1032EB0  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
mov edi offset aMplayer2_bak +
push edi  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1032E89  +
cmp [ebp+dwType] 1 +
jz loc_1032E43  +
cmp [ebp+dwType] 2 +
jnz loc_1032E89  +
push edi  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1032E59  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push [ebp+dwType]  +
push esi  +
push esi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
jmp loc_1032E8F  +
mov [ebp+var_3E8] esi +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp [ebp+var_3E8] esi +
jnz loc_1032EB0  +
lea eax [ebp+SubKey] +
push eax  +
push ebx  +
call sub_102F8CE  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 880h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax dword ptr [ebp+arg_4] +
mov ecx [ebp+arg_8] +
push ebx  +
push esi  +
push edi  +
mov edi [ebp+arg_0] +
push eax  +
mov [ebp+var_880] ecx +
mov ecx [ebp+arg_C] +
push offset aSL  +
mov [ebp+phkResult] ecx +
mov ecx [ebp+arg_10] +
xor esi esi +
lea eax [ebp+var_61C] +
push 121h  +
push eax  +
mov dword ptr [ebp+var_874] edi +
mov [ebp+lpData] ecx +
mov [ebp+hKey] esi +
mov [ebp+cbData] esi +
mov [ebp+dwType] 1 +
mov [ebp+var_87C] esi +
call sub_1027F64  +
add esp 10h +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 2001Fh  +
push esi  +
push esi  +
push esi  +
push edi  +
push 80000000h  +
call ds:RegCreateKeyExW  +
mov edi ds:RegSetValueExW +
test eax eax +
jnz loc_1033090  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
mov ebx offset aUrlProtocol +
push ebx  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1032FA7  +
cmp [ebp+dwType] 1 +
jz loc_1032FBA  +
push 2  +
push offset byte_1002720  +
push 1  +
push esi  +
push ebx  +
push [ebp+hKey]  +
call edi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
push esi  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1033004  +
cmp [ebp+dwType] 1 +
jnz loc_1033004  +
lea eax [ebp+Src] +
push eax  +
call sub_10313BF  +
test eax eax +
jnz loc_1033052  +
push dword ptr [ebp+var_874]  +
lea eax [ebp+Src] +
push offset aUrlSProtocol  +
push 121h  +
push eax  +
call sub_1027F64  +
lea eax [ebp+Src] +
add esp 10h +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_103302C  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Src] +
push eax  +
push 1  +
push esi  +
push esi  +
push [ebp+hKey]  +
call edi  +
mov eax [ebp+phkResult] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_103305B  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push [ebp+phkResult]  +
push 1  +
push esi  +
push offset aSourceFilter  +
push [ebp+hKey]  +
call edi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push dword ptr [ebp+var_874]  +
lea eax [ebp+SubKey] +
push offset aSShellOpenComm  +
push 0C7h  +
push eax  +
call sub_1027F64  +
add esp 10h +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 2001Fh  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1033432  +
mov [ebp+Src] ax +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
push esi  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1033280  +
cmp [ebp+dwType] 1 +
jz loc_103312C  +
cmp [ebp+dwType] 2 +
jnz loc_1033280  +
lea eax [ebp+Src] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1033280  +
push dword ptr [ebp+var_874]  +
lea eax [ebp+SubKey] +
push lpSubKey  +
xor ebx ebx +
push offset aSProtocolsS  +
push 0C7h  +
push eax  +
mov [ebp+phkResult] esi +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+phkResult] +
push eax  +
push 1  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push hKey  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10331F8  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
push offset aUserapprovedow  +
push [ebp+phkResult]  +
mov [ebp+cbData] 190h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10331E8  +
cmp [ebp+dwType] 1 +
jnz loc_10331E8  +
lea eax [ebp+SubKey] +
push offset aNo  +
push eax  +
call ds:_wcsicmp  +
mov ebx eax +
neg ebx  +
pop ecx  +
sbb ebx ebx +
pop ecx  +
neg ebx  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
cmp ebx esi +
jnz loc_1033213  +
lea eax [ebp+Src] +
push eax  +
push [ebp+var_880]  +
push esi  +
call sub_1032084  +
cmp eax esi +
jz loc_10332E2  +
lea eax [ebp+Src] +
push eax  +
push 121h  +
lea eax [ebp+var_860] +
push eax  +
call sub_1027E68  +
lea eax [ebp+var_860] +
push eax  +
call ds:_wcslwr  +
pop ecx  +
lea eax [ebp+var_860] +
push eax  +
call sub_1031552  +
test eax eax +
jnz loc_1033280  +
lea eax [ebp+Src] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1033252  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Src] +
push eax  +
push [ebp+dwType]  +
push esi  +
push offset aMplayer2_bak  +
push [ebp+hKey]  +
call edi  +
cmp [ebp+dwType] 1 +
mov [ebp+var_87C] 1 +
jz loc_103329C  +
cmp [ebp+dwType] 2 +
jnz loc_10332B3  +
lea eax [ebp+var_61C] +
push eax  +
lea eax [ebp+Src] +
push eax  +
call sub_103172F  +
test eax eax +
jnz loc_10332E2  +
lea eax [ebp+var_61C] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_10332BC  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_61C] +
push eax  +
push 1  +
push esi  +
push esi  +
push [ebp+hKey]  +
call edi  +
push [ebp+hKey]  +
mov ebx ds:RegCloseKey +
call ebx  +
cmp [ebp+var_87C] esi +
jz loc_1033432  +
push [ebp+lpData]  +
call sub_10313BF  +
test eax eax +
jz loc_1033432  +
push dword ptr [ebp+var_874]  +
lea eax [ebp+SubKey] +
push offset aSDefaulticon  +
push 0C7h  +
push eax  +
call sub_1027F64  +
add esp 10h +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 2001Fh  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1033432  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push esi  +
push esi  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10333FC  +
cmp [ebp+dwType] 1 +
jz loc_103339C  +
cmp [ebp+dwType] 2 +
jnz loc_10333FC  +
lea eax [ebp+Src] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_10333FC  +
lea eax [ebp+Src] +
push eax  +
push [ebp+lpData]  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_10333FC  +
lea eax [ebp+Src] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_10333CE  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Src] +
push eax  +
push [ebp+dwType]  +
push esi  +
push offset aMplayer2_bak  +
push [ebp+hKey]  +
call edi  +
mov eax [ebp+lpData] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1033405  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push [ebp+lpData]  +
push 2  +
push esi  +
push esi  +
push [ebp+hKey]  +
call edi  +
push [ebp+hKey]  +
call ebx  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 14h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 910h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov ecx [ebp+arg_8] +
mov eax [ebp+arg_0] +
push ebx  +
push esi  +
mov esi [ebp+arg_4] +
xor ebx ebx +
push edi  +
xor edi edi +
inc edi  +
mov [ebp+var_904] ecx +
mov ecx [ebp+arg_14] +
mov [ebp+lpData] eax +
mov [ebp+var_910] ecx +
mov [ebp+hKey] ebx +
mov [ebp+cbData] ebx +
mov [ebp+dwType] edi +
mov [ebp+var_8FC] ebx +
mov [ebp+var_8F4] ebx +
mov [ebp+var_90C] edi +
mov [ebp+var_900] edi +
mov [ebp+var_8F8] ebx +
cmp eax ebx +
jz loc_1033E73  +
push offset aAudiocd  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10334E1  +
push [ebp+lpData]  +
mov [ebp+var_8F8] edi +
push esi  +
push offset aSPrefetch3Devi  +
jmp loc_103350B  +
push offset aDvd  +
push [ebp+lpData]  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
push [ebp+lpData]  +
push esi  +
test eax eax +
jnz loc_1033506  +
push offset aSPrefetch4Devi  +
jmp loc_103350B  +
push offset aSDeviceSL  +
lea eax [ebp+var_48C] +
push 121h  +
push eax  +
call sub_1027F64  +
add esp 14h +
push [ebp+lpData]  +
lea eax [ebp+Src] +
push offset aWmp_SShellPlay  +
push 121h  +
push eax  +
call sub_1027F64  +
add esp 10h +
push ebx  +
lea eax [ebp+hKey] +
push eax  +
push ebx  +
push 2001Fh  +
push ebx  +
push ebx  +
push ebx  +
lea eax [ebp+Src] +
push eax  +
mov edi 80000000h +
push edi  +
call ds:RegCreateKeyExW  +
mov esi ds:RegSetValueExW +
test eax eax +
jnz loc_103361A  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push ebx  +
push ebx  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10335DF  +
cmp [ebp+dwType] 1 +
jz loc_10335B3  +
cmp [ebp+dwType] 2 +
jnz loc_10335DF  +
lea eax [ebp+var_48C] +
push eax  +
lea eax [ebp+Src] +
push eax  +
call sub_103172F  +
test eax eax +
jnz loc_103360E  +
lea eax [ebp+var_48C] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_10335D3  +
jmp loc_10335F2  +
lea eax [ebp+var_48C] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_10335E8  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_48C] +
push eax  +
push 1  +
push ebx  +
push ebx  +
push [ebp+hKey]  +
call esi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push ebx  +
lea eax [ebp+hKey] +
push eax  +
push ebx  +
push 2001Fh  +
push ebx  +
push ebx  +
push ebx  +
push [ebp+lpData]  +
push edi  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1033DFF  +
mov edi ds:RegOpenKeyExW +
lea eax [ebp+phkResult] +
push eax  +
push 1  +
push ebx  +
push offset aShell  +
push [ebp+hKey]  +
mov [ebp+phkResult] ebx +
call edi  +
test eax eax +
jnz loc_10337A1  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push ebx  +
push ebx  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1033795  +
cmp [ebp+dwType] 1 +
jnz loc_1033795  +
lea eax [ebp+Src] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1033795  +
lea eax [ebp+Src] +
push offset aPlay  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1033795  +
push offset aCommand_0  +
push 122h  +
lea eax [ebp+Src] +
push eax  +
mov [ebp+var_908] ebx +
call sub_1027EDD  +
lea eax [ebp+var_908] +
push eax  +
push 1  +
push ebx  +
lea eax [ebp+Src] +
push eax  +
push [ebp+phkResult]  +
call edi  +
test eax eax +
jnz loc_1033795  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push ebx  +
push ebx  +
push [ebp+var_908]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1033789  +
cmp [ebp+dwType] 1 +
jz loc_1033759  +
cmp [ebp+dwType] 2 +
jnz loc_1033789  +
lea eax [ebp+Src] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1033789  +
lea eax [ebp+Src] +
push eax  +
push [ebp+lpData]  +
push 2  +
call sub_1032084  +
mov [ebp+var_900] eax +
mov [ebp+var_90C] ebx +
push [ebp+var_908]  +
call ds:RegCloseKey  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push ebx  +
lea eax [ebp+phkResult] +
push eax  +
push ebx  +
push 2001Fh  +
push ebx  +
push ebx  +
push ebx  +
push offset aShellPlayComma  +
push [ebp+hKey]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1033DF3  +
mov edi ds:RegQueryValueExW +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push ebx  +
push ebx  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call edi  +
test eax eax +
jnz loc_10338FD  +
cmp [ebp+dwType] 1 +
jz loc_1033818  +
cmp [ebp+dwType] 2 +
jnz loc_10338FD  +
lea eax [ebp+Src] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_10338FD  +
lea eax [ebp+Src] +
push eax  +
push [ebp+lpData]  +
push 2  +
call sub_1032084  +
test eax eax +
jz loc_1033944  +
mov eax [ebp+var_900] +
mov [ebp+var_8FC] eax +
lea eax [ebp+Src] +
push eax  +
push 121h  +
lea eax [ebp+var_8DC] +
push eax  +
call sub_1027E68  +
lea eax [ebp+var_8DC] +
push eax  +
call ds:_wcslwr  +
pop ecx  +
lea eax [ebp+var_8DC] +
push eax  +
call sub_1031552  +
test eax eax +
jnz loc_10338C3  +
lea eax [ebp+Src] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_1033893  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Src] +
push eax  +
push [ebp+dwType]  +
push ebx  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
call esi  +
jmp loc_10338CF  +
mov eax [ebp+var_90C] +
mov [ebp+var_8F4] eax +
lea eax [ebp+var_48C] +
push eax  +
lea eax [ebp+Src] +
push eax  +
call sub_103172F  +
test eax eax +
jnz loc_1033944  +
lea eax [ebp+var_48C] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_10338EF  +
sub eax edx +
jmp loc_103392A  +
mov eax [ebp+var_900] +
mov [ebp+var_8FC] eax +
mov eax [ebp+var_90C] +
mov [ebp+var_8F4] eax +
lea eax [ebp+var_48C] +
lea ecx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx bx +
jnz loc_103391E  +
sub eax ecx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_48C] +
push eax  +
push 1  +
push ebx  +
push ebx  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
cmp [ebp+var_8FC] ebx +
jz loc_1033DF3  +
push 105h  +
lea eax [ebp+var_8A4] +
push eax  +
call sub_102FC69  +
test eax eax +
jz loc_1033DF3  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push ebx  +
push ebx  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call edi  +
test eax eax +
jnz loc_10339AB  +
cmp [ebp+dwType] 1 +
jz loc_10339D9  +
mov eax [ebp+lpData] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_10339B4  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push [ebp+lpData]  +
push 1  +
push ebx  +
push ebx  +
push [ebp+hKey]  +
call esi  +
push ebx  +
push ebx  +
push ebx  +
push ebx  +
mov edi offset aBaseclass +
push edi  +
push [ebp+hKey]  +
call ds:RegQueryValueExW  +
test eax eax +
jz loc_1033A06  +
push 0Ch  +
push offset aDrive  +
push 1  +
push ebx  +
push edi  +
push [ebp+hKey]  +
call esi  +
push ebx  +
push ebx  +
push ebx  +
push ebx  +
mov edi offset aEditflags +
push edi  +
push [ebp+hKey]  +
call ds:RegQueryValueExW  +
test eax eax +
jz loc_1033A4F  +
push 4  +
lea eax [ebp+lpData] +
push eax  +
push 3  +
push ebx  +
push edi  +
push [ebp+hKey]  +
mov byte ptr [ebp+lpData] 2 +
mov byte ptr [ebp+lpData+1] bl +
mov byte ptr [ebp+lpData+2] 10h +
mov byte ptr [ebp+lpData+3] bl +
call esi  +
push ebx  +
lea eax [ebp+phkResult] +
push eax  +
push ebx  +
mov edi 2001Fh +
push edi  +
push ebx  +
push ebx  +
push ebx  +
push offset aShellPlay  +
push [ebp+hKey]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1033C1A  +
mov [ebp+cbData] 244h +
cmp [ebp+var_8F4] ebx +
jnz loc_1033B10  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push ebx  +
push ebx  +
push [ebp+phkResult]  +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1033B10  +
cmp [ebp+dwType] 1 +
jz loc_1033AC9  +
cmp [ebp+dwType] 2 +
jnz loc_1033B10  +
lea eax [ebp+Src] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1033B10  +
lea eax [ebp+Src] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_1033AE2  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Src] +
push eax  +
push [ebp+dwType]  +
push ebx  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
call esi  +
mov eax [ebp+var_910] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_1033B19  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push [ebp+var_910]  +
push 1  +
push ebx  +
push ebx  +
push [ebp+phkResult]  +
call esi  +
lea eax [ebp+var_8A4] +
push eax  +
push offset a@S9991  +
lea eax [ebp+var_698] +
push 105h  +
push eax  +
call sub_1027F64  +
add esp 10h +
test eax eax +
jl loc_1033C09  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push ebx  +
mov edi offset aMuiverb +
push edi  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1033BDA  +
cmp [ebp+dwType] 1 +
jz loc_1033BAE  +
cmp [ebp+dwType] 2 +
jnz loc_1033BDA  +
lea eax [ebp+var_698] +
push eax  +
lea eax [ebp+Src] +
push eax  +
call sub_103172F  +
test eax eax +
jnz loc_1033C09  +
lea eax [ebp+var_698] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_1033BCE  +
jmp loc_1033BED  +
lea eax [ebp+var_698] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_1033BE3  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_698] +
push eax  +
push 1  +
push ebx  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
mov edi 2001Fh +
push ebx  +
lea eax [ebp+phkResult] +
push eax  +
push ebx  +
push edi  +
push ebx  +
push ebx  +
push ebx  +
push offset aShell  +
push [ebp+hKey]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1033CE4  +
mov [ebp+cbData] 244h +
cmp [ebp+var_8F4] ebx +
jnz loc_1033CC5  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push ebx  +
push ebx  +
push [ebp+phkResult]  +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1033CC5  +
cmp [ebp+dwType] 1 +
jnz loc_1033CC5  +
lea eax [ebp+Src] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1033CC5  +
lea eax [ebp+Src] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_1033C9B  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Src] +
push eax  +
push 1  +
push ebx  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
call esi  +
push 0Ah  +
push offset aPlay_0  +
push 1  +
push ebx  +
push ebx  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push ebx  +
lea eax [ebp+phkResult] +
push eax  +
push ebx  +
push edi  +
push ebx  +
push ebx  +
push ebx  +
push offset aDefaulticon  +
push [ebp+hKey]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1033DF3  +
mov [ebp+cbData] 244h +
cmp [ebp+var_8F4] ebx +
jnz loc_1033DB9  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+dwType] +
push eax  +
push ebx  +
push ebx  +
push [ebp+phkResult]  +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1033DB9  +
cmp [ebp+dwType] 1 +
jz loc_1033D59  +
cmp [ebp+dwType] 2 +
jnz loc_1033DB9  +
lea eax [ebp+Src] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1033DB9  +
push [ebp+var_904]  +
lea eax [ebp+Src] +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1033DB9  +
lea eax [ebp+Src] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_1033D8B  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Src] +
push eax  +
push [ebp+dwType]  +
push ebx  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
call esi  +
mov eax [ebp+var_904] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_1033DC2  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push [ebp+var_904]  +
push 2  +
push ebx  +
push ebx  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp [ebp+var_8F8] ebx +
jz loc_1033E73  +
cmp [ebp+var_8FC] ebx +
jz loc_1033E73  +
lea eax [ebp+hKey] +
push eax  +
push 2001Fh  +
push ebx  +
push offset aSoftwareMic_53  +
push 80000001h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1033E73  +
push 4  +
pop edi  +
push edi  +
lea eax [ebp+var_8F8] +
push eax  +
push edi  +
push ebx  +
push offset aTray  +
push [ebp+hKey]  +
mov [ebp+var_8F8] ebx +
call esi  +
push edi  +
lea eax [ebp+var_8F8] +
push eax  +
push edi  +
push ebx  +
push offset aStartplay  +
push [ebp+hKey]  +
call esi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 18h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 0AE0h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+lpSubKey] +
mov ecx [ebp+arg_4] +
push ebx  +
mov ebx [ebp+arg_8] +
push esi  +
xor esi esi +
mov dword ptr [ebp+var_ABC] eax +
mov [ebp+var_AC8] ecx +
mov [ebp+var_AE0] ebx +
mov [ebp+phkResult] esi +
mov [ebp+cbName] esi +
mov [ebp+Type] 1 +
mov [ebp+hKey] esi +
cmp eax esi +
jz loc_10350C1  +
push edi  +
lea ecx [ebp+phkResult] +
push ecx  +
push 2001Fh  +
push esi  +
push eax  +
mov edi 80000000h +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10350BE  +
push [ebp+phkResult]  +
inc eax  +
mov [ebp+var_AD4] esi +
mov [ebp+var_AC4] eax +
mov [ebp+var_ADC] esi +
mov [ebp+var_AD0] eax +
mov [ebp+var_AD8] esi +
call ds:RegCloseKey  +
push dword ptr [ebp+var_ABC]  +
mov ebx 103h +
push offset aSShellOpenComm  +
lea eax [ebp+SubKey] +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10340F8  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push esi  +
push [ebp+phkResult]  +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10340EC  +
cmp [ebp+Type] 1 +
jz loc_1033FBD  +
cmp [ebp+Type] 2 +
jnz loc_10340EC  +
lea eax [ebp+Name] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_10340EC  +
lea eax [ebp+Name] +
push eax  +
call ds:_wcslwr  +
pop ecx  +
lea eax [ebp+Name] +
push eax  +
call sub_1031552  +
test eax eax +
jz loc_10340EC  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
mov [ebp+var_AC4] esi +
mov [ebp+var_AD4] 1 +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10340EC  +
cmp [ebp+Type] 1 +
jz loc_1034052  +
cmp [ebp+Type] 2 +
jnz loc_10340EC  +
lea eax [ebp+Name] +
push eax  +
push 121h  +
lea eax [ebp+var_694] +
push eax  +
call sub_1027E68  +
lea eax [ebp+var_694] +
push eax  +
call ds:_wcslwr  +
pop ecx  +
lea eax [ebp+var_694] +
push eax  +
call sub_1031552  +
test eax eax +
jnz loc_10340EC  +
lea eax [ebp+Name] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1034091  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push [ebp+Type]  +
push esi  +
push esi  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push offset aMplayer2_bak_0  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
lea eax [ebp+var_694] +
push eax  +
call sub_10315F5  +
mov [ebp+hKey] eax +
mov [ebp+var_AC4] 1 +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push dword ptr [ebp+var_ABC]  +
lea eax [ebp+SubKey] +
push offset aSShellOpenDrop  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1034261  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aClsid  +
push [ebp+phkResult]  +
mov [ebp+var_ACC] esi +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103423F  +
cmp [ebp+Type] 1 +
jnz loc_103423F  +
lea eax [ebp+Name] +
push eax  +
call ds:_wcsupr  +
lea eax [ebp+Name] +
push eax  +
push off_103F074  +
call ds:_wcsicmp  +
add esp 0Ch +
test eax eax +
jnz loc_103423F  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMplayer2_bak_0  +
push [ebp+phkResult]  +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1034235  +
cmp [ebp+Type] 1 +
jnz loc_1034235  +
lea eax [ebp+Name] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_10341F4  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push 1  +
push esi  +
push offset aClsid  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push offset aMplayer2_bak_0  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
jmp loc_103423F  +
mov [ebp+var_ACC] 1 +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
cmp [ebp+var_ACC] esi +
jz loc_1034261  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegDeleteKeyW  +
cmp [ebp+var_AD4] esi +
jz loc_1034498  +
push dword ptr [ebp+var_ABC]  +
lea eax [ebp+SubKey] +
push offset aSShellOpen  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+phkResult] +
push eax  +
push 20006h  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10342C4  +
push offset aLegacydisable  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push dword ptr [ebp+var_ABC]  +
lea eax [ebp+SubKey] +
push offset aSShellOpenDd_0  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
cmp [ebp+hKey] esi +
jz loc_10343B1  +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10343B1  +
push dword ptr [ebp+var_ABC]  +
lea eax [ebp+SubKey] +
push offset aSShellOpenDdee  +
push ebx  +
push eax  +
mov [ebp+hKey] esi +
call sub_1027F64  +
add esp 10h +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 2001Fh  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103437D  +
push [ebp+hKey]  +
push [ebp+phkResult]  +
call sub_102F291  +
test eax eax +
jz loc_1034371  +
mov [ebp+var_AC4] 1 +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push dword ptr [ebp+var_ABC]  +
lea eax [ebp+SubKey] +
push offset aSShellOpenDd_0  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call sub_102F8CE  +
push dword ptr [ebp+var_ABC]  +
lea eax [ebp+SubKey] +
push offset aSShellOpen  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
cmp [ebp+var_AC4] esi +
jz loc_103448B  +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1034498  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103447D  +
cmp [ebp+Type] 1 +
jnz loc_103447D  +
lea eax [ebp+Name] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1034442  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push 1  +
push esi  +
push esi  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
jmp loc_1034498  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call sub_102F8CE  +
mov [ebp+hKey] esi +
cmp [ebp+var_AC8] esi +
jz loc_1034AD8  +
push [ebp+var_AC8]  +
lea eax [ebp+SubKey] +
push dword ptr [ebp+var_ABC]  +
push offset aSShellSCommand  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10346D7  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push esi  +
push [ebp+phkResult]  +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10346CB  +
cmp [ebp+Type] 1 +
jz loc_1034539  +
cmp [ebp+Type] 2 +
jnz loc_10346CB  +
lea eax [ebp+Name] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_10346CB  +
lea eax [ebp+Name] +
push eax  +
call ds:_wcslwr  +
pop ecx  +
lea eax [ebp+Name] +
push eax  +
call sub_1031552  +
test eax eax +
jz loc_10346CB  +
push [ebp+var_AC8]  +
lea eax [ebp+SubKey] +
push dword ptr [ebp+var_ABC]  +
mov [ebp+var_AC4] esi +
push offset aSShellS  +
push ebx  +
push eax  +
mov [ebp+var_AD0] esi +
mov [ebp+var_ADC] 1 +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+var_AC4] +
push eax  +
push 20006h  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10345E2  +
push offset aLegacydisable  +
push [ebp+var_AC4]  +
call ds:RegDeleteValueW  +
push [ebp+var_AC4]  +
call ds:RegCloseKey  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10346CB  +
cmp [ebp+Type] 1 +
jz loc_1034631  +
cmp [ebp+Type] 2 +
jnz loc_10346CB  +
lea eax [ebp+Name] +
push eax  +
push 121h  +
lea eax [ebp+var_694] +
push eax  +
call sub_1027E68  +
lea eax [ebp+var_694] +
push eax  +
call ds:_wcslwr  +
pop ecx  +
lea eax [ebp+var_694] +
push eax  +
call sub_1031552  +
test eax eax +
jnz loc_10346CB  +
lea eax [ebp+Name] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1034670  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push [ebp+Type]  +
push esi  +
push esi  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push offset aMplayer2_bak_0  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
lea eax [ebp+var_694] +
push eax  +
call sub_10315F5  +
mov [ebp+hKey] eax +
mov [ebp+var_AD0] 1 +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push [ebp+var_AC8]  +
lea eax [ebp+SubKey] +
push dword ptr [ebp+var_ABC]  +
push offset aSShellSDroptar  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1034846  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aClsid  +
push [ebp+phkResult]  +
mov [ebp+var_ACC] esi +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1034824  +
cmp [ebp+Type] 1 +
jnz loc_1034824  +
lea eax [ebp+Name] +
push eax  +
call ds:_wcsupr  +
lea eax [ebp+Name] +
push eax  +
push off_103F074  +
call ds:_wcsicmp  +
add esp 0Ch +
test eax eax +
jnz loc_1034824  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMplayer2_bak_0  +
push [ebp+phkResult]  +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103481A  +
cmp [ebp+Type] 1 +
jnz loc_103481A  +
lea eax [ebp+Name] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_10347D9  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push 1  +
push esi  +
push offset aClsid  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push offset aMplayer2_bak_0  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
jmp loc_1034824  +
mov [ebp+var_ACC] 1 +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
cmp [ebp+var_ACC] esi +
jz loc_1034846  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegDeleteKeyW  +
cmp [ebp+var_ADC] esi +
jz loc_1034AD8  +
push [ebp+var_AC8]  +
lea eax [ebp+SubKey] +
push dword ptr [ebp+var_ABC]  +
push offset aSShellSDdeexec  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 14h +
cmp [ebp+hKey] esi +
jz loc_1034951  +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1034951  +
push [ebp+var_AC8]  +
lea eax [ebp+SubKey] +
push dword ptr [ebp+var_ABC]  +
mov [ebp+var_AC4] esi +
push offset aSShellSDdeexec  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 14h +
push esi  +
lea eax [ebp+var_AC4] +
push eax  +
push esi  +
push 2001Fh  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1034917  +
push [ebp+var_AC4]  +
push [ebp+phkResult]  +
call sub_102F291  +
test eax eax +
jz loc_103490B  +
mov [ebp+var_AD0] 1 +
push [ebp+var_AC4]  +
call ds:RegCloseKey  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push [ebp+var_AC8]  +
lea eax [ebp+SubKey] +
push dword ptr [ebp+var_ABC]  +
push offset aSShellSDdeexec  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call sub_102F8CE  +
push [ebp+var_AC8]  +
lea eax [ebp+SubKey] +
push dword ptr [ebp+var_ABC]  +
push offset aSShellS  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 14h +
cmp [ebp+var_AD0] esi +
jz loc_1034ACB  +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1034AD8  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1034A23  +
cmp [ebp+Type] 1 +
jnz loc_1034A23  +
lea eax [ebp+Name] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_10349E8  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push 1  +
push esi  +
push esi  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
push [ebp+var_AC8]  +
call sub_10313BF  +
test eax eax +
jz loc_1034ABD  +
push offset aPlay  +
push [ebp+var_AC8]  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1034ABD  +
push 105h  +
lea eax [ebp+var_AAC] +
push eax  +
call sub_102FC69  +
test eax eax +
jz loc_1034ABD  +
lea eax [ebp+var_AAC] +
push eax  +
push offset a@S9991  +
lea eax [ebp+var_8A0] +
push 105h  +
push eax  +
call sub_1027F64  +
add esp 10h +
test eax eax +
jl loc_1034ABD  +
lea eax [ebp+var_8A0] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1034A8F  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+var_8A0] +
push eax  +
push 2  +
push esi  +
push offset aMuiverb  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
jmp loc_1034AD8  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call sub_102F8CE  +
push dword ptr [ebp+var_ABC]  +
lea eax [ebp+SubKey] +
push offset aSShell  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1035041  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push esi  +
push [ebp+phkResult]  +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1034D74  +
cmp [ebp+Type] 1 +
jnz loc_1034D74  +
lea eax [ebp+Name] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1034D74  +
lea eax [ebp+Name] +
push offset aOpen  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1034C08  +
cmp [ebp+var_AD4] esi +
jz loc_1034C08  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
mov [ebp+var_AD8] 1 +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1034C02  +
cmp [ebp+Type] 1 +
jnz loc_1034C02  +
lea eax [ebp+Name] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1034BE1  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push 1  +
jmp loc_1034D55  +
push esi  +
jmp loc_1034D68  +
cmp [ebp+var_ADC] esi +
jz loc_1034D74  +
push [ebp+var_AC8]  +
lea eax [ebp+Name] +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1034D74  +
push offset aPlay  +
push [ebp+var_AC8]  +
mov [ebp+var_AD8] 1 +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1034CE5  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMuiverb  +
push [ebp+phkResult]  +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1034CE5  +
cmp [ebp+Type] 1 +
jz loc_1034C9D  +
cmp [ebp+Type] 2 +
jnz loc_1034CE5  +
lea eax [ebp+Name] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1034CE5  +
lea eax [ebp+Name] +
push eax  +
call ds:_wcslwr  +
lea eax [ebp+Name] +
mov [esp+0AF0h+var_AF0] offset aUnregmp2_exe +
push eax  +
call ds:wcsstr  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1034CE5  +
push offset aMuiverb  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1034D74  +
cmp [ebp+Type] 1 +
jz loc_1034D2C  +
cmp [ebp+Type] 2 +
jnz loc_1034D74  +
lea eax [ebp+Name] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1034D35  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push [ebp+Type]  +
push esi  +
push esi  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
cmp [ebp+var_AD8] esi +
jz loc_1035041  +
push offset aDefaulticon  +
push dword ptr [ebp+var_ABC]  +
lea eax [ebp+SubKey] +
push offset aSS  +
push ebx  +
push eax  +
mov [ebp+hKey] esi +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1034E82  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1034E6E  +
cmp [ebp+Type] 1 +
jz loc_1034E1C  +
cmp [ebp+Type] 2 +
jnz loc_1034E6E  +
lea eax [ebp+Name] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1034E25  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push [ebp+Type]  +
push esi  +
push esi  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
mov [ebp+hKey] 1 +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
cmp [ebp+hKey] esi +
jnz loc_1034E8F  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call sub_102F8CE  +
push offset aClsid  +
push dword ptr [ebp+var_ABC]  +
lea eax [ebp+SubKey] +
push offset aSS  +
push ebx  +
push eax  +
mov [ebp+hKey] 1 +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1035041  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMplayer2_set  +
push [ebp+phkResult]  +
mov [ebp+cbName] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1035020  +
cmp [ebp+Type] 1 +
jnz loc_1035020  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+var_7C4] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push esi  +
push [ebp+phkResult]  +
mov [ebp+cbName] 12Ch +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1035020  +
cmp [ebp+Type] 1 +
jnz loc_1035020  +
lea eax [ebp+var_7C4] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1035020  +
lea eax [ebp+Name] +
push eax  +
lea eax [ebp+var_7C4] +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1035020  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+var_7C4] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
mov [ebp+cbName] 12Ch +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103501A  +
cmp [ebp+Type] 1 +
jnz loc_103501A  +
lea eax [ebp+Name] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1034FDD  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push 1  +
push esi  +
push esi  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push offset aMplayer2_bak  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
jmp loc_1035020  +
mov [ebp+hKey] esi +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
cmp [ebp+hKey] esi +
jnz loc_1035041  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call sub_102F8CE  +
push dword ptr [ebp+var_ABC]  +
lea eax [ebp+SubKey] +
push offset aSShell  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+phkResult] +
push eax  +
push 20019h  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push edi  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10350C0  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push esi  +
push [ebp+phkResult]  +
mov [ebp+cbName] 122h +
call ds:RegEnumKeyExW  +
test eax eax +
jz loc_10350B0  +
mov eax [ebp+var_AE0] +
mov [eax] esi +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
jmp loc_10350C0  +
mov [ebx] esi +
pop edi  +
mov ecx [ebp+var_4] +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 80Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov ecx [ebp+arg_4] +
mov eax [ebp+arg_0] +
push ebx  +
push esi  +
push edi  +
mov [ebp+var_80C] ecx +
mov ecx [ebp+arg_8] +
xor esi esi +
xor ebx ebx +
inc ebx  +
push eax  +
mov dword ptr [ebp+lpSubKey] eax +
mov [ebp+var_7F8] ecx +
mov [ebp+hKey] esi +
mov [ebp+cbData] esi +
mov [ebp+var_804] esi +
mov edi ebx +
call sub_10326B2  +
mov [ebp+var_808] eax +
lea eax [ebp+hKey] +
push eax  +
push 2001Fh  +
push esi  +
push dword ptr [ebp+lpSubKey]  +
mov [ebp+Type] ebx +
push 80000000h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_103546B  +
mov [ebp+cbData] 190h +
cmp [ebp+var_808] esi +
jz loc_10351BA  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMp2_last  +
push [ebp+hKey]  +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10351BA  +
cmp [ebp+Type] ebx +
jnz loc_10351BA  +
lea eax [ebp+Data] +
push offset aDefault  +
push eax  +
call ds:_wcsicmp  +
mov edi eax +
neg edi  +
pop ecx  +
sbb edi edi +
pop ecx  +
inc edi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push esi  +
push [ebp+hKey]  +
mov [ebp+cbData] 190h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1035224  +
cmp [ebp+Type] ebx +
jnz loc_1035224  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1035224  +
lea eax [ebp+var_7FC] +
push eax  +
push [ebp+var_7F8]  +
lea eax [ebp+Data] +
push eax  +
mov [ebp+var_7FC] ebx +
call sub_1033E89  +
jmp loc_103522A  +
mov [ebp+var_7FC] esi +
cmp edi esi +
jz loc_103523A  +
cmp [ebp+var_7FC] esi +
jnz loc_10352F8  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
mov edi offset aMplayer2_bak +
push edi  +
push [ebp+hKey]  +
mov [ebp+cbData] 190h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10352F8  +
cmp [ebp+Type] ebx +
jnz loc_10352F8  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_10352F8  +
lea eax [ebp+var_808] +
push eax  +
push [ebp+var_7F8]  +
lea eax [ebp+Data] +
push eax  +
mov [ebp+var_808] ebx +
call sub_1033E89  +
cmp [ebp+var_808] esi +
jz loc_10352F8  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_10352BC  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push ebx  +
push esi  +
push esi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
push edi  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
mov [ebp+var_7FC] ebx +
lea eax [ebp+Data] +
cmp [ebp+var_80C] esi +
jz loc_1035319  +
push [ebp+var_80C]  +
push 0C7h  +
push eax  +
call sub_1027E68  +
jmp loc_1035332  +
push dword ptr [ebp+lpSubKey]  +
push offset aSfile  +
push 0C7h  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+var_804] +
push eax  +
push [ebp+var_7F8]  +
lea eax [ebp+Data] +
push eax  +
call sub_1033E89  +
cmp [ebp+var_7FC] esi +
jnz loc_1035393  +
cmp [ebp+var_804] esi +
jz loc_1035393  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1035364  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push ebx  +
push esi  +
push esi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
mov [ebp+var_7FC] ebx +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp [ebp+var_7FC] esi +
jnz loc_103546B  +
lea eax [ebp+hKey] +
push eax  +
push ebx  +
push esi  +
push dword ptr [ebp+lpSubKey]  +
mov [ebp+var_7F8] ebx +
push 80000000h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_103545B  +
mov edi ds:RegQueryValueExW +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aPerceivedtype  +
push [ebp+hKey]  +
mov [ebp+cbData] 190h +
call edi  +
test eax eax +
jnz loc_1035410  +
mov [ebp+var_7F8] esi +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aGeneric  +
push [ebp+hKey]  +
mov [ebp+cbData] 190h +
call edi  +
test eax eax +
jnz loc_1035447  +
mov [ebp+var_7F8] esi +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp [ebp+var_7F8] esi +
jz loc_103546B  +
push dword ptr [ebp+lpSubKey]  +
push 80000000h  +
call sub_102F8CE  +
push 103h  +
lea eax [ebp+FileName] +
push eax  +
call ds:GetWindowsDirectoryW  +
test eax eax +
jz loc_103566C  +
push offset aSystem_ini  +
mov edi 104h +
push edi  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
lea eax [ebp+FileName] +
push eax  +
push edi  +
lea eax [ebp+SubKey] +
push eax  +
push lpDefault  +
push offset KeyName  +
push offset AppName  +
call ds:GetPrivateProfileStringW  +
test eax eax +
jz loc_10354FC  +
lea eax [ebp+SubKey] +
push eax  +
push lpDefault  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_10354FC  +
lea eax [ebp+SubKey] +
push offset aMciqtz32_dll  +
push eax  +
call ds:wcsstr  +
pop ecx  +
pop ecx  +
mov [ebp+var_7F8] esi +
test eax eax +
jz loc_1035502  +
mov [ebp+var_7F8] ebx +
lea eax [ebp+FileName] +
push eax  +
push edi  +
lea eax [ebp+SubKey] +
push eax  +
push lpDefault  +
push offset aMpegvideo2  +
push offset AppName  +
call ds:GetPrivateProfileStringW  +
test eax eax +
jz loc_1035562  +
lea eax [ebp+SubKey] +
push eax  +
push lpDefault  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1035562  +
lea eax [ebp+SubKey] +
push offset aMciqtz32_dll  +
push eax  +
call ds:wcsstr  +
pop ecx  +
pop ecx  +
mov [ebp+var_7FC] esi +
test eax eax +
jz loc_1035568  +
mov [ebp+var_7FC] ebx +
cmp [ebp+var_7F8] esi +
jnz loc_103557C  +
cmp [ebp+var_7FC] esi +
jz loc_103566C  +
mov eax dword ptr [ebp+lpSubKey] +
add eax 2 +
push eax  +
push 103h  +
lea eax [ebp+SubKey] +
push eax  +
call sub_1027E68  +
mov edi ds:GetProfileStringW +
push 122h  +
lea eax [ebp+ReturnedString] +
push eax  +
push lpDefault  +
lea eax [ebp+SubKey] +
push eax  +
push offset aMciExtensions_  +
call edi  +
test eax eax +
jz loc_103566C  +
lea eax [ebp+ReturnedString] +
push eax  +
push lpDefault  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103566C  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push offset aMciExtensions_  +
call ds:WriteProfileStringW  +
push 122h  +
lea eax [ebp+ReturnedString] +
push eax  +
push lpDefault  +
lea eax [ebp+SubKey] +
push eax  +
push offset aMciExtensions  +
call edi  +
test eax eax +
jz loc_103566C  +
cmp [ebp+var_7F8] esi +
jz loc_1035639  +
lea eax [ebp+ReturnedString] +
push eax  +
push offset KeyName  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1035659  +
cmp [ebp+var_7FC] esi +
jz loc_103566C  +
lea eax [ebp+ReturnedString] +
push eax  +
push offset aMpegvideo2  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_103566C  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push offset aMciExtensions  +
call ds:WriteProfileStringW  +
push dword ptr [ebp+lpSubKey]  +
lea eax [ebp+SubKey] +
push offset aSoftwareMic_13  +
push 103h  +
push eax  +
mov [ebp+var_804] ebx +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+hKey] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1035844  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+ReturnedString] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMplayer2_set  +
push [ebp+hKey]  +
mov edi 244h +
mov [ebp+cbData] edi +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103580E  +
cmp [ebp+Type] ebx +
jnz loc_103580E  +
lea eax [ebp+ReturnedString] +
push offset aYes  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_103580E  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+ReturnedString] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push esi  +
push [ebp+hKey]  +
mov [ebp+Type] ebx +
mov [ebp+cbData] edi +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103580E  +
cmp [ebp+Type] ebx +
jnz loc_103580E  +
lea eax [ebp+ReturnedString] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_103580E  +
lea eax [ebp+ReturnedString] +
push offset aClsid05589fa1C  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_103580E  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+ReturnedString] +
push eax  +
lea eax [ebp+Type] +
push eax  +
mov [ebp+cbData] edi +
push esi  +
mov edi offset aMplayer2_bak +
push edi  +
push [ebp+hKey]  +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1035808  +
cmp [ebp+Type] ebx +
jnz loc_1035808  +
lea eax [ebp+ReturnedString] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_10357D0  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+ReturnedString] +
push eax  +
push ebx  +
push esi  +
push esi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
push edi  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
jmp loc_103580E  +
mov [ebp+var_804] esi +
push offset aMplayer2_set  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp [ebp+var_804] esi +
jnz loc_1035844  +
lea eax [ebp+SubKey] +
push eax  +
push 80000002h  +
call sub_102F8CE  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 0C90h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
mov esi [ebp+arg_4] +
mov eax [esi+34h] +
mov edx [esi] +
push edi  +
xor edi edi +
push edx  +
mov [ebp+hKey] edi +
mov [ebp+cbData] edi +
mov [ebp+Type] 1 +
mov [ebp+var_C84] eax +
call sub_10313BF  +
test eax eax +
jz loc_1036255  +
push dword ptr [esi+8]  +
call sub_10313BF  +
test eax eax +
jz loc_1036255  +
push ebx  +
push edx  +
call sub_10316CD  +
push dword ptr [esi+20h]  +
call sub_10313BF  +
test eax eax +
jz loc_1035A84  +
push 122h  +
lea eax [ebp+FileName] +
push eax  +
call ds:GetWindowsDirectoryW  +
test eax eax +
jz loc_1035A84  +
push offset aSystem_ini  +
push 122h  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
push dword ptr [esi+20h]  +
push offset aSequencer  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
mov ebx eax +
lea eax [ebp+FileName] +
push eax  +
push 104h  +
lea eax [ebp+KeyName] +
push eax  +
push lpDefault  +
neg ebx  +
push dword ptr [esi+20h]  +
sbb ebx ebx +
push offset AppName  +
neg ebx  +
call ds:GetPrivateProfileStringW  +
test eax eax +
jz loc_103598F  +
lea eax [ebp+KeyName] +
push offset aMciqtz32_dll  +
push eax  +
call ds:wcsstr  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_103598C  +
push dword ptr [esi+20h]  +
push offset aSequencer  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1035A84  +
lea eax [ebp+KeyName] +
push eax  +
push lpDefault  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1035A84  +
xor ebx ebx +
inc ebx  +
cmp ebx edi +
jz loc_1035A84  +
push dword ptr [esi+20h]  +
push offset aSequencer  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_10359DD  +
push offset aMciqtz32_dll  +
push 103h  +
lea eax [ebp+KeyName] +
push eax  +
call sub_1027E68  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+KeyName] +
push eax  +
push dword ptr [esi+20h]  +
push offset AppName  +
call ds:WritePrivateProfileStringW  +
mov eax [esi] +
inc eax  +
inc eax  +
push eax  +
push 103h  +
lea eax [ebp+KeyName] +
push eax  +
call sub_1027E68  +
push 122h  +
lea eax [ebp+Data] +
push eax  +
push lpDefault  +
lea eax [ebp+KeyName] +
push eax  +
mov ebx offset aMciExtensions +
push ebx  +
call ds:GetProfileStringW  +
test eax eax +
jz loc_1035A60  +
lea eax [ebp+Data] +
push eax  +
push lpDefault  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1035A60  +
lea eax [ebp+Data] +
push eax  +
push offset aMpegvideo2  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1035A84  +
push dword ptr [esi+20h]  +
lea eax [ebp+KeyName] +
push eax  +
push ebx  +
call ds:WriteProfileStringW  +
jmp loc_1035A84  +
push dword ptr [esi+20h]  +
lea eax [ebp+KeyName] +
push eax  +
push ebx  +
mov ebx ds:WriteProfileStringW +
call ebx  +
push dword ptr [esi+20h]  +
lea eax [ebp+KeyName] +
push eax  +
push offset aMciExtensions_  +
call ebx  +
push edi  +
push edi  +
push edi  +
push 6  +
call sub_102FFFB  +
mov ebx 0C7h +
test eax eax +
jnz loc_1035AE7  +
push off_103F070  +
lea eax [ebp+SubKey] +
push dword ptr [esi]  +
push offset aSOpenwithlistS  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 14h +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1035AE7  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push dword ptr [esi]  +
lea eax [ebp+SubKey] +
push offset aSOpenwithprogi  +
push ebx  +
push eax  +
call sub_1027F64  +
mov ebx ds:RegSetValueExW +
add esp 10h +
test eax eax +
jl loc_1035B4A  +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1035B4A  +
push edi  +
push edi  +
push edi  +
push edi  +
push dword ptr [esi+8]  +
push [ebp+hKey]  +
call ebx  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aApplicationsWm  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1035B8F  +
push 2  +
push offset byte_1002720  +
push 1  +
push edi  +
push dword ptr [esi]  +
push [ebp+hKey]  +
call ebx  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push dword ptr [esi]  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1036254  +
push dword ptr [esi+0Ch]  +
mov [ebp+phkResult] edi +
call sub_10313BF  +
test eax eax +
jz loc_1035C3B  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push offset aContentType  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1035C05  +
cmp [ebp+Type] 1 +
jz loc_1035C3B  +
mov ecx [esi+0Ch] +
mov eax ecx +
lea edx [eax+2] +
mov [ebp+var_C88] edx +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_1035C13  +
sub eax [ebp+var_C88] +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aContentType  +
push [ebp+hKey]  +
call ebx  +
push dword ptr [esi+10h]  +
call sub_10313BF  +
test eax eax +
jz loc_1035CBB  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push offset aPerceivedtype  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1035C85  +
cmp [ebp+Type] 1 +
jz loc_1035CBB  +
mov ecx [esi+10h] +
mov eax ecx +
lea edx [eax+2] +
mov [ebp+var_C88] edx +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_1035C93  +
sub eax [ebp+var_C88] +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aPerceivedtype  +
push [ebp+hKey]  +
call ebx  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push edi  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1036145  +
cmp [ebp+Type] 1 +
jnz loc_1036145  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1036145  +
push dword ptr [esi]  +
call sub_10326B2  +
test eax eax +
jnz loc_1035D52  +
push dword ptr [esi+8]  +
lea eax [ebp+Data] +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1035D3B  +
push 10h  +
push offset aDefault  +
jmp loc_1035D42  +
push 0Eh  +
push offset aCustom  +
push 1  +
push edi  +
push offset aMp2_last  +
push [ebp+hKey]  +
call ebx  +
cmp [ebp+var_C84] edi +
jnz loc_1036177  +
lea eax [ebp+Data] +
push eax  +
push offset aSShellOpenComm  +
lea eax [ebp+KeyName] +
push 103h  +
push eax  +
mov [ebp+var_C90] 1 +
mov [ebp+var_C88] edi +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push edi  +
lea eax [ebp+KeyName] +
push eax  +
push 80000000h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1035E2D  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push edi  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1035E22  +
cmp [ebp+Type] 1 +
jz loc_1035DF4  +
cmp [ebp+Type] 2 +
jnz loc_1035E22  +
lea eax [ebp+Src] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1035E22  +
lea ecx [ebp+Src] +
push ecx  +
push dword ptr [esi]  +
xor eax eax +
inc eax  +
push eax  +
mov [ebp+var_C88] eax +
call sub_1032084  +
mov [ebp+var_C90] eax +
push [ebp+phkResult]  +
jmp loc_1035EE3  +
push dword ptr [esi]  +
lea eax [ebp+var_A30] +
push lpSubKey  +
mov [ebp+var_C84] edi +
push offset aSExtensionsS  +
push 104h  +
push eax  +
call sub_1027F64  +
add esp 14h +
test eax eax +
jl loc_1035EF5  +
lea eax [ebp+var_C84] +
push eax  +
push 1  +
push edi  +
lea eax [ebp+var_A30] +
push eax  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1035EF5  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_A30] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push offset aDisableextensi  +
push [ebp+var_C84]  +
mov [ebp+cbData] 20Ah +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1035EDD  +
cmp [ebp+Type] 1 +
jnz loc_1035EDD  +
lea eax [ebp+var_A30] +
push offset aYes  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1035EDD  +
push [ebp+var_C84]  +
jmp loc_103613A  +
push [ebp+var_C84]  +
call ds:RegCloseKey  +
cmp [ebp+var_C90] edi +
jz loc_1036089  +
lea eax [ebp+Data] +
push eax  +
push offset aSShell  +
lea eax [ebp+KeyName] +
push 103h  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+phkResult] +
push eax  +
push 1  +
push edi  +
lea eax [ebp+KeyName] +
push eax  +
push 80000000h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1036081  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push edi  +
push [ebp+phkResult]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1036075  +
cmp [ebp+Type] 1 +
jnz loc_1036075  +
lea eax [ebp+Src] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1036075  +
lea eax [ebp+Src] +
push offset aOpen  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1036075  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push offset aSShellSCommand  +
lea eax [ebp+KeyName] +
push 103h  +
push eax  +
mov [ebp+var_C84] edi +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+var_C84] +
push eax  +
push 1  +
push edi  +
lea eax [ebp+KeyName] +
push eax  +
push 80000000h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1036075  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push edi  +
push [ebp+var_C84]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1036069  +
cmp [ebp+Type] 1 +
jz loc_103603B  +
cmp [ebp+Type] 2 +
jnz loc_1036069  +
lea eax [ebp+Src] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_1036069  +
lea ecx [ebp+Src] +
push ecx  +
push dword ptr [esi]  +
xor eax eax +
inc eax  +
push eax  +
mov [ebp+var_C88] eax +
call sub_1032084  +
mov [ebp+var_C90] eax +
push [ebp+var_C84]  +
call ds:RegCloseKey  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
cmp [ebp+var_C90] edi +
jnz loc_1036095  +
cmp [ebp+var_C88] edi +
jnz loc_1036124  +
push dword ptr [esi+8]  +
lea eax [ebp+Data] +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_10360DE  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_10360B4  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push offset aMplayer2_bak  +
push [ebp+hKey]  +
call ebx  +
mov ecx [esi+8] +
mov eax ecx +
lea edx [eax+2] +
mov [ebp+var_C84] edx +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_10360EC  +
sub eax [ebp+var_C84] +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push edi  +
push [ebp+hKey]  +
call ebx  +
push dword ptr [esi+8]  +
lea eax [ebp+Data] +
push 121h  +
push eax  +
call sub_1027E68  +
cmp [ebp+var_C90] edi +
jnz loc_1036177  +
cmp [ebp+var_C88] edi +
jz loc_1036177  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
jmp loc_1036254  +
mov ecx [esi+8] +
mov eax ecx +
lea edx [eax+2] +
mov [ebp+var_C88] edx +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_1036153  +
sub eax [ebp+var_C88] +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push edi  +
push [ebp+hKey]  +
call ebx  +
push [ebp+hKey]  +
mov ebx ds:RegCloseKey +
call ebx  +
mov edx [esi+0Ch] +
push edx  +
call sub_10313BF  +
test eax eax +
jz loc_1036254  +
push offset aAudioXPnRealau  +
push edx  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_1036254  +
push dword ptr [esi]  +
lea eax [ebp+KeyName] +
push offset aSoftwareMic_13  +
push 103h  +
push eax  +
call sub_1027F64  +
add esp 10h +
push edi  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
lea eax [ebp+KeyName] +
push eax  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1036254  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push edi  +
push edi  +
push [ebp+hKey]  +
mov [ebp+cbData] 244h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103624C  +
cmp [ebp+Type] 1 +
jnz loc_103624C  +
lea eax [ebp+Data] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_103624C  +
lea eax [ebp+Data] +
push offset aClsid05589fa1C  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
push [ebp+hKey]  +
call ebx  +
pop ebx  +
mov ecx [ebp+var_4] +
pop edi  +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 428h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax dword ptr [ebp+arg_0] +
push ebx  +
push esi  +
push edi  +
push eax  +
push offset aSShellEnqueueC  +
mov dword ptr [ebp+var_428] eax +
mov edi 103h +
xor esi esi +
lea eax [ebp+SubKey] +
push edi  +
push eax  +
mov [ebp+hKey] esi +
mov [ebp+var_415] 0 +
mov [ebp+cbData] esi +
mov [ebp+Type] esi +
call sub_1027F64  +
mov ebx ds:RegOpenKeyExW +
add esp 10h +
lea eax [ebp+hKey] +
push eax  +
push 20019h  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
mov esi 80000000h +
push esi  +
call ebx  +
test eax eax +
jnz loc_1036395  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aDelegateexecut  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1036349  +
cmp [ebp+Type] 1 +
jnz loc_1036349  +
lea eax [ebp+Data] +
push eax  +
push offset a45597c9880f645  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1036349  +
mov [ebp+var_415] 1 +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp [ebp+var_415] 0 +
jz loc_1036395  +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
call ds:RegDeleteKeyW  +
push dword ptr [ebp+var_428]  +
lea eax [ebp+SubKey] +
push offset aSShellEnqueue  +
push edi  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
call ds:RegDeleteKeyW  +
push dword ptr [ebp+var_428]  +
lea eax [ebp+SubKey] +
push offset aSShellPlayComm  +
push edi  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+hKey] +
push eax  +
push 20019h  +
push 0  +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
mov [ebp+var_415] 0 +
call ebx  +
test eax eax +
jnz loc_103647F  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aDelegateexecut  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1036435  +
cmp [ebp+Type] 1 +
jnz loc_1036435  +
lea eax [ebp+Data] +
push eax  +
push offset aEd1d0fdf441447  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1036435  +
mov [ebp+var_415] 1 +
push [ebp+hKey]  +
call ds:RegCloseKey  +
cmp [ebp+var_415] 0 +
jz loc_103647F  +
mov ebx ds:RegDeleteKeyW +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
call ebx  +
push dword ptr [ebp+var_428]  +
lea eax [ebp+SubKey] +
push offset aSShellPlay  +
push edi  +
push eax  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+SubKey] +
push eax  +
push esi  +
call ebx  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 2A4h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
push edi  +
mov edi ds:RegOpenKeyExW +
xor esi esi +
lea eax [ebp+hKey] +
push eax  +
mov ebx 2001Fh +
push ebx  +
push esi  +
push lpSubKey  +
mov [ebp+phkResult] esi +
push 80000002h  +
mov [ebp+hKey] esi +
mov [ebp+cbData] esi +
mov [ebp+cbName] esi +
mov [ebp+dwIndex] esi +
call edi  +
test eax eax +
jnz loc_103663C  +
lea eax [ebp+phkResult] +
push eax  +
push ebx  +
push esi  +
push offset aExtensions_0  +
push [ebp+hKey]  +
mov [ebp+var_29C] esi +
call edi  +
test eax eax +
jnz loc_1036630  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push esi  +
jmp loc_1036606  +
inc [ebp+dwIndex]  +
lea eax [ebp+var_29C] +
push eax  +
push ebx  +
push esi  +
lea eax [ebp+Name] +
push eax  +
push [ebp+phkResult]  +
call edi  +
test eax eax +
jnz loc_10365EE  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push esi  +
push esi  +
push offset aSpdhandler  +
push [ebp+var_29C]  +
mov [ebp+cbData] 80h +
call ds:RegQueryValueExW  +
test eax eax +
jz loc_10365D3  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push esi  +
push esi  +
push offset aExtension_hand  +
push [ebp+var_29C]  +
mov [ebp+cbData] 80h +
call ds:RegQueryValueExW  +
test eax eax +
jz loc_10365D3  +
lea eax [ebp+Name] +
push eax  +
push offset aWmp11_assocfil  +
lea eax [ebp+Data] +
push 3Fh  +
push eax  +
call sub_1027F64  +
add esp 10h +
push [ebp+arg_0]  +
lea eax [ebp+Data] +
push eax  +
call sub_1031D94  +
push [ebp+var_29C]  +
call ds:RegCloseKey  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push [ebp+dwIndex]  +
push [ebp+phkResult]  +
mov [ebp+cbName] 104h +
call ds:RegEnumKeyExW  +
test eax eax +
jz loc_1036532  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov esi [ebp+arg_0] +
push esi  +
push offset phkResult  +
call sub_1031D94  +
push esi  +
push offset stru_10070FC  +
call sub_1031D94  +
push esi  +
push offset stru_10070E4  +
call sub_1031D94  +
push esi  +
push offset stru_10070BC  +
call sub_1031D94  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 430h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
push edi  +
xor esi esi +
push esi  +
lea eax [ebp+phkResult] +
push eax  +
push esi  +
mov edi 2001Fh +
push edi  +
push esi  +
push esi  +
push esi  +
push offset aSoftwareMic_27  +
mov ebx 80000002h +
push ebx  +
mov [ebp+var_418] esi +
mov [ebp+hKey] esi +
mov [ebp+var_41C] esi +
mov [ebp+phkResult] esi +
mov [ebp+cbData] esi +
mov [ebp+cbName] esi +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103681C  +
lea eax [ebp+hKey] +
push eax  +
push edi  +
mov edi ds:RegOpenKeyExW +
push esi  +
push offset aSoftwareMic_14  +
push ebx  +
call edi  +
test eax eax +
jnz loc_103680E  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
mov [ebp+dwIndex] esi +
push esi  +
jmp loc_10367E4  +
inc [ebp+dwIndex]  +
lea eax [ebp+var_41C] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+Name] +
push eax  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jnz loc_10367CC  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push esi  +
push esi  +
push offset aMswmdmhandler  +
push [ebp+var_41C]  +
mov [ebp+cbData] 208h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_10367C0  +
lea eax [ebp+Name] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1036785  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push 1  +
push esi  +
push eax  +
push [ebp+phkResult]  +
call ds:RegSetValueExW  +
push offset aMswmdmhandler  +
push [ebp+var_41C]  +
call ds:RegDeleteValueW  +
push [ebp+var_41C]  +
call ds:RegCloseKey  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+Name] +
push eax  +
push [ebp+dwIndex]  +
push [ebp+hKey]  +
mov [ebp+cbName] 104h +
call ds:RegEnumKeyExW  +
test eax eax +
jz loc_1036727  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
jmp loc_1036822  +
mov edi ds:RegOpenKeyExW +
lea eax [ebp+hKey] +
push eax  +
push 20006h  +
push esi  +
push offset aSoftwareMic_28  +
push ebx  +
call edi  +
test eax eax +
jnz loc_10368C1  +
lea eax [ebp+var_41C] +
push eax  +
push 20006h  +
push esi  +
push offset a4ad2c85e5e2d45  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jnz loc_103687A  +
push offset aMswmdmhandler  +
push [ebp+var_41C]  +
call ds:RegDeleteValueW  +
push [ebp+var_41C]  +
call ds:RegCloseKey  +
lea eax [ebp+var_41C] +
push eax  +
push 20006h  +
push esi  +
push offset a9261b03c3d7845  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jnz loc_10368B5  +
push offset aMswmdmhandler  +
push [ebp+var_41C]  +
call ds:RegDeleteValueW  +
push [ebp+var_41C]  +
call ds:RegCloseKey  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov esi ds:RegDeleteKeyW +
push offset aSystemfileasso  +
mov edi 80000000h +
push edi  +
call esi  +
push offset aSystemfileas_0  +
push edi  +
call esi  +
push offset aSystemfileas_1  +
push edi  +
call esi  +
push offset aSystemfileas_2  +
push edi  +
call esi  +
push offset aSystemfileas_3  +
push edi  +
call esi  +
push offset aSystemfileas_4  +
push edi  +
call esi  +
push offset aSystemfileas_5  +
push edi  +
call esi  +
push offset aStack_audioShe  +
push edi  +
call esi  +
push offset aStack_videoShe  +
push edi  +
call esi  +
push offset aStack_imageShe  +
push edi  +
call esi  +
push offset aNetworkexplore  +
push edi  +
call esi  +
push offset aNetworkexplo_0  +
push edi  +
call esi  +
push offset aSystemfileas_6  +
call sub_103626A  +
push offset aSystemfileas_7  +
call sub_103626A  +
push offset aSystemfileas_8  +
call sub_103626A  +
push offset aSystemfileas_9  +
call sub_103626A  +
push offset aSystemfilea_10  +
call sub_103626A  +
push offset phkResult  +
call sub_103626A  +
push offset stru_10070FC  +
call sub_103626A  +
push offset stru_10070E4  +
call sub_103626A  +
push 1  +
call sub_1036495  +
mov edi ds:RegOpenKeyExW +
lea eax [ebp+var_418] +
push eax  +
push 2001Fh  +
push 0  +
push offset aSoftwareMic_15  +
push ebx  +
call edi  +
test eax eax +
jnz loc_10369C0  +
push offset aMsplaycdaudioo  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
lea eax [ebp+var_418] +
push eax  +
push 2001Fh  +
push 0  +
push offset aSoftwareMic_12  +
push ebx  +
call edi  +
test eax eax +
jnz loc_10369F7  +
push offset aMsplaydvdmovie  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
lea eax [ebp+var_418] +
push eax  +
push 2001Fh  +
push 0  +
push offset aSoftwareMic_16  +
push ebx  +
call edi  +
test eax eax +
jnz loc_1036A2E  +
push offset aMsplaysupervid  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
lea eax [ebp+var_418] +
push eax  +
push 2001Fh  +
push 0  +
push offset aSoftwareMic_17  +
push ebx  +
call edi  +
test eax eax +
jnz loc_1036A65  +
push offset aMsplayvideocdm  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
lea eax [ebp+var_418] +
push eax  +
push 2001Fh  +
push 0  +
push offset aSoftwareMic_18  +
push ebx  +
call edi  +
test eax eax +
jnz loc_1036A9C  +
push offset aMswmpburncdona  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
lea eax [ebp+var_418] +
push eax  +
push 2001Fh  +
push 0  +
push offset aSoftwareMic_19  +
push ebx  +
call edi  +
test eax eax +
jnz loc_1036AD3  +
push offset aMsplaymediaona  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
lea eax [ebp+var_418] +
push eax  +
push 2001Fh  +
push 0  +
push offset aSoftwareMic_20  +
push ebx  +
call edi  +
test eax eax +
jnz loc_1036B0A  +
push offset aMsplaymediaona  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
push offset aSoftwareMic_21  +
push ebx  +
call esi  +
push offset aSoftwareMic_25  +
push ebx  +
call esi  +
push offset aSoftwareMic_22  +
push ebx  +
call esi  +
push offset aSoftwareMic_24  +
push ebx  +
call esi  +
push offset aSoftwareMic_23  +
push ebx  +
call esi  +
push offset aSoftwareMic_26  +
push ebx  +
call esi  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 41Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax dword ptr [ebp+arg_0] +
push ebx  +
push esi  +
push edi  +
push eax  +
push offset aSShellEnqueue  +
mov dword ptr [ebp+var_41C] eax +
mov ebx 103h +
lea eax [ebp+SubKey] +
push ebx  +
xor esi esi +
push eax  +
mov [ebp+hKey] esi +
call sub_1027F64  +
add esp 10h +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000000h  +
call ds:RegCreateKeyExW  +
mov edi ds:RegSetValueExW +
test eax eax +
jnz loc_1036C71  +
push offset aAddToWindowsMe  +
push ebx  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1036C05  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1036BDF  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push esi  +
push esi  +
push [ebp+hKey]  +
call edi  +
push offset a@SystemrootS_0  +
push ebx  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1036C4E  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1036C24  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 2  +
push esi  +
push offset aMuiverb  +
push [ebp+hKey]  +
call edi  +
push 2  +
push offset byte_1002720  +
push 1  +
push esi  +
push offset aNeverdefault  +
push [ebp+hKey]  +
call edi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push dword ptr [ebp+var_41C]  +
lea eax [ebp+SubKey] +
push offset aSShellEnqueueC  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1036D05  +
push offset a45597c9880f645  +
push ebx  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1036CF9  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1036CCF  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push esi  +
push offset aDelegateexecut  +
push [ebp+hKey]  +
call edi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push dword ptr [ebp+var_41C]  +
lea eax [ebp+SubKey] +
push offset aSShellPlay  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1036DF9  +
push offset aPlayWithWindow  +
push ebx  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1036D8D  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1036D67  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push esi  +
push esi  +
push [ebp+hKey]  +
call edi  +
push offset a@SystemrootS_1  +
push ebx  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1036DD6  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1036DAC  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 2  +
push esi  +
push offset aMuiverb  +
push [ebp+hKey]  +
call edi  +
push 2  +
push offset byte_1002720  +
push 1  +
push esi  +
push offset aNeverdefault  +
push [ebp+hKey]  +
call edi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push dword ptr [ebp+var_41C]  +
lea eax [ebp+SubKey] +
push offset aSShellPlayComm  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
push esi  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1036E8D  +
push offset aEd1d0fdf441447  +
push ebx  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1036E81  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_1036E57  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push esi  +
push offset aDelegateexecut  +
push [ebp+hKey]  +
call edi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 424h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push edi  +
xor edi edi +
mov [ebp+phkResult] edi +
mov [ebp+hKey] edi +
call sub_103133C  +
test eax eax +
jnz loc_1037D2D  +
push ebx  +
push esi  +
call sub_10313E2  +
mov esi ds:RegSetValueExW +
mov ebx ds:RegCreateKeyExW +
test eax eax +
jz loc_1036F61  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSystemfileasso  +
push 80000000h  +
call ebx  +
test eax eax +
jnz loc_1036F61  +
push offset a8a734961C4aa47  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1036F55  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1036F2F  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSystemfileas_0  +
push 80000000h  +
call ebx  +
test eax eax +
jnz loc_1036FD7  +
push offset a7ad8498587b44a  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1036FCB  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1036FA5  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSystemfileas_1  +
push 80000000h  +
call ebx  +
test eax eax +
jnz loc_103704D  +
push offset a7ad8498587b44a  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1037041  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103701B  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSystemfileas_2  +
push 80000000h  +
call ebx  +
test eax eax +
jnz loc_10370C3  +
push offset a7ad8498587b44a  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_10370B7  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1037091  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSystemfileas_3  +
push 80000000h  +
call ebx  +
test eax eax +
jnz loc_1037139  +
push offset a7ad8498587b44a  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_103712D  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1037107  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSystemfileas_4  +
push 80000000h  +
call ebx  +
test eax eax +
jnz loc_10371AF  +
push offset a7ad8498587b44a  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_10371A3  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103717D  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSystemfileas_5  +
push 80000000h  +
call ebx  +
test eax eax +
jnz loc_1037225  +
push offset a7ad8498587b44a  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1037219  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_10371F3  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aStack_audioShe  +
push 80000000h  +
call ebx  +
test eax eax +
jnz loc_103729B  +
push offset a7ad8498587b44a  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_103728F  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1037269  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aStack_videoShe  +
push 80000000h  +
call ebx  +
test eax eax +
jnz loc_1037311  +
push offset a7ad8498587b44a  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1037305  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_10372DF  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aStack_imageShe  +
push 80000000h  +
call ebx  +
test eax eax +
jnz loc_1037387  +
push offset a7ad8498587b44a  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_103737B  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1037355  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aNetworkexplore  +
push 80000000h  +
call ebx  +
test eax eax +
jnz loc_10373FD  +
push offset aToggleDmrAutho  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_10373F1  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_10373CB  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aNetworkexplo_0  +
push 80000000h  +
call ebx  +
test eax eax +
jnz loc_1037473  +
push offset aOpenMediaShari  +
push 103h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1037467  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1037441  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push offset aSystemfileas_6  +
call sub_1036B4E  +
push offset aSystemfileas_7  +
call sub_1036B4E  +
push offset aSystemfileas_8  +
call sub_1036B4E  +
push offset aSystemfileas_9  +
call sub_1036B4E  +
push offset aSystemfilea_10  +
call sub_1036B4E  +
push offset phkResult  +
call sub_1036B4E  +
push offset stru_10070FC  +
call sub_1036B4E  +
push offset stru_10070E4  +
call sub_1036B4E  +
push edi  +
call sub_1036495  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_15  +
push 80000002h  +
call ds:RegCreateKeyExW  +
mov ebx offset byte_1002720 +
test eax eax +
jnz loc_1037512  +
push 2  +
push ebx  +
push 1  +
push edi  +
push offset aMsplaycdaudioo  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
call sub_1031E27  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_16  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103755B  +
push 2  +
push ebx  +
push 1  +
push edi  +
push offset aMsplaysupervid  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_17  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103759F  +
push 2  +
push ebx  +
push 1  +
push edi  +
push offset aMsplayvideocdm  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_18  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_10375E3  +
push 2  +
push ebx  +
push 1  +
push edi  +
push offset aMswmpburncdona  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_19  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1037627  +
push 2  +
push ebx  +
push 1  +
push edi  +
push offset aMsplaymediaona  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_20  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103766B  +
push 2  +
push ebx  +
push 1  +
push edi  +
push offset aMsplaymediaona  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_21  +
push 80000002h  +
call ds:RegCreateKeyExW  +
mov ebx offset aDefaulticon +
test eax eax +
jnz loc_1037710  +
push 24h  +
push offset a@wmploc_dll6_0  +
push 1  +
push edi  +
push offset aAction  +
push [ebp+phkResult]  +
call esi  +
push 24h  +
push offset Data  +
push 1  +
push edi  +
push offset aProvider  +
push [ebp+phkResult]  +
call esi  +
push 18h  +
push offset aWmp_audiocd  +
push 1  +
push edi  +
push offset aInvokeprogid  +
push [ebp+phkResult]  +
call esi  +
push 0Ah  +
push offset aPlay  +
push 1  +
push edi  +
push offset aInvokeverb  +
push [ebp+phkResult]  +
call esi  +
push 66h  +
push offset aProgramfiles_4  +
push 2  +
push edi  +
push ebx  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_54  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_10377B0  +
push 24h  +
push offset a@wmploc_dll180  +
push 1  +
push edi  +
push offset aAction  +
push [ebp+phkResult]  +
call esi  +
push 24h  +
push offset Data  +
push 1  +
push edi  +
push offset aProvider  +
push [ebp+phkResult]  +
call esi  +
push 1Ch  +
push offset aWmp_playmedia  +
push 1  +
push edi  +
push offset aInvokeprogid  +
push [ebp+phkResult]  +
call esi  +
push 0Ah  +
push offset aPlay  +
push 1  +
push edi  +
push offset aInvokeverb  +
push [ebp+phkResult]  +
call esi  +
push 66h  +
push offset aProgramfiles_4  +
push 2  +
push edi  +
push ebx  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_22  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1037850  +
push 24h  +
push offset a@wmploc_dll6_1  +
push 1  +
push edi  +
push offset aAction  +
push [ebp+phkResult]  +
call esi  +
push 24h  +
push offset Data  +
push 1  +
push edi  +
push offset aProvider  +
push [ebp+phkResult]  +
call esi  +
push 10h  +
push offset aWmp_dvd  +
push 1  +
push edi  +
push offset aInvokeprogid  +
push [ebp+phkResult]  +
call esi  +
push 0Ah  +
push offset aPlay  +
push 1  +
push edi  +
push offset aInvokeverb  +
push [ebp+phkResult]  +
call esi  +
push 66h  +
push offset aProgramfiles_4  +
push 2  +
push edi  +
push ebx  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_23  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_10378F0  +
push 24h  +
push offset a@wmploc_dll6_2  +
push 1  +
push edi  +
push offset aAction  +
push [ebp+phkResult]  +
call esi  +
push 24h  +
push offset Data  +
push 1  +
push edi  +
push offset aProvider  +
push [ebp+phkResult]  +
call esi  +
push 10h  +
push offset aWmp_vcd  +
push 1  +
push edi  +
push offset aInvokeprogid  +
push [ebp+phkResult]  +
call esi  +
push 0Ah  +
push offset aPlay  +
push 1  +
push edi  +
push offset aInvokeverb  +
push [ebp+phkResult]  +
call esi  +
push 66h  +
push offset aProgramfiles_4  +
push 2  +
push edi  +
push ebx  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_24  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1037990  +
push 24h  +
push offset a@wmploc_dll6_3  +
push 1  +
push edi  +
push offset aAction  +
push [ebp+phkResult]  +
call esi  +
push 24h  +
push offset Data  +
push 1  +
push edi  +
push offset aProvider  +
push [ebp+phkResult]  +
call esi  +
push 10h  +
push offset aWmp_vcd  +
push 1  +
push edi  +
push offset aInvokeprogid  +
push [ebp+phkResult]  +
call esi  +
push 0Ah  +
push offset aPlay  +
push 1  +
push edi  +
push offset aInvokeverb  +
push [ebp+phkResult]  +
call esi  +
push 66h  +
push offset aProgramfiles_4  +
push 2  +
push edi  +
push ebx  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_25  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1037A30  +
push 24h  +
push offset a@wmploc_dll6_4  +
push 1  +
push edi  +
push offset aAction  +
push [ebp+phkResult]  +
call esi  +
push 24h  +
push offset Data  +
push 1  +
push edi  +
push offset aProvider  +
push [ebp+phkResult]  +
call esi  +
push 16h  +
push offset aWmp_burncd  +
push 1  +
push edi  +
push offset aInvokeprogid  +
push [ebp+phkResult]  +
call esi  +
push 0Ah  +
push offset aBurn  +
push 1  +
push edi  +
push offset aInvokeverb  +
push [ebp+phkResult]  +
call esi  +
push 66h  +
push offset aProgramfiles_4  +
push 2  +
push edi  +
push ebx  +
push [ebp+phkResult]  +
call esi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_26  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1037AE5  +
push 26h  +
push offset a@wmploc_dll293  +
push 1  +
push edi  +
push offset aAction  +
push [ebp+phkResult]  +
call esi  +
push 24h  +
push offset Data  +
push 1  +
push edi  +
push offset aProvider  +
push [ebp+phkResult]  +
call esi  +
push 4Eh  +
push offset a917782469be447  +
push 1  +
push edi  +
push offset aClsidforcancel  +
push [ebp+phkResult]  +
call esi  +
push 66h  +
push offset aProgramfiles_4  +
push 2  +
push edi  +
push ebx  +
push [ebp+phkResult]  +
call esi  +
push 16h  +
push offset aWmp_device  +
push 1  +
push edi  +
push offset aProgid  +
push [ebp+phkResult]  +
call esi  +
push offset aInitcmdline  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
lea eax [ebp+phkResult] +
push eax  +
push 2001Fh  +
push edi  +
push offset aSoftwareMic_27  +
push 80000002h  +
call ds:RegOpenKeyExW  +
mov ebx offset aMswmdmhandler +
test eax eax +
jnz loc_1037C22  +
lea eax [ebp+hKey] +
push eax  +
push 2001Fh  +
push edi  +
push offset aSoftwareMic_14  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1037C16  +
mov [ebp+var_41C] edi +
mov [ebp+cbValueName] 104h +
jmp loc_1037BE3  +
push edi  +
lea eax [ebp+var_41C] +
push eax  +
push edi  +
push 2001Fh  +
push edi  +
push edi  +
push edi  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+hKey]  +
mov [ebp+cbValueName] 104h +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_1037BE3  +
push offset byte_1002720  +
push 104h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1037BC4  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1037B9E  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push ebx  +
push [ebp+var_41C]  +
call esi  +
lea eax [ebp+ValueName] +
push eax  +
push [ebp+phkResult]  +
call ds:RegDeleteValueW  +
push [ebp+var_41C]  +
call ds:RegCloseKey  +
push edi  +
push edi  +
push edi  +
push edi  +
lea eax [ebp+cbValueName] +
push eax  +
lea eax [ebp+ValueName] +
push eax  +
push edi  +
push [ebp+phkResult]  +
call ds:RegEnumValueW  +
test eax eax +
jz loc_1037B49  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
lea eax [ebp+hKey] +
push eax  +
push 20006h  +
push edi  +
push offset aSoftwareMic_28  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1037D2B  +
push offset byte_1002720  +
push 104h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1037D1F  +
lea eax [ebp+var_41C] +
push eax  +
push 2  +
push edi  +
push offset a4ad2c85e5e2d45  +
push [ebp+hKey]  +
mov [ebp+var_41C] edi +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1037CC5  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1037C93  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push ebx  +
push [ebp+var_41C]  +
call esi  +
push [ebp+var_41C]  +
call ds:RegCloseKey  +
lea eax [ebp+var_41C] +
push eax  +
push 2  +
push edi  +
push offset a9261b03c3d7845  +
push [ebp+hKey]  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1037D1F  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_1037CED  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push edi  +
push ebx  +
push [ebp+var_41C]  +
call esi  +
push [ebp+var_41C]  +
call ds:RegCloseKey  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop esi  +
pop ebx  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop edi  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 0E0h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
push edi  +
mov edi ds:RegOpenKeyExW +
lea eax [ebp+hKey] +
push eax  +
xor esi esi +
mov ebx 2001Fh +
push ebx  +
push esi  +
push lpSubKey  +
mov [ebp+phkResult] esi +
push 80000002h  +
mov [ebp+hKey] esi +
call edi  +
test eax eax +
jnz loc_1037FF5  +
lea eax [ebp+phkResult] +
push eax  +
push ebx  +
push esi  +
push offset aMimeTypes_0  +
push [ebp+hKey]  +
mov [ebp+cbName] esi +
mov [ebp+var_DC] esi +
call edi  +
test eax eax +
jnz loc_1037E5C  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
mov [ebp+dwIndex] esi +
push esi  +
jmp loc_1037E36  +
inc [ebp+dwIndex]  +
lea eax [ebp+var_DC] +
push eax  +
push ebx  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+phkResult]  +
call edi  +
test eax eax +
jnz loc_1037E1E  +
lea eax [ebp+SubKey] +
push eax  +
call sub_103CC2D  +
push offset aUserapprovedow  +
push [ebp+var_DC]  +
call ds:RegDeleteValueW  +
push [ebp+var_DC]  +
call ds:RegCloseKey  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+dwIndex]  +
push [ebp+phkResult]  +
mov [ebp+cbName] 64h +
call ds:RegEnumKeyExW  +
test eax eax +
jz loc_1037DD3  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
cmp [ebp+arg_0] esi +
jnz loc_1037FE9  +
lea eax [ebp+phkResult] +
push eax  +
push ebx  +
push esi  +
push offset aProtocols  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jnz loc_1037F27  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
mov [ebp+dwIndex] esi +
push esi  +
jmp loc_1037F01  +
inc [ebp+dwIndex]  +
lea eax [ebp+var_DC] +
push eax  +
push ebx  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+phkResult]  +
call edi  +
test eax eax +
jnz loc_1037EE9  +
lea eax [ebp+SubKey] +
push eax  +
call sub_1032BE7  +
push offset aUserapprovedow  +
push [ebp+var_DC]  +
call ds:RegDeleteValueW  +
push [ebp+var_DC]  +
call ds:RegCloseKey  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+dwIndex]  +
push [ebp+phkResult]  +
mov [ebp+cbName] 64h +
call ds:RegEnumKeyExW  +
test eax eax +
jz loc_1037E9E  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
lea eax [ebp+phkResult] +
push eax  +
push ebx  +
push esi  +
push offset aDevices_0  +
push [ebp+hKey]  +
call edi  +
test eax eax +
jnz loc_1037FE9  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
mov [ebp+dwIndex] esi +
push esi  +
jmp loc_1037FC3  +
inc [ebp+dwIndex]  +
lea eax [ebp+var_DC] +
push eax  +
push ebx  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+phkResult]  +
call edi  +
test eax eax +
jnz loc_1037FAB  +
lea eax [ebp+SubKey] +
push eax  +
call sub_10317B8  +
push offset aUserapprovedow  +
push [ebp+var_DC]  +
call ds:RegDeleteValueW  +
push [ebp+var_DC]  +
call ds:RegCloseKey  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbName] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+dwIndex]  +
push [ebp+phkResult]  +
mov [ebp+cbName] 64h +
call ds:RegEnumKeyExW  +
test eax eax +
jz loc_1037F60  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
push offset aSoftwareMic_55  +
push 80000001h  +
call sub_102F8CE  +
push esi  +
push esi  +
push 3000h  +
push 8000000h  +
call ds:SHChangeNotify  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 4A8h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
mov esi [ebp+arg_0] +
lea eax [ebp+hKey] +
push eax  +
push 20019h  +
xor ebx ebx +
push ebx  +
push lpSubKey  +
mov [ebp+var_4A4] esi +
push 80000002h  +
mov [ebp+hKey] ebx +
mov [ebp+var_4A8] ebx +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10383C3  +
push offset aOpen_0  +
lea eax [esi+0Ch] +
push eax  +
mov [ebp+cbData] ebx +
mov [ebp+Type] 1 +
call sub_102FD0E  +
test eax eax +
jnz loc_10383B7  +
push offset aPlay_0  +
push esi  +
call sub_102FD0E  +
test eax eax +
jnz loc_10383B7  +
push edi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
mov ebx ds:RegQueryValueExW +
push offset aText_openverb  +
push [ebp+hKey]  +
mov edi 208h +
mov [ebp+cbData] edi +
call ebx  +
test eax eax +
jnz loc_10383B6  +
cmp [ebp+Type] 1 +
jnz loc_10383B6  +
mov [ebp+var_6] ax +
lea eax [ebp+Data] +
push eax  +
lea eax [esi+10h] +
push eax  +
call sub_102FD0E  +
test eax eax +
jnz loc_10383B6  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aText_playverb  +
push [ebp+hKey]  +
mov [ebp+cbData] edi +
call ebx  +
test eax eax +
jnz loc_10383B6  +
cmp [ebp+Type] 1 +
jnz loc_10383B6  +
lea eax [ebp+Data] +
push eax  +
lea eax [esi+4] +
push eax  +
call sub_102FD0E  +
test eax eax +
jnz loc_10383B6  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aStandardverb  +
push [ebp+hKey]  +
mov [ebp+cbData] edi +
call ebx  +
test eax eax +
jnz loc_10383B6  +
cmp [ebp+Type] 1 +
jnz loc_10383B6  +
lea eax [ebp+Data] +
push eax  +
lea eax [esi+18h] +
push eax  +
call sub_102FD0E  +
test eax eax +
jnz loc_10383B6  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aPlayer_path  +
push [ebp+hKey]  +
mov [ebp+cbData] edi +
call ebx  +
test eax eax +
jnz loc_10383B6  +
cmp [ebp+Type] 1 +
jz loc_1038215  +
cmp [ebp+Type] 2 +
jnz loc_10383B6  +
lea eax [ebp+Data] +
push eax  +
push offset aS_0  +
push 103h  +
mov edi offset unk_10412D8 +
push edi  +
call sub_1027F64  +
add esp 10h +
push edi  +
add esi 1Ch +
push esi  +
call sub_102FD0E  +
test eax eax +
jnz loc_10383B6  +
cmp [ebp+Type] 2 +
lea eax [ebp+Data] +
jnz loc_103827B  +
mov edi 103h +
push edi  +
push eax  +
push dword ptr [esi]  +
call ds:ExpandEnvironmentStringsW  +
test eax eax +
jz loc_10383B6  +
lea eax [ebp+Data] +
push eax  +
push offset aS_1  +
push edi  +
jmp loc_1038286  +
push eax  +
push offset aS_1  +
push 103h  +
push offset unk_10414E0  +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aShell_open  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
call ebx  +
test eax eax +
jnz loc_10383B6  +
cmp [ebp+Type] 1 +
jnz loc_10383B6  +
push 20h  +
pop eax  +
cmp ax word ptr [ebp+Data] +
lea eax [ebp+Data] +
push eax  +
push dword ptr [esi]  +
mov edi 143h +
lea eax [ebp+var_494] +
jnz loc_10382FD  +
push offset aSS_0  +
jmp loc_1038302  +
push offset aSS_1  +
push edi  +
push eax  +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+var_494] +
push eax  +
mov eax [ebp+var_4A4] +
add eax 14h +
push eax  +
call sub_102FD0E  +
test eax eax +
jnz loc_10383B6  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aShell_play  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
call ebx  +
test eax eax +
jnz loc_10383AC  +
cmp [ebp+Type] 1 +
jnz loc_10383AC  +
push 20h  +
pop eax  +
cmp ax word ptr [ebp+Data] +
lea eax [ebp+Data] +
push eax  +
push dword ptr [esi]  +
lea eax [ebp+var_494] +
jnz loc_1038387  +
push offset aSS_0  +
jmp loc_103838C  +
push offset aSS_1  +
push edi  +
push eax  +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+var_494] +
push eax  +
mov eax [ebp+var_4A4] +
add eax 8 +
push eax  +
call sub_102FD0E  +
mov [ebp+var_4A8] 1 +
pop edi  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
mov ecx [ebp+var_4] +
mov eax [ebp+var_4A8] +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 5ACh +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
push edi  +
mov edi [ebp+arg_0] +
push dword ptr [edi]  +
lea eax [ebp+Data] +
push lpSubKey  +
xor esi esi +
push offset aSExtensionsS  +
push 103h  +
push eax  +
mov [ebp+hKey] esi +
mov [ebp+var_5AC] esi +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+hKey] +
push eax  +
push 20019h  +
push esi  +
lea eax [ebp+Data] +
push eax  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1038A7C  +
push ebx  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
mov esi ds:RegQueryValueExW +
push offset aRequiredfile  +
push [ebp+hKey]  +
mov ebx 208h +
mov [ebp+Type] 1 +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_1038543  +
cmp [ebp+Type] 1 +
jz loc_10384AB  +
cmp [ebp+Type] 2 +
jnz loc_1038543  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_10384B4  +
sub eax edx +
sar eax 1 +
cmp eax 5 +
jbe loc_1038543  +
cmp [ebp+Type] 2 +
jnz loc_1038511  +
push 104h  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Data] +
push eax  +
call ds:ExpandEnvironmentStringsW  +
test eax eax +
jz loc_1038A6F  +
lea eax [ebp+FileName] +
push eax  +
push 104h  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1038A6F  +
push 1  +
push 104h  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Data] +
push eax  +
call sub_103C444  +
test eax eax +
jl loc_1038543  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_1038A6F  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aMcihandler  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_103858A  +
cmp [ebp+Type] 1 +
jnz loc_103858A  +
lea eax [ebp+Data] +
push eax  +
lea eax [edi+20h] +
push eax  +
call sub_102FD0E  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aReuseexthandle  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_10385E2  +
cmp [ebp+Type] 1 +
jnz loc_10385E2  +
lea eax [ebp+Data] +
push offset aYes  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_10385E2  +
mov dword ptr [edi+34h] 1 +
jmp loc_10385E6  +
and dword ptr [edi+34h] 0 +
lea eax [ebp+cbData] +
push eax  +
push dword ptr [edi+4]  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aClsid  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_1038629  +
cmp [ebp+Type] 1 +
jnz loc_1038629  +
lea eax [ebp+Data] +
push eax  +
lea eax [edi+4] +
push eax  +
call sub_102FD0E  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aMediatype_icon  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_1038A6F  +
cmp [ebp+Type] 1 +
jz loc_1038671  +
cmp [ebp+Type] 2 +
jnz loc_1038A6F  +
lea eax [ebp+Data] +
push eax  +
lea eax [edi+1Ch] +
push eax  +
call sub_102FD0E  +
test eax eax +
jnz loc_1038A6F  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aMediatype_desc  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_1038A6F  +
cmp [ebp+Type] 1 +
jnz loc_1038A6F  +
lea eax [ebp+Data] +
push eax  +
lea eax [edi+14h] +
push eax  +
call sub_102FD0E  +
test eax eax +
jnz loc_1038A6F  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aMediatype_de_0  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_1038774  +
cmp [ebp+Type] 1 +
jnz loc_1038774  +
push 40h  +
pop eax  +
mov [ebp+FileName] ax +
push 103h  +
lea eax [ebp-412h] +
push eax  +
call sub_102FC69  +
test eax eax +
jz loc_1038774  +
push offset asc_1008E50  +
push 104h  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
lea eax [ebp+Data] +
push eax  +
push 104h  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
lea eax [ebp+FileName] +
push eax  +
lea eax [edi+18h] +
push eax  +
call sub_102FD0E  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aExtension_mime  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_10387BB  +
cmp [ebp+Type] 1 +
jnz loc_10387BB  +
lea eax [ebp+Data] +
push eax  +
lea eax [edi+0Ch] +
push eax  +
call sub_102FD0E  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aPerceivedtype  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_1038802  +
cmp [ebp+Type] 1 +
jnz loc_1038802  +
lea eax [ebp+Data] +
push eax  +
lea eax [edi+10h] +
push eax  +
call sub_102FD0E  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_594] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aShell_open  +
push [ebp+hKey]  +
mov [ebp+cbData] 100h +
call esi  +
test eax eax +
jnz loc_103887A  +
cmp [ebp+Type] 1 +
jnz loc_103887A  +
lea eax [ebp+var_594] +
push eax  +
push offset unk_10412D8  +
push offset aSS_1  +
lea eax [ebp+var_494] +
push 143h  +
push eax  +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+var_494] +
push eax  +
lea eax [edi+30h] +
push eax  +
call sub_102FD0E  +
test eax eax +
jnz loc_1038A6F  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_594] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aShell_altverb_  +
push [ebp+hKey]  +
mov [ebp+cbData] 100h +
call esi  +
test eax eax +
jnz loc_1038901  +
cmp [ebp+Type] 1 +
jnz loc_1038901  +
lea eax [ebp+var_594] +
push eax  +
call sub_10313BF  +
test eax eax +
jz loc_10388F3  +
lea eax [ebp+var_594] +
push eax  +
push offset unk_10412D8  +
push offset aSS_1  +
lea eax [ebp+var_494] +
push 143h  +
push eax  +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+var_494] +
push eax  +
jmp loc_10388F8  +
push offset byte_1002720  +
lea eax [edi+2Ch] +
push eax  +
call sub_102FD0E  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aSpdhandler  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_1038938  +
cmp [ebp+Type] 1 +
jz loc_103896F  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aExtension_hand  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_103898C  +
cmp [ebp+Type] 1 +
jnz loc_103898C  +
lea eax [ebp+Data] +
push eax  +
lea eax [edi+8] +
push eax  +
call sub_102FD0E  +
test eax eax +
jnz loc_1038A6F  +
jmp loc_1038A0F  +
mov eax [edi] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_1038991  +
sub eax edx +
sar eax 1 +
add eax 0Bh +
xor ecx ecx +
push 2  +
pop edx  +
mov [ebp+var_5A8] eax +
mul  edx +
seto cl  +
neg ecx  +
or ecx eax +
push ecx  +
call ??_U@YAPAXI@Z  +
pop ecx  +
mov [ebp+var_5A4] eax +
test eax eax +
jz loc_1038A6F  +
mov ecx [edi] +
inc ecx  +
inc ecx  +
push ecx  +
push [ebp+var_5A8]  +
push eax  +
call sub_1027E68  +
push offset aFile  +
push [ebp+var_5A8]  +
push [ebp+var_5A4]  +
call sub_1027EDD  +
push [ebp+var_5A4]  +
mov ecx edi +
call sub_1031322  +
test eax eax +
jnz loc_1038A6F  +
push [ebp+var_5A4]  +
call ??_V@YAXPAX@Z  +
pop ecx  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aOpenPlay  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call esi  +
xor esi esi +
inc esi  +
test eax eax +
jnz loc_1038A65  +
cmp [ebp+Type] esi +
jnz loc_1038A65  +
lea eax [ebp+Data] +
push offset aYes  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1038A65  +
mov [edi+38h] esi +
jmp loc_1038A69  +
and dword ptr [edi+38h] 0 +
mov [ebp+var_5AC] esi +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop ebx  +
mov ecx [ebp+var_4] +
mov eax [ebp+var_5AC] +
pop edi  +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 424h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
push edi  +
mov edi [ebp+arg_0] +
push edi  +
push lpSubKey  +
lea eax [ebp+Data] +
push offset aSMimeTypesS  +
xor esi esi +
push 103h  +
push eax  +
mov [ebp+hKey] esi +
mov [ebp+var_424] esi +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+hKey] +
push eax  +
push 20019h  +
push esi  +
lea eax [ebp+Data] +
push eax  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1038D72  +
push ebx  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
mov esi ds:RegQueryValueExW +
push offset aRequiredfile  +
push [ebp+hKey]  +
xor ebx ebx +
inc ebx  +
mov [ebp+Type] ebx +
mov [ebp+cbData] 208h +
call esi  +
test eax eax +
jnz loc_1038BF1  +
cmp [ebp+Type] ebx +
jz loc_1038B60  +
cmp [ebp+Type] 2 +
jnz loc_1038BF1  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_1038B69  +
sub eax edx +
sar eax 1 +
cmp eax 5 +
jbe loc_1038BF1  +
cmp [ebp+Type] 2 +
mov ebx 104h +
jnz loc_1038BC3  +
push ebx  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Data] +
push eax  +
call ds:ExpandEnvironmentStringsW  +
test eax eax +
jz loc_1038D65  +
lea eax [ebp+FileName] +
push eax  +
push ebx  +
lea eax [ebp+Data] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1038D65  +
push 1  +
push ebx  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Data] +
push eax  +
call sub_103C444  +
test eax eax +
jl loc_1038BF1  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_1038D65  +
lea eax [ebp+cbData] +
push eax  +
lea eax [edi+3E8h] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aExtension_key  +
push [ebp+hKey]  +
mov [ebp+cbData] 14h +
call esi  +
test eax eax +
jnz loc_1038D65  +
cmp [ebp+Type] 1 +
jnz loc_1038D65  +
lea eax [ebp+cbData] +
push eax  +
lea eax [edi+0C8h] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aExtensions_com  +
push [ebp+hKey]  +
mov ebx 12Ch +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_1038D65  +
cmp [ebp+Type] 1 +
jnz loc_1038D65  +
lea ecx [ebp+cbData] +
push ecx  +
lea eax [edi+320h] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aClsid  +
push [ebp+hKey]  +
mov [ebp+cbData] 0C8h +
call esi  +
test eax eax +
jnz loc_1038CB3  +
cmp [ebp+Type] 1 +
jz loc_1038CC6  +
push offset byte_1002720  +
push 64h  +
lea eax [edi+320h] +
push eax  +
call sub_1027E68  +
lea eax [ebp+cbData] +
push eax  +
lea eax [edi+1F4h] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aExtensions_spa  +
push [ebp+hKey]  +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_1038D65  +
xor ebx ebx +
inc ebx  +
cmp [ebp+Type] ebx +
jnz loc_1038D65  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aNavprereg  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
call esi  +
test eax eax +
jnz loc_1038D59  +
cmp [ebp+Type] ebx +
jnz loc_1038D59  +
lea eax [ebp+Data] +
push offset aNo  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1038D59  +
and [edi+3FCh] eax +
jmp loc_1038D5F  +
mov [edi+3FCh] ebx +
mov [ebp+var_424] ebx +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop ebx  +
mov ecx [ebp+var_4] +
mov eax [ebp+var_424] +
pop edi  +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 430h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
mov ecx [ebp+arg_4] +
push ebx  +
push eax  +
push lpSubKey  +
mov [ebp+lpData] ecx +
mov ecx [ebp+arg_C] +
push offset aSProtocolsS  +
mov [ebp+var_42C] ecx +
mov ecx [ebp+arg_14] +
lea eax [ebp+Src] +
xor ebx ebx +
push 103h  +
push eax  +
mov [ebp+var_428] ecx +
mov [ebp+hKey] ebx +
mov [ebp+var_424] ebx +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+hKey] +
push eax  +
push 20019h  +
push ebx  +
lea eax [ebp+Src] +
push eax  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1038FE4  +
push esi  +
mov esi ds:RegQueryValueExW +
push edi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
push offset aRequiredfile  +
push [ebp+hKey]  +
xor edi edi +
inc edi  +
mov [ebp+Type] edi +
mov [ebp+cbData] 208h +
call esi  +
test eax eax +
jnz loc_1038F02  +
cmp [ebp+Type] edi +
jz loc_1038E71  +
cmp [ebp+Type] 2 +
jnz loc_1038F02  +
lea eax [ebp+Src] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_1038E7A  +
sub eax edx +
sar eax 1 +
cmp eax 5 +
jbe loc_1038F02  +
cmp [ebp+Type] 2 +
mov edi 104h +
jnz loc_1038ED4  +
push edi  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Src] +
push eax  +
call ds:ExpandEnvironmentStringsW  +
test eax eax +
jz loc_1038FD6  +
lea eax [ebp+FileName] +
push eax  +
push edi  +
lea eax [ebp+Src] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_1038FD6  +
push 1  +
push edi  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Src] +
push eax  +
call sub_103C444  +
test eax eax +
jl loc_1038F02  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_1038FD6  +
mov eax [ebp+arg_8] +
mov [ebp+cbData] eax +
lea eax [ebp+cbData] +
push eax  +
push [ebp+lpData]  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
push offset aSourceFilter  +
push [ebp+hKey]  +
call esi  +
test eax eax +
jnz loc_1038FD6  +
cmp [ebp+Type] 1 +
jnz loc_1038FD6  +
mov eax [ebp+arg_10] +
mov [ebp+cbData] eax +
lea eax [ebp+cbData] +
push eax  +
push [ebp+var_42C]  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
push offset aMimetype  +
push [ebp+hKey]  +
call esi  +
test eax eax +
jnz loc_1038FD6  +
cmp [ebp+Type] 1 +
jnz loc_1038FD6  +
mov edi [ebp+arg_18] +
lea eax [ebp+cbData] +
push eax  +
push [ebp+var_428]  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
push offset aIcon  +
push [ebp+hKey]  +
mov [ebp+cbData] edi +
call esi  +
test eax eax +
jnz loc_1038FBB  +
cmp [ebp+Type] 1 +
jz loc_1038FCC  +
cmp [ebp+Type] 2 +
jz loc_1038FCC  +
push offset byte_1002720  +
push edi  +
push [ebp+var_428]  +
call sub_1027EA2  +
mov [ebp+var_424] 1 +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
pop esi  +
mov ecx [ebp+var_4] +
mov eax [ebp+var_424] +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 1Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 42Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
mov ecx [ebp+arg_4] +
push esi  +
push eax  +
push lpSubKey  +
mov [ebp+lpData] ecx +
mov ecx [ebp+arg_C] +
push offset aSDevicesS  +
lea eax [ebp+Src] +
xor esi esi +
push 103h  +
push eax  +
mov [ebp+var_428] ecx +
mov [ebp+hKey] esi +
mov [ebp+var_42C] esi +
call sub_1027F64  +
add esp 14h +
lea eax [ebp+hKey] +
push eax  +
push 20019h  +
push esi  +
lea eax [ebp+Src] +
push eax  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1039242  +
push ebx  +
push edi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Src] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
mov esi ds:RegQueryValueExW +
push offset aRequiredfile  +
push [ebp+hKey]  +
xor edi edi +
inc edi  +
mov ebx 208h +
mov [ebp+Type] edi +
mov [ebp+cbData] ebx +
call esi  +
test eax eax +
jnz loc_103916B  +
cmp [ebp+Type] edi +
jz loc_10390DA  +
cmp [ebp+Type] 2 +
jnz loc_103916B  +
lea eax [ebp+Src] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_10390E3  +
sub eax edx +
sar eax 1 +
cmp eax 5 +
jbe loc_103916B  +
cmp [ebp+Type] 2 +
mov edi 104h +
jnz loc_103913D  +
push edi  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Src] +
push eax  +
call ds:ExpandEnvironmentStringsW  +
test eax eax +
jz loc_1039234  +
lea eax [ebp+FileName] +
push eax  +
push ebx  +
lea eax [ebp+Src] +
push eax  +
call sub_1027EA2  +
test eax eax +
jl loc_1039234  +
push 1  +
push edi  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Src] +
push eax  +
call sub_103C444  +
test eax eax +
jl loc_103916B  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_1039234  +
mov edi [ebp+arg_8] +
lea eax [ebp+cbData] +
push eax  +
push [ebp+lpData]  +
lea eax [ebp+Type] +
push eax  +
xor ebx ebx +
push ebx  +
push offset aDefaulticon  +
push [ebp+hKey]  +
mov [ebp+cbData] edi +
call esi  +
test eax eax +
jz loc_10391A3  +
push offset aA  +
jmp loc_10391BA  +
cmp [ebp+Type] 2 +
jz loc_10391C6  +
cmp [ebp+Type] 1 +
jz loc_10391C6  +
push offset aC  +
push edi  +
push [ebp+lpData]  +
call sub_1027EA2  +
mov edi [ebp+arg_10] +
lea eax [ebp+cbData] +
push eax  +
push [ebp+var_428]  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
push ebx  +
push [ebp+hKey]  +
mov [ebp+cbData] edi +
call esi  +
test eax eax +
jnz loc_1039216  +
cmp [ebp+Type] 1 +
jnz loc_1039216  +
mov eax [ebp+var_428] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx bx +
jnz loc_1039203  +
sub eax edx +
sar eax 1 +
cmp eax 2 +
jnb loc_103922A  +
shr edi 1 +
push offset byte_1002720  +
dec edi  +
push edi  +
push [ebp+var_428]  +
call sub_1027E68  +
mov [ebp+var_42C] 1 +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
pop ebx  +
mov ecx [ebp+var_4] +
mov eax [ebp+var_42C] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 14h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 974h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
xor esi esi +
lea ecx [ebp+var_938] +
mov [ebp+phkResult] esi +
call sub_1031EAC  +
mov eax [ebp+arg_4] +
mov dword_10416EC eax +
mov eax [ebp+arg_8] +
mov dword_10416E8 eax +
call sub_1036EA3  +
lea eax [ebp+var_938] +
push eax  +
call sub_103802C  +
test eax eax +
jz loc_10396D5  +
mov ebx ds:RegOpenKeyExW +
lea eax [ebp+hKey] +
push eax  +
push 20019h  +
push esi  +
push lpSubKey  +
mov [ebp+cbData] esi +
push 80000002h  +
mov [ebp+var_90C] esi +
mov [ebp+hKey] esi +
call ebx  +
test eax eax +
jnz loc_10396D5  +
push edi  +
mov edi ds:RegEnumKeyExW +
cmp [ebp+arg_0] esi +
jnz loc_10393CD  +
lea eax [ebp+phkResult] +
push eax  +
push 20019h  +
push esi  +
push offset aExtensions_0  +
push [ebp+hKey]  +
call ebx  +
test eax eax +
jnz loc_10393CD  +
lea ecx [ebp+var_974] +
call sub_1031F63  +
lea ecx [ebp+var_974] +
call sub_1031F99  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_24] +
push eax  +
push esi  +
jmp loc_10393A0  +
inc [ebp+var_90C]  +
lea eax [ebp+var_24] +
push eax  +
lea eax [ebp+var_974] +
push eax  +
call sub_102FD0E  +
test eax eax +
jnz loc_10393B6  +
lea eax [ebp+var_974] +
push eax  +
call sub_10383DE  +
test eax eax +
jz loc_1039380  +
lea eax [ebp+var_974] +
push eax  +
lea eax [ebp+var_938] +
push eax  +
call sub_103585A  +
lea ecx [ebp+var_974] +
call sub_1031F99  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_24] +
push eax  +
push [ebp+var_90C]  +
push [ebp+phkResult]  +
mov [ebp+cbData] 10h +
call edi  +
test eax eax +
jz loc_1039343  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
lea ecx [ebp+var_974] +
call sub_1031F99  +
lea eax [ebp+phkResult] +
push eax  +
push 20019h  +
push esi  +
push offset aMimeTypes_0  +
push [ebp+hKey]  +
call ebx  +
push 64h  +
pop ebx  +
test eax eax +
jnz loc_1039461  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_900] +
push eax  +
mov [ebp+var_90C] esi +
push esi  +
jmp loc_1039443  +
inc [ebp+var_90C]  +
lea eax [ebp+var_900] +
push eax  +
call sub_1038A97  +
test eax eax +
jz loc_103942B  +
lea eax [ebp+var_900] +
push eax  +
call sub_103CC3D  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_900] +
push eax  +
push [ebp+var_90C]  +
push [ebp+phkResult]  +
mov [ebp+cbData] ebx +
call edi  +
test eax eax +
jz loc_1039409  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
cmp [ebp+arg_0] esi +
jnz loc_10396C8  +
lea eax [ebp+phkResult] +
push eax  +
push 20019h  +
push esi  +
push offset aProtocols  +
push [ebp+hKey]  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1039543  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
mov [ebp+var_90C] esi +
push esi  +
jmp loc_1039521  +
inc [ebp+var_90C]  +
push 208h  +
lea eax [ebp+var_708] +
push eax  +
mov eax 12Ch +
push eax  +
lea ecx [ebp+var_424] +
push ecx  +
push eax  +
lea eax [ebp+var_21C] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
call sub_1038D8D  +
test eax eax +
jz loc_1039509  +
lea eax [ebp+var_708] +
push eax  +
lea eax [ebp+var_21C] +
push eax  +
lea eax [ebp+var_424] +
push eax  +
push [ebp+var_91C]  +
lea eax [ebp+SubKey] +
push eax  +
call sub_1032EC6  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+var_90C]  +
push [ebp+phkResult]  +
mov [ebp+cbData] ebx +
call edi  +
test eax eax +
jz loc_10394AB  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
lea eax [ebp+phkResult] +
push eax  +
push 20019h  +
push esi  +
push offset aDevices_0  +
push [ebp+hKey]  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_10396C8  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
mov [ebp+var_90C] esi +
push esi  +
jmp loc_10396A6  +
inc [ebp+var_90C]  +
mov eax 208h +
push eax  +
lea ecx [ebp+var_708] +
push ecx  +
push eax  +
lea eax [ebp+var_500] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
call sub_1038FFE  +
test eax eax +
jz loc_103968E  +
lea eax [ebp+var_914] +
push eax  +
push 1  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+phkResult]  +
mov [ebp+var_914] esi +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_1039662  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aDisableextensi  +
push [ebp+var_914]  +
mov [ebp+cbData] 20Ah +
mov [ebp+Type] 1 +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1039656  +
cmp [ebp+Type] 1 +
jnz loc_1039656  +
mov [ebp+var_F0] ax +
lea eax [ebp+Data] +
push offset aYes  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_1039656  +
push [ebp+var_914]  +
call ds:RegCloseKey  +
jmp loc_103968E  +
push [ebp+var_914]  +
call ds:RegCloseKey  +
push [ebp+var_934]  +
lea eax [ebp+var_708] +
push [ebp+var_938]  +
push eax  +
lea eax [ebp+var_500] +
push eax  +
push [ebp+var_91C]  +
lea eax [ebp+SubKey] +
push eax  +
call sub_1033448  +
push esi  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push [ebp+var_90C]  +
push [ebp+phkResult]  +
mov [ebp+cbData] ebx +
call edi  +
test eax eax +
jz loc_1039587  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
lea ecx [ebp+var_938] +
call sub_1031ECD  +
mov ecx [ebp+var_4] +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 3Ch +
push esi  +
lea ecx [ebp+var_3C] +
call sub_1031F63  +
push [ebp+arg_4]  +
lea eax [ebp+var_3C] +
push eax  +
xor esi esi +
call sub_102FD0E  +
test eax eax +
jl loc_1039732  +
lea eax [ebp+var_3C] +
push eax  +
call sub_10383DE  +
test eax eax +
jz loc_1039732  +
lea eax [ebp+var_3C] +
push eax  +
push [ebp+arg_0]  +
call sub_103585A  +
inc esi  +
lea ecx [ebp+var_3C] +
call sub_1031F99  +
mov eax esi +
pop esi  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 404h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_4] +
push esi  +
push eax  +
push 63h  +
lea eax [ebp+var_404] +
push eax  +
xor esi esi +
call sub_1027E68  +
lea eax [ebp+var_404] +
push eax  +
call sub_1038A97  +
test eax eax +
jz loc_103978D  +
lea eax [ebp+var_404] +
push eax  +
call sub_103CC3D  +
inc esi  +
mov ecx [ebp+var_4] +
mov eax esi +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 464h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
mov esi [ebp+arg_0] +
push edi  +
mov edi [ebp+arg_4] +
push 208h  +
lea eax [ebp+var_464] +
push eax  +
mov eax 12Ch +
push eax  +
lea ecx [ebp+var_130] +
push ecx  +
push eax  +
lea eax [ebp+var_25C] +
push eax  +
push edi  +
xor ebx ebx +
call sub_1038D8D  +
test eax eax +
jz loc_103980D  +
lea eax [ebp+var_464] +
push eax  +
lea eax [ebp+var_25C] +
push eax  +
lea eax [ebp+var_130] +
push eax  +
push dword ptr [esi+1Ch]  +
inc ebx  +
push edi  +
call sub_1032EC6  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
mov eax ebx +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 414h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
mov esi [ebp+arg_0] +
push edi  +
mov edi [ebp+arg_4] +
mov eax 208h +
push eax  +
lea ecx [ebp+var_20C] +
push ecx  +
push eax  +
lea eax [ebp+var_414] +
push eax  +
push edi  +
xor ebx ebx +
call sub_1038FFE  +
test eax eax +
jz loc_1039881  +
push dword ptr [esi+4]  +
lea eax [ebp+var_20C] +
push dword ptr [esi]  +
inc ebx  +
push eax  +
lea eax [ebp+var_414] +
push eax  +
push dword ptr [esi+1Ch]  +
push edi  +
call sub_1033448  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
mov eax ebx +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ebx  +
push esi  +
push [ebp+arg_8]  +
mov esi eax +
push [ebp+arg_4]  +
xor ebx ebx +
dec esi  +
push esi  +
push edi  +
call ds:_vsnprintf  +
add esp 10h +
test eax eax +
jl loc_10398C5  +
cmp eax esi +
ja loc_10398C5  +
jnz loc_10398CF  +
mov [esi+edi] bl +
jmp loc_10398CD  +
mov [esi+edi] bl +
mov ebx 8007007Ah +
mov eax esi +
mov ecx [ebp+arg_0] +
test ecx ecx +
jz loc_10398D8  +
mov [ecx] eax +
pop esi  +
mov eax ebx +
pop ebx  +
pop ebp  +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
cmp [ebp+lpBuffer] 0 +
jz loc_1039927  +
cmp [ebp+hFile] 0FFFFFFFFh +
jz loc_1039927  +
mov eax [ebp+NumberOfBytesWritten] +
cmp eax dword_1041700 +
jg loc_1039927  +
mov eax [ebp+lpBuffer] +
and [ebp+NumberOfBytesWritten] 0 +
lea ecx [eax+1] +
mov dl [eax] +
inc eax  +
test dl dl +
jnz loc_103990B  +
push 0  +
sub eax ecx +
lea ecx [ebp+NumberOfBytesWritten] +
push ecx  +
push eax  +
push [ebp+lpBuffer]  +
push [ebp+hFile]  +
call ds:WriteFile  +
pop ebp  +
retn 0Ch  +
***
mov eax hObject +
cmp eax 0FFFFFFFFh +
jz locret_1039948  +
push eax  +
call ds:CloseHandle  +
or hObject 0FFFFFFFFh +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
xor eax eax +
cmp [ebp+arg_4] eax +
jz loc_1039963  +
cmp [ebp+arg_4] 7FFFFFFFh +
jbe loc_1039968  +
mov eax 80070057h +
test eax eax +
jl loc_1039981  +
mov eax [ebp+arg_4] +
push edi  +
push [ebp+arg_C]  +
mov edi [ebp+arg_0] +
push [ebp+arg_8]  +
push 0  +
call sub_1039899  +
pop edi  +
pop ebp  +
retn 10h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
xor eax eax +
cmp [ebp+arg_4] eax +
jz loc_103999F  +
cmp [ebp+arg_4] 7FFFFFFFh +
jbe loc_10399A4  +
mov eax 80070057h +
test eax eax +
jl loc_10399BE  +
push edi  +
mov edi [ebp+arg_0] +
lea eax [ebp+arg_C] +
push eax  +
push [ebp+arg_8]  +
mov eax [ebp+arg_4] +
push 0  +
call sub_1039899  +
pop edi  +
pop ebp  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 214h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
push edi  +
mov esi 104h +
push esi  +
lea eax [ebp+tstrFilename] +
push eax  +
xor edi edi +
call ds:GetSystemDirectoryW  +
test eax eax +
jz loc_1039A3C  +
push offset aKernel32_dll  +
push esi  +
lea eax [ebp+tstrFilename] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_1039A3C  +
lea eax [ebp+var_210] +
push eax  +
lea eax [ebp+var_214] +
push eax  +
lea eax [ebp+tstrFilename] +
push eax  +
mov [ebp+var_214] edi +
mov [ebp+var_210] edi +
call sub_102EC42  +
test eax eax +
jl loc_1039A3C  +
movzx edi word ptr [ebp+var_210] +
mov ecx [ebp+var_4] +
mov eax edi +
pop edi  +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 748h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
push ebx  +
xor ebx ebx +
mov [ebp+var_728] eax +
cmp dword_10416FC ebx +
jz loc_1039A92  +
mov ecx [ebp+arg_4] +
cmp ecx dword_1041700 +
jg loc_1039F07  +
cmp dword ptr [eax] 0FFFFFFFFh +
jnz loc_1039F07  +
push esi  +
push edi  +
xor eax eax +
lea ecx [ebp+hKey] +
push ecx  +
inc eax  +
push eax  +
push ebx  +
push offset aSoftwareMic_10  +
push 80000001h  +
mov [ebp+hKey] ebx +
mov [ebp+NumberOfBytesWritten] ebx +
xor esi esi +
mov dword_10416FC eax +
call ds:RegOpenKeyExW  +
mov edi ds:CreateFileA +
test eax eax +
jnz loc_1039BF0  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
push offset aSetuplogfile  +
push [ebp+hKey]  +
mov [ebp+Type] 1 +
mov dword ptr [ebp+cbData] 104h +
call ds:RegQueryValueExA  +
test eax eax +
jnz loc_1039B94  +
cmp [ebp+Type] 1 +
jnz loc_1039B94  +
push ebx  +
push 8000080h  +
push 3  +
push ebx  +
push ebx  +
push 80000000h  +
lea eax [ebp+FileName] +
push eax  +
mov [ebp+var_5] bl +
call edi  +
mov [ebp+hObject] eax +
cmp eax 0FFFFFFFFh +
jz loc_1039B69  +
push ebx  +
push eax  +
call ds:GetFileSize  +
cmp eax 0FFFFFFFFh +
jnz loc_1039B52  +
xor eax eax +
push [ebp+hObject]  +
mov ecx 7A120h +
cmp ecx eax +
sbb esi esi +
neg esi  +
call ds:CloseHandle  +
xor eax eax +
cmp esi ebx +
setz al  +
push ebx  +
push 8000080h  +
lea eax [eax+eax+2] +
push eax  +
push ebx  +
push 1  +
push 40000000h  +
lea eax [ebp+FileName] +
push eax  +
call edi  +
mov ecx [ebp+var_728] +
mov [ecx] eax +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+NumberOfBytesWritten] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push ebx  +
push offset aSetuploglevel  +
push [ebp+hKey]  +
mov dword ptr [ebp+cbData] 4 +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_1039BD2  +
cmp [ebp+Type] 4 +
jz loc_1039BD8  +
mov [ebp+NumberOfBytesWritten] ebx +
movzx eax word ptr [ebp+NumberOfBytesWritten] +
push [ebp+hKey]  +
mov dword_1041700 eax +
call ds:RegCloseKey  +
mov eax [ebp+var_728] +
cmp dword ptr [eax] 0FFFFFFFFh +
jnz loc_1039D67  +
mov eax dword_1041700 +
cmp eax ebx +
jnz loc_1039C10  +
push 4  +
pop eax  +
mov dword_1041700 eax +
cmp [ebp+arg_4] eax +
jg loc_1039D67  +
push 104h  +
lea eax [ebp+FileName] +
push eax  +
call ds:GetWindowsDirectoryA  +
test eax eax +
jz loc_1039D67  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E5FF  +
push [ebp+arg_8]  +
lea eax [ebp+FileName] +
push 104h  +
push eax  +
call sub_102FC10  +
test eax eax +
jl loc_1039D67  +
push ebx  +
push 8000080h  +
push 3  +
push ebx  +
push ebx  +
push 80000000h  +
lea eax [ebp+FileName] +
push eax  +
call edi  +
mov [ebp+hObject] eax +
cmp eax 0FFFFFFFFh +
jz loc_1039CA4  +
push ebx  +
push eax  +
call ds:GetFileSize  +
cmp eax 0FFFFFFFFh +
jnz loc_1039C8D  +
xor eax eax +
push [ebp+hObject]  +
mov ecx 7A120h +
cmp ecx eax +
sbb esi esi +
neg esi  +
call ds:CloseHandle  +
mov eax [ebp+var_728] +
cmp dword ptr [eax] 0FFFFFFFFh +
jnz loc_1039D67  +
lea eax [ebp+Buffer] +
push eax  +
push 104h  +
call ds:GetTempPathA  +
test eax eax +
jz loc_1039D67  +
lea eax [ebp+Buffer] +
push eax  +
call sub_102E5FF  +
push offset aWmsetup_log_0  +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_102FC10  +
test eax eax +
jl loc_1039D67  +
push ebx  +
push 8000080h  +
push 3  +
push ebx  +
push ebx  +
push 80000000h  +
lea eax [ebp+Buffer] +
push eax  +
call edi  +
mov [ebp+hObject] eax +
cmp eax 0FFFFFFFFh +
jz loc_1039D3C  +
push ebx  +
push eax  +
call ds:GetFileSize  +
cmp eax 0FFFFFFFFh +
jnz loc_1039D25  +
xor eax eax +
push [ebp+hObject]  +
mov ecx 7A120h +
cmp ecx eax +
sbb esi esi +
neg esi  +
call ds:CloseHandle  +
xor eax eax +
cmp esi ebx +
setz al  +
push ebx  +
push 8000080h  +
lea eax [eax+eax+2] +
push eax  +
push ebx  +
push 1  +
push 40000000h  +
lea eax [ebp+Buffer] +
push eax  +
call edi  +
mov ecx [ebp+var_728] +
mov [ecx] eax +
mov eax [ebp+var_728] +
mov eax [eax] +
cmp eax 0FFFFFFFFh +
jz loc_1039F05  +
cmp esi ebx +
jnz loc_1039D87  +
push 2  +
push ebx  +
push ebx  +
push eax  +
call ds:SetFilePointer  +
lea eax [ebp+SystemTime] +
push eax  +
call ds:GetLocalTime  +
push dword_1041700  +
movzx eax [ebp+SystemTime.wSecond] +
push eax  +
movzx eax [ebp+SystemTime.wMinute] +
push eax  +
movzx eax [ebp+SystemTime.wHour] +
push eax  +
movzx eax [ebp+SystemTime.wDay] +
push eax  +
movzx eax [ebp+SystemTime.wMonth] +
push eax  +
movzx eax [ebp+SystemTime.wYear] +
push eax  +
push offset aWmcLoggingBegu  +
mov edi 104h +
lea eax [ebp+FileName] +
push edi  +
push eax  +
call sub_103998A  +
mov esi ds:WriteFile +
add esp 28h +
test eax eax +
jl loc_1039E20  +
lea eax [ebp+FileName] +
mov [ebp+NumberOfBytesWritten] ebx +
lea edx [eax+1] +
mov cl [eax] +
inc eax  +
cmp cl bl +
jnz loc_1039DFD  +
push ebx  +
sub eax edx +
lea ecx [ebp+NumberOfBytesWritten] +
push ecx  +
push eax  +
lea eax [ebp+FileName] +
push eax  +
mov eax [ebp+var_728] +
push dword ptr [eax]  +
call esi  +
push 7Fh  +
lea eax [ebp+var_208] +
push eax  +
call sub_102E92F  +
push edx  +
push eax  +
call sub_102FDA1  +
call sub_103061F  +
push 103h  +
lea ecx [ebp+var_518] +
push ecx  +
push edx  +
push eax  +
call sub_102FDA1  +
call ds:GetSystemDefaultLangID  +
movzx eax ax +
mov [ebp+hObject] eax +
push edi  +
lea eax [ebp+var_720] +
push eax  +
call sub_10309B6  +
test eax eax +
jz loc_1039F05  +
push ebx  +
push 4  +
call sub_102EABA  +
mov dword ptr [ebp+cbData] offset aW9x +
test eax eax +
jnz loc_1039E91  +
mov dword ptr [ebp+cbData] offset aNt +
lea eax [ebp+var_720] +
push eax  +
lea eax [ebp+var_518] +
push eax  +
movzx eax word ptr [ebp+hObject] +
push eax  +
call sub_10399C5  +
push eax  +
lea eax [ebp+var_208] +
push eax  +
push dword ptr [ebp+cbData]  +
lea eax [ebp+var_310] +
push offset aOsIsS_OsverIsS  +
push edi  +
push eax  +
call sub_103998A  +
add esp 24h +
test eax eax +
jl loc_1039F05  +
lea eax [ebp+var_310] +
mov [ebp+NumberOfBytesWritten] ebx +
lea edx [eax+1] +
mov cl [eax] +
inc eax  +
cmp cl bl +
jnz loc_1039EE2  +
push ebx  +
sub eax edx +
lea ecx [ebp+NumberOfBytesWritten] +
push ecx  +
push eax  +
lea eax [ebp+var_310] +
push eax  +
mov eax [ebp+var_728] +
push dword ptr [eax]  +
call esi  +
pop edi  +
pop esi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
cmp hObject 0FFFFFFFFh +
jnz loc_1039F3B  +
push offset aWmsetup_log  +
push [ebp+NumberOfBytesWritten]  +
push offset hObject  +
call sub_1039A51  +
push [ebp+lpBuffer]  +
push [ebp+NumberOfBytesWritten]  +
push hObject  +
call sub_10398E5  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 20Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push esi  +
mov esi [ebp+arg_0] +
cmp esi dword_1041700 +
jle loc_1039F85  +
cmp dword_10416FC 0 +
jnz loc_1039FAA  +
cmp [ebp+arg_4] 0 +
jz loc_1039FAA  +
lea eax [ebp+arg_8] +
push eax  +
push [ebp+arg_4]  +
lea eax [ebp+Buffer] +
push 207h  +
push eax  +
call sub_103994E  +
lea eax [ebp+Buffer] +
push eax  +
push esi  +
call sub_1039F1B  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push esi  +
xor esi esi +
mov eax off_103FCB8[esi] +
test eax eax +
jz loc_1039FD5  +
push 0  +
push 1  +
push eax  +
call sub_103CC65  +
add esi 24h +
cmp esi 2ACh +
jb loc_1039FC1  +
pop esi  +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 434h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
push esi  +
mov esi ds:RegSetValueExW +
push edi  +
xor edi edi +
mov [ebp+var_418] edi +
mov [ebp+phkResult] edi +
mov [ebp+hKey] edi +
mov [ebp+var_434] edi +
cmp [ebp+var_434] edi +
jnz loc_103A034  +
mov [ebp+var_42C] edi +
mov eax offset aSoftwareMic_56 +
jmp loc_103A043  +
mov [ebp+var_42C] 1 +
mov eax offset aSoftwareMic_57 +
mov ebx ds:RegCreateKeyExW +
push edi  +
lea ecx [ebp+hKey] +
push ecx  +
push edi  +
push 20006h  +
push edi  +
push edi  +
push edi  +
push eax  +
push 80000002h  +
call ebx  +
test eax eax +
jnz loc_103B41B  +
cmp [ebp+var_42C] edi +
jz loc_103A0F6  +
push 103h  +
push 1  +
lea eax [ebp+FileName] +
push eax  +
call sub_10302A3  +
test eax eax +
jz loc_103A0F6  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E61A  +
push offset aWmplayer_exe  +
push 104h  +
lea eax [ebp+FileName] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_103A0F6  +
lea eax [ebp+FileName] +
push eax  +
call sub_102E8B9  +
test eax eax +
jz loc_103A0F6  +
lea eax [ebp+FileName] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103A0CC  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
push 1  +
push edi  +
push offset aPlayer_path  +
push [ebp+hKey]  +
call esi  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 20006h  +
push edi  +
push edi  +
push edi  +
push offset aExtensions_0  +
push [ebp+hKey]  +
call ebx  +
test eax eax +
jnz loc_103A76C  +
xor ebx ebx +
mov dword ptr [ebp+var_41C] ebx +
mov eax off_103F0F0[ebx] +
cmp eax edi +
jz loc_103A74B  +
cmp [ebp+var_42C] edi +
jnz loc_103A146  +
cmp dword_103F130[ebx] edi +
jz loc_103A74B  +
push eax  +
push 103h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_103A74B  +
lea eax [ebp+Buffer] +
push offset asc_100BAA4  +
mov [ebp+lpSubKey] eax +
push eax  +
call ds:wcsstr  +
pop ecx  +
mov dword ptr [ebp+uID] eax +
pop ecx  +
cmp eax edi +
jz loc_103A196  +
mov ecx dword ptr [ebp+uID] +
xor eax eax +
add dword ptr [ebp+uID] 2 +
mov [ecx] ax +
push edi  +
lea eax [ebp+var_418] +
push eax  +
push edi  +
push 20006h  +
push edi  +
push edi  +
push edi  +
push [ebp+lpSubKey]  +
push [ebp+phkResult]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103A70C  +
mov ecx off_103F0F4[ebx] +
cmp ecx edi +
jz loc_103A1FE  +
mov eax ecx +
lea edx [eax+2] +
mov [ebp+lpSubKey] edx +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A1D6  +
sub eax [ebp+lpSubKey] +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aExtension_hand  +
push [ebp+var_418]  +
call esi  +
cmp [ebp+var_42C] edi +
jz loc_103A22A  +
lea eax dword_103F138[ebx] +
mov ecx [eax] +
cmp ecx edi +
jz loc_103A22A  +
cmp ecx 0FFFFFFFFh +
jz loc_103A22A  +
push 4  +
push eax  +
push 4  +
push edi  +
push offset aRuntime  +
push [ebp+var_418]  +
call esi  +
lea eax dword_103F13C[ebx] +
mov ecx [eax] +
cmp ecx edi +
jz loc_103A24E  +
cmp ecx 0FFFFFFFFh +
jz loc_103A24E  +
push 4  +
push eax  +
push 4  +
push edi  +
push offset aPermissions  +
push [ebp+var_418]  +
call esi  +
mov ecx off_103F140[ebx] +
cmp ecx edi +
jz loc_103A28B  +
mov eax ecx +
lea edx [eax+2] +
mov [ebp+lpSubKey] edx +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A263  +
sub eax [ebp+lpSubKey] +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aPerceivedtype  +
push [ebp+var_418]  +
call esi  +
mov eax dword_103F0F8[ebx] +
cmp eax edi +
jz loc_103A343  +
push 104h  +
lea ecx [ebp+Buffer] +
push ecx  +
push eax  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_103A343  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103A2C3  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aMediatype_desc  +
push [ebp+var_418]  +
call esi  +
push dword_103F0F8[ebx]  +
lea eax [ebp+Buffer] +
push offset aLu  +
push 103h  +
push eax  +
call sub_1027F64  +
add esp 10h +
test eax eax +
jl loc_103A343  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103A319  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aMediatype_de_0  +
push [ebp+var_418]  +
call esi  +
cmp [ebp+var_42C] edi +
jz loc_103A3A5  +
mov eax off_103F134[ebx] +
cmp eax edi +
jz loc_103A3DE  +
push edi  +
push 104h  +
lea ecx [ebp+Buffer] +
push ecx  +
push eax  +
call sub_103C444  +
test eax eax +
jl loc_103A3DE  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103A379  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aMediatype_icon  +
push [ebp+var_418]  +
call esi  +
jmp loc_103A3DE  +
mov ecx off_103F0FC[ebx] +
cmp ecx edi +
jz loc_103A3DE  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A3B4  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aMediatype_icon  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+var_41C] +
mov ecx off_103F100[ebx] +
cmp ecx edi +
jz loc_103A419  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A3ED  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aExtension_mime  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+var_41C] +
jmp loc_103A42A  +
push offset aExtension_mime  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
cmp [ebp+var_42C] edi +
jz loc_103A46D  +
mov ecx off_103F108[ebx] +
cmp ecx edi +
jz loc_103A4A8  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A441  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aReplaceapps  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+var_41C] +
jmp loc_103A4BF  +
mov ecx off_103F104[ebx] +
cmp ecx edi +
jz loc_103A4A8  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A47C  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aReplaceapps  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+var_41C] +
jmp loc_103A4C7  +
push 8  +
push offset a__0  +
push 1  +
push edi  +
push offset aReplaceapps  +
push [ebp+var_418]  +
call esi  +
cmp [ebp+var_42C] edi +
jnz loc_103A4DE  +
push 1Ah  +
push offset aWmplayer_exe  +
push 1  +
push edi  +
push offset aSuperiorapps  +
push [ebp+var_418]  +
call esi  +
mov eax off_103F10C[ebx] +
cmp eax edi +
jz loc_103A54E  +
push offset aMpegvideo2  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_103A513  +
push 14h  +
push offset KeyName  +
push 1  +
push edi  +
push offset aMcihandler  +
push [ebp+var_418]  +
call esi  +
jmp loc_103A54E  +
mov eax dword ptr [ebp+var_41C] +
mov ecx off_103F10C[eax] +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A524  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aMcihandler  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+var_41C] +
mov ecx dword_103F120[ebx] +
cmp ecx edi +
jz loc_103A587  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A55D  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aClsid  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+var_41C] +
mov ecx off_103F110[ebx] +
cmp ecx edi +
jz loc_103A5C4  +
mov eax ecx +
lea edx [eax+2] +
mov [ebp+lpSubKey] edx +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A59C  +
sub eax [ebp+lpSubKey] +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aShell_open  +
push [ebp+var_418]  +
call esi  +
mov ecx dword_103F114[ebx] +
cmp ecx edi +
jz loc_103A601  +
mov eax ecx +
lea edx [eax+2] +
mov [ebp+lpSubKey] edx +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A5D9  +
sub eax [ebp+lpSubKey] +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aShell_altver_0  +
push [ebp+var_418]  +
call esi  +
mov ecx off_103F11C[ebx] +
cmp ecx edi +
jz loc_103A63E  +
mov eax ecx +
lea edx [eax+2] +
mov [ebp+lpSubKey] edx +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A616  +
sub eax [ebp+lpSubKey] +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aShell_altverb_  +
push [ebp+var_418]  +
call esi  +
mov eax dword_103F118[ebx] +
cmp eax edi +
jz loc_103A698  +
push 104h  +
lea ecx [ebp+Buffer] +
push ecx  +
push eax  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_103A698  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103A66E  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aShell_altver_1  +
push [ebp+var_418]  +
call esi  +
mov eax dword_103F12C[ebx] +
cmp eax edi +
jz loc_103A6EF  +
push 1  +
push 104h  +
lea ecx [ebp+Buffer] +
push ecx  +
push eax  +
call sub_103C444  +
test eax eax +
jl loc_103A700  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103A6C3  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aRequiredfile  +
push [ebp+var_418]  +
call esi  +
jmp loc_103A700  +
push offset aRequiredfile  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
push off_103F0F0[ebx]  +
mov eax dword ptr [ebp+uID] +
mov [ebp+lpSubKey] eax +
push 103h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_103A74B  +
cmp dword ptr [ebp+uID] edi +
jz loc_103A74B  +
push offset asc_100BAA4  +
push dword ptr [ebp+uID]  +
jmp loc_103A172  +
add ebx 54h +
mov dword ptr [ebp+var_41C] ebx +
cmp ebx 0B7Ch +
jb loc_103A124  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 20006h  +
push edi  +
push edi  +
push edi  +
push offset aMimeTypes_0  +
push [ebp+hKey]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103AAE4  +
xor ebx ebx +
mov dword ptr [ebp+uID] ebx +
mov eax off_103FF68[ebx] +
cmp eax edi +
jz loc_103AAC3  +
cmp [ebp+var_42C] edi +
jnz loc_103A7C0  +
cmp dword_103FF8C[ebx] edi +
jz loc_103AAC3  +
push eax  +
push 103h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_103AAC3  +
lea eax [ebp+Buffer] +
push offset asc_100BAA4  +
mov [ebp+lpSubKey] eax +
push eax  +
call ds:wcsstr  +
pop ecx  +
mov dword ptr [ebp+var_41C] eax +
pop ecx  +
cmp eax edi +
jz loc_103A810  +
mov ecx dword ptr [ebp+var_41C] +
xor eax eax +
add dword ptr [ebp+var_41C] 2 +
mov [ecx] ax +
push edi  +
lea eax [ebp+var_418] +
push eax  +
push edi  +
push 20006h  +
push edi  +
push edi  +
push edi  +
push [ebp+lpSubKey]  +
push [ebp+phkResult]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103AA84  +
mov ecx off_103FF6C[ebx] +
cmp ecx edi +
jz loc_103A878  +
mov eax ecx +
lea edx [eax+2] +
mov [ebp+lpSubKey] edx +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A850  +
sub eax [ebp+lpSubKey] +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aExtensions_com  +
push [ebp+var_418]  +
call esi  +
mov ecx off_103FF70[ebx] +
cmp ecx edi +
jz loc_103A8B5  +
mov eax ecx +
lea edx [eax+2] +
mov [ebp+lpSubKey] edx +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A88D  +
sub eax [ebp+lpSubKey] +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aExtensions_spa  +
push [ebp+var_418]  +
call esi  +
mov ecx off_103FF74[ebx] +
cmp ecx edi +
jz loc_103A8EE  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A8C4  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aExtension_key  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+uID] +
cmp [ebp+var_42C] edi +
jz loc_103A938  +
mov ecx off_103FF80[ebx] +
cmp ecx edi +
jz loc_103AA03  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A909  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aReplaceapps  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+uID] +
jmp loc_103AA1A  +
mov ecx dword_103FF7C[ebx] +
cmp ecx edi +
jz loc_103AA03  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A94B  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aReplaceapps  +
push [ebp+var_418]  +
call esi  +
mov ecx lpData +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103A97A  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aClsid  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+uID] +
mov eax dword_103FF84[ebx] +
cmp eax edi +
jz loc_103AA48  +
push 1  +
push 104h  +
lea ecx [ebp+Buffer] +
push ecx  +
push eax  +
call sub_103C444  +
test eax eax +
jl loc_103AA59  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103A9D7  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aRequiredfile  +
push [ebp+var_418]  +
call esi  +
jmp loc_103AA59  +
push 8  +
push offset a__0  +
push 1  +
push edi  +
push offset aReplaceapps  +
push [ebp+var_418]  +
call esi  +
cmp [ebp+var_42C] edi +
jz loc_103A96F  +
mov ecx dword_103FF78[ebx] +
cmp ecx edi +
jz loc_103A9A4  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103AA39  +
jmp loc_103A984  +
push offset aRequiredfile  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
cmp dword_103FF88[ebx] edi +
jnz loc_103AA78  +
push 6  +
push offset aNo_0  +
push 1  +
push edi  +
push offset aNavprereg_0  +
push [ebp+var_418]  +
call esi  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
push off_103FF68[ebx]  +
mov eax dword ptr [ebp+var_41C] +
mov [ebp+lpSubKey] eax +
push 103h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_103AAC3  +
cmp dword ptr [ebp+var_41C] edi +
jz loc_103AAC3  +
push offset asc_100BAA4  +
push dword ptr [ebp+var_41C]  +
jmp loc_103A7EC  +
add ebx 28h +
mov dword ptr [ebp+uID] ebx +
cmp ebx 488h +
jb loc_103A79E  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 20006h  +
push edi  +
push edi  +
push edi  +
push offset aProtocols  +
push [ebp+hKey]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103AD12  +
mov eax off_103FC6C +
cmp eax edi +
jz loc_103AD06  +
cmp [ebp+var_42C] edi +
jnz loc_103AB2F  +
cmp dword_103FC7C edi +
jz loc_103AD06  +
push eax  +
push 103h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_103AD06  +
lea ebx [ebp+Buffer] +
push offset asc_100BAA4  +
mov eax ebx +
push eax  +
call ds:wcsstr  +
pop ecx  +
mov dword ptr [ebp+var_41C] eax +
pop ecx  +
cmp eax edi +
jz loc_103AB7B  +
mov ecx dword ptr [ebp+var_41C] +
xor eax eax +
add dword ptr [ebp+var_41C] 2 +
mov [ecx] ax +
push edi  +
lea eax [ebp+var_418] +
push eax  +
push edi  +
push 20006h  +
push edi  +
push edi  +
push edi  +
push ebx  +
push [ebp+phkResult]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103ACD6  +
mov edx off_103FC70 +
cmp edx edi +
jz loc_103ABD4  +
mov eax edx +
lea ebx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103ABB0  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push edx  +
push 1  +
push edi  +
push offset aMimetype  +
push [ebp+var_418]  +
call esi  +
mov edx off_103FC74 +
cmp edx edi +
jz loc_103AC07  +
mov eax edx +
lea ebx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103ABE3  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push edx  +
push 1  +
push edi  +
push offset aSourceFilter  +
push [ebp+var_418]  +
call esi  +
mov eax dword_103FC78 +
cmp eax edi +
jz loc_103AC5D  +
push 1  +
push 104h  +
lea ecx [ebp+Buffer] +
push ecx  +
push eax  +
call sub_103C444  +
test eax eax +
jl loc_103AC6E  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103AC31  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aRequiredfile  +
push [ebp+var_418]  +
call esi  +
jmp loc_103AC6E  +
push offset aRequiredfile  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
cmp [ebp+var_42C] edi +
jz loc_103ACCA  +
mov eax off_103FC84 +
cmp eax edi +
jz loc_103ACCA  +
push 1  +
push 104h  +
lea ecx [ebp+Buffer] +
push ecx  +
push eax  +
call sub_103C444  +
test eax eax +
jl loc_103ACCA  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103ACA0  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aIcon  +
push [ebp+var_418]  +
call esi  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
push off_103FC6C  +
mov ebx dword ptr [ebp+var_41C] +
push 103h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027E68  +
test eax eax +
jl loc_103AD06  +
cmp ebx edi +
jz loc_103AD06  +
push offset asc_100BAA4  +
push ebx  +
jmp loc_103AB57  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 20006h  +
push edi  +
push edi  +
push edi  +
push offset aDevices_0  +
push [ebp+hKey]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103AF1B  +
xor ebx ebx +
mov [ebp+lpSubKey] ebx +
mov eax off_103FC88[ebx] +
cmp eax edi +
jz loc_103AEFD  +
cmp [ebp+var_42C] edi +
jnz loc_103AD66  +
cmp dword_103FC9C[ebx] edi +
jz loc_103AEFD  +
push edi  +
lea ecx [ebp+var_418] +
push ecx  +
push edi  +
push 20006h  +
push edi  +
push edi  +
push edi  +
push eax  +
push [ebp+phkResult]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103AEFD  +
mov eax dword_103FC8C[ebx] +
cmp eax edi +
jz loc_103ADE2  +
push 104h  +
lea ecx [ebp+Buffer] +
push ecx  +
push eax  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_103ADE2  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103ADBC  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+var_418]  +
call esi  +
mov eax off_103FC90[ebx] +
cmp eax edi +
jz loc_103AE37  +
push 1  +
push 104h  +
lea ecx [ebp+Buffer] +
push ecx  +
push eax  +
call sub_103C444  +
test eax eax +
jl loc_103AE37  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103AE0D  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aDefaulticon  +
push [ebp+var_418]  +
call esi  +
mov ecx off_103FC94[ebx] +
cmp ecx edi +
jz loc_103AE72  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103AE46  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aReplaceapps  +
push [ebp+var_418]  +
call esi  +
mov ebx [ebp+lpSubKey] +
jmp loc_103AE89  +
push 8  +
push offset a__0  +
push 1  +
push edi  +
push offset aReplaceapps  +
push [ebp+var_418]  +
call esi  +
mov eax dword_103FC98[ebx] +
cmp eax edi +
jz loc_103AEE0  +
push 1  +
push 104h  +
lea ecx [ebp+Buffer] +
push ecx  +
push eax  +
call sub_103C444  +
test eax eax +
jl loc_103AEF1  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103AEB4  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aRequiredfile  +
push [ebp+var_418]  +
call esi  +
jmp loc_103AEF1  +
push offset aRequiredfile  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
add ebx 18h +
mov [ebp+lpSubKey] ebx +
cmp ebx 30h +
jb loc_103AD44  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+phkResult] +
push eax  +
push edi  +
push 20006h  +
push edi  +
push edi  +
push edi  +
push offset aGroups  +
push [ebp+hKey]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103B40F  +
xor ebx ebx +
mov dword ptr [ebp+var_41C] ebx +
mov eax off_103FCB8[ebx] +
cmp eax edi +
jz loc_103B3EE  +
cmp [ebp+var_42C] edi +
jnz loc_103AF6F  +
cmp dword_103FCD8[ebx] edi +
jz loc_103B3EE  +
push edi  +
lea ecx [ebp+var_418] +
push ecx  +
push edi  +
push 20006h  +
push edi  +
push edi  +
push edi  +
push eax  +
push [ebp+phkResult]  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103B3EE  +
mov eax dword_103FCBC[ebx] +
cmp eax edi +
jz loc_103B0C0  +
push 104h  +
lea ecx [ebp+Buffer] +
push ecx  +
push eax  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_103B0C0  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103AFCD  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+var_418]  +
call esi  +
push 40h  +
pop eax  +
mov word ptr [ebp+Buffer] ax +
push 103h  +
lea eax [ebp+Buffer+2] +
push eax  +
call sub_102FC69  +
test eax eax +
jz loc_103B0C0  +
push offset asc_1008E50  +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_103B0C0  +
lea eax [ebp+Buffer] +
push 2Dh  +
push eax  +
call ds:wcsrchr  +
pop ecx  +
pop ecx  +
cmp eax edi +
jz loc_103B0C0  +
lea ecx [ebp+Buffer] +
lea edx [ecx+2] +
mov [ebp+lpSubKey] edx +
mov dx [ecx] +
inc ecx  +
inc ecx  +
cmp dx di +
jnz loc_103B058  +
sub ecx [ebp+lpSubKey] +
push dword_103FCBC[ebx]  +
sar ecx 1 +
mov edx 103h +
push offset aLu  +
sub edx ecx +
push edx  +
add eax 2 +
push eax  +
call sub_1027F64  +
add esp 10h +
test eax eax +
jl loc_103B0C0  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103B096  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aFriendlytypena  +
push [ebp+var_418]  +
call esi  +
mov eax dword_103FCC0[ebx] +
cmp eax edi +
jz loc_103B22E  +
push 452h  +
push 0A28h  +
push 1  +
push 5  +
mov dword ptr [ebp+uID] eax +
call sub_102FFFB  +
test eax eax +
jz loc_103B10C  +
push off_103FCB8[ebx]  +
push offset aVideoAsf  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_103B10C  +
mov dword ptr [ebp+uID] 2727h +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
push dword ptr [ebp+uID]  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_103B22E  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103B13B  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aDescription  +
push [ebp+var_418]  +
call esi  +
push 40h  +
pop eax  +
mov word ptr [ebp+Buffer] ax +
push 103h  +
lea eax [ebp+Buffer+2] +
push eax  +
call sub_102FC69  +
test eax eax +
jz loc_103B22E  +
push offset asc_1008E50  +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_103B22E  +
lea eax [ebp+Buffer] +
push 2Dh  +
push eax  +
call ds:wcsrchr  +
pop ecx  +
pop ecx  +
cmp eax edi +
jz loc_103B22E  +
lea ecx [ebp+Buffer] +
lea ebx [ecx+2] +
mov dx [ecx] +
inc ecx  +
inc ecx  +
cmp dx di +
jnz loc_103B1C4  +
push dword ptr [ebp+uID]  +
sub ecx ebx +
sar ecx 1 +
mov edx 103h +
push offset aLu  +
sub edx ecx +
push edx  +
add eax 2 +
push eax  +
call sub_1027F64  +
add esp 10h +
test eax eax +
jl loc_103B228  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103B1FE  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aDescriptionfri  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+var_41C] +
cmp off_103FCC4[ebx] edi +
jz loc_103B2BC  +
push 452h  +
push 0A28h  +
push 1  +
push 5  +
call sub_102FFFB  +
test eax eax +
jz loc_103B281  +
push off_103FCB8[ebx]  +
push offset aVideoAsf  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_103B281  +
push 44h  +
push offset a_asf_asx_wpl_w  +
push 1  +
push edi  +
push offset aExtensions_0  +
push [ebp+var_418]  +
call esi  +
jmp loc_103B2BC  +
mov eax dword ptr [ebp+var_41C] +
mov ecx off_103FCC4[eax] +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103B292  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aExtensions_0  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+var_41C] +
mov ecx off_103FCC8[ebx] +
cmp ecx edi +
jz loc_103B2F5  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103B2CB  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aMimeTypes_0  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+var_41C] +
mov ecx dword_103FCCC[ebx] +
cmp ecx edi +
jz loc_103B32E  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103B304  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aProtocols  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+var_41C] +
mov ecx dword_103FCD0[ebx] +
cmp ecx edi +
jz loc_103B369  +
mov eax ecx +
lea ebx [eax+2] +
mov dx [eax] +
inc eax  +
inc eax  +
cmp dx di +
jnz loc_103B33D  +
sub eax ebx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push ecx  +
push 1  +
push edi  +
push offset aDevices_0  +
push [ebp+var_418]  +
call esi  +
mov ebx dword ptr [ebp+var_41C] +
jmp loc_103B37A  +
push offset aDevices_0  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
mov eax dword_103FCD4[ebx] +
cmp eax edi +
jz loc_103B3D1  +
push 1  +
push 104h  +
lea ecx [ebp+Buffer] +
push ecx  +
push eax  +
call sub_103C444  +
test eax eax +
jl loc_103B3E2  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103B3A5  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aRequiredfile  +
push [ebp+var_418]  +
call esi  +
jmp loc_103B3E2  +
push offset aRequiredfile  +
push [ebp+var_418]  +
call ds:RegDeleteValueW  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
add ebx 24h +
mov dword ptr [ebp+var_41C] ebx +
cmp ebx 2ACh +
jb loc_103AF4D  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
inc [ebp+var_434]  +
cmp [ebp+var_434] 2 +
jl loc_103A01F  +
push edi  +
push edi  +
push edi  +
push 6  +
call sub_102FFFB  +
test eax eax +
jnz loc_103B6FD  +
push edi  +
lea eax [ebp+var_418] +
push eax  +
push edi  +
push 2  +
push edi  +
push edi  +
push edi  +
push offset aMediaTypeExten  +
push 80000000h  +
call ds:RegCreateKeyExW  +
mov ebx offset aSubtype +
test eax eax +
jnz loc_103B4B4  +
push 4Eh  +
push offset aE436ebb5524f11  +
push 1  +
push edi  +
push offset aSourceFilter  +
push [ebp+var_418]  +
call esi  +
push 4Eh  +
push offset aE436eb83524f11  +
push 1  +
push edi  +
push offset aMediaType  +
push [ebp+var_418]  +
call esi  +
push 4Eh  +
push offset aA98c8400418111  +
push 1  +
push edi  +
push ebx  +
push [ebp+var_418]  +
call esi  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+var_418] +
push eax  +
push edi  +
push 2  +
push edi  +
push edi  +
push edi  +
push offset aMediaTypeExt_0  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103B523  +
push 4Eh  +
push offset aC9f5fe02F8514e  +
push 1  +
push edi  +
push offset aSourceFilter  +
push [ebp+var_418]  +
call esi  +
push 4Eh  +
push offset aE436eb83524f11  +
push 1  +
push edi  +
push offset aMediaType  +
push [ebp+var_418]  +
call esi  +
push 4Eh  +
push offset aE06d8023Db4611  +
push 1  +
push edi  +
push ebx  +
push [ebp+var_418]  +
call esi  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+var_418] +
push eax  +
push edi  +
push 2  +
push edi  +
push edi  +
push edi  +
push offset a_wmdb  +
push 80000000h  +
call ds:RegCreateKeyExW  +
mov ebx offset aWmp_wmdbfile +
test eax eax +
jnz loc_103B565  +
push 1Ah  +
push ebx  +
push 1  +
push edi  +
push edi  +
push [ebp+var_418]  +
call esi  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+var_418] +
push eax  +
push edi  +
push 2  +
push edi  +
push edi  +
push edi  +
push ebx  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103B663  +
push 2  +
push offset byte_1002720  +
push 1  +
push edi  +
push offset aNoopen  +
push [ebp+var_418]  +
call esi  +
mov ebx 104h +
push ebx  +
lea eax [ebp+Buffer] +
push eax  +
push 26C4h  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_103B5EF  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103B5C9  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+var_418]  +
call esi  +
push 103h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_102FC69  +
test eax eax +
jz loc_103B657  +
lea eax [ebp+Buffer] +
push eax  +
push offset a@S9924  +
lea eax [ebp+FileName] +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
test eax eax +
jl loc_103B657  +
lea eax [ebp+FileName] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103B62D  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+FileName] +
push eax  +
push 1  +
push edi  +
push offset aFriendlytypena  +
push [ebp+var_418]  +
call esi  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+var_418] +
push eax  +
push edi  +
push 2  +
push edi  +
push edi  +
push edi  +
push offset aWmp_wmdbfileDe  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103B6FD  +
push 103h  +
push 1  +
lea eax [ebp+Buffer] +
push eax  +
call sub_10302A3  +
test eax eax +
jz loc_103B6F1  +
lea eax [ebp+Buffer] +
push eax  +
call sub_102E61A  +
push offset aWmplayer_exe12  +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_103B6F1  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103B6CB  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push edi  +
push [ebp+var_418]  +
call esi  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
push 452h  +
push 0A28h  +
push 1  +
push 5  +
call sub_102FFFB  +
test eax eax +
jz loc_103BADC  +
push edi  +
lea eax [ebp+var_418] +
push eax  +
push edi  +
push 2  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_58  +
push 80000002h  +
mov dword ptr [ebp+var_41C] edi +
call ds:RegCreateKeyExW  +
mov ebx 26C7h +
test eax eax +
jnz loc_103B8F9  +
push 1Eh  +
push offset aWmp_dvrMsfile  +
push 1  +
push edi  +
push offset aExtension_hand  +
push [ebp+var_418]  +
call esi  +
push 103h  +
push 1  +
lea eax [ebp+Buffer] +
push eax  +
call sub_10302A3  +
test eax eax +
jz loc_103B7D0  +
lea eax [ebp+Buffer] +
push eax  +
call sub_102E61A  +
push offset aWmplayer_exe12  +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_103B7D0  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103B7A6  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aMediatype_icon  +
push [ebp+var_418]  +
call esi  +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
push ebx  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_103B875  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103B7FA  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aMediatype_desc  +
push [ebp+var_418]  +
call esi  +
push ebx  +
push offset aLu  +
lea eax [ebp+Buffer] +
push 103h  +
push eax  +
call sub_1027F64  +
add esp 10h +
test eax eax +
jl loc_103B875  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103B84B  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push offset aMediatype_de_0  +
push [ebp+var_418]  +
call esi  +
push 0Ch  +
push offset aVideo  +
push 1  +
push edi  +
push offset aPerceivedtype  +
push [ebp+var_418]  +
call esi  +
push 1Ah  +
push offset aWmplayer_exe  +
push 1  +
push edi  +
push offset aReplaceapps  +
push [ebp+var_418]  +
call esi  +
push 4  +
pop ebx  +
push ebx  +
lea eax [ebp+var_41C] +
push eax  +
push ebx  +
push edi  +
push offset aRuntime  +
push [ebp+var_418]  +
mov dword ptr [ebp+var_41C] 7 +
call esi  +
push ebx  +
lea eax [ebp+var_41C] +
push eax  +
push ebx  +
push edi  +
push offset aPermissions  +
push [ebp+var_418]  +
mov dword ptr [ebp+var_41C] 0Fh +
call esi  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
mov ebx 26C7h +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
push ebx  +
push hInstance  +
mov dword ptr [ebp+var_41C] ebx +
call ds:LoadStringW  +
test eax eax +
jz loc_103BADC  +
push offset a_dvrMs  +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_103BADC  +
push edi  +
lea eax [ebp+var_418] +
push eax  +
push edi  +
push 2  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_59  +
push 80000002h  +
call ds:RegCreateKeyExW  +
mov ebx offset word_100B584 +
test eax eax +
jnz loc_103B9A0  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103B96E  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push ebx  +
push [ebp+var_418]  +
call esi  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+var_418] +
push eax  +
push edi  +
push 2  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_60  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103BA9B  +
push 40h  +
pop eax  +
mov word ptr [ebp+Buffer] ax +
push 103h  +
lea eax [ebp+Buffer+2] +
push eax  +
call sub_102FC69  +
test eax eax +
jz loc_103BA8F  +
push offset asc_1008E50  +
push 104h  +
lea eax [ebp+Buffer] +
push eax  +
call sub_1027EDD  +
test eax eax +
jl loc_103BA8F  +
lea eax [ebp+Buffer] +
push 2Dh  +
push eax  +
call ds:wcsrchr  +
pop ecx  +
pop ecx  +
cmp eax edi +
jz loc_103BA8F  +
lea ecx [ebp+Buffer] +
lea edx [ecx+2] +
mov [ebp+lpSubKey] edx +
mov dx [ecx] +
inc ecx  +
inc ecx  +
cmp dx di +
jnz loc_103BA2B  +
sub ecx [ebp+lpSubKey] +
push dword ptr [ebp+var_41C]  +
sar ecx 1 +
mov edx 103h +
push offset aLu  +
sub edx ecx +
push edx  +
add eax 2 +
push eax  +
call sub_1027F64  +
add esp 10h +
test eax eax +
jl loc_103BA8F  +
lea eax [ebp+Buffer] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx di +
jnz loc_103BA69  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
push 1  +
push edi  +
push ebx  +
push [ebp+var_418]  +
call esi  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
push edi  +
lea eax [ebp+var_418] +
push eax  +
push edi  +
push 2  +
push edi  +
push edi  +
push edi  +
push offset aSoftwareMic_61  +
push 80000002h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103BADC  +
push 12h  +
push offset a_dvrMs_0  +
push 1  +
push edi  +
push ebx  +
push [ebp+var_418]  +
call esi  +
push [ebp+var_418]  +
call ds:RegCloseKey  +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
and [ebp+var_4] 0 +
push edi  +
push offset aKernel32_dll_0  +
call ds:LoadLibraryW  +
mov edi eax +
test edi edi +
jz loc_103BB38  +
push esi  +
push offset aIswow64process  +
push edi  +
call ds:GetProcAddress  +
mov esi eax +
test esi esi +
jz loc_103BB30  +
call ds:GetCurrentProcess  +
test eax eax +
jz loc_103BB30  +
lea ecx [ebp+var_4] +
push ecx  +
push eax  +
call esi  +
push edi  +
call ds:FreeLibrary  +
pop esi  +
mov eax [ebp+var_4] +
pop edi  +
leave   +
retn   +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 428h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
push esi  +
xor esi esi +
mov [ebp+var_428] eax +
mov [ebp+hKey] esi +
mov [ebp+var_418] 80004005h +
cmp eax esi +
jnz loc_103BB82  +
mov eax 80004003h +
jmp loc_103BDB4  +
lea eax [ebp+hKey] +
push eax  +
push 1  +
push esi  +
push offset aSoftwareMic_29  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_103BDAE  +
mov ecx [ebp+arg_4] +
mov eax 208h +
mov [ebp+cbData] ecx +
mov [ebp+Type] 1 +
cmp ecx eax +
jbe loc_103BBC6  +
mov [ebp+cbData] eax +
push edi  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+PathName] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aProgramfilesdi  +
push [ebp+hKey]  +
call ds:RegQueryValueExW  +
mov edi ds:ExpandEnvironmentStringsW +
mov esi 104h +
test eax eax +
jnz loc_103BCCE  +
cmp [ebp+Type] 1 +
jz loc_103BC17  +
cmp [ebp+Type] 2 +
jnz loc_103BCCE  +
cmp [ebp+Type] 2 +
jnz loc_103BC51  +
push esi  +
lea eax [ebp+Buffer] +
push eax  +
lea eax [ebp+PathName] +
push eax  +
call edi  +
test eax eax +
jz loc_103BCCE  +
lea eax [ebp+Buffer] +
push eax  +
push 103h  +
lea eax [ebp+PathName] +
push eax  +
call sub_1027E68  +
lea eax [ebp+PathName] +
push eax  +
call sub_102FE6A  +
test eax eax +
jz loc_103BCA5  +
and [ebp+var_418] 0 +
lea eax [ebp+PathName] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_103BC71  +
mov ecx [ebp+arg_4] +
sub eax edx +
sar eax 1 +
shr ecx 1 +
inc eax  +
cmp ecx eax +
jbe loc_103BD8F  +
lea eax [ebp+PathName] +
push eax  +
push ecx  +
push [ebp+var_428]  +
call sub_1027E68  +
jmp loc_103BDA1  +
push 0  +
lea eax [ebp+PathName] +
push eax  +
call ds:CreateDirectoryW  +
lea eax [ebp+PathName] +
push eax  +
call sub_102FE6A  +
test eax eax +
jnz loc_103BC61  +
mov [ebp+var_418] 80004005h +
push esi  +
lea eax [ebp+Buffer] +
push eax  +
call ds:GetWindowsDirectoryW  +
test eax eax +
jz loc_103BDA1  +
push esi  +
lea eax [ebp+PathName] +
push eax  +
lea eax [ebp+Buffer] +
push eax  +
call edi  +
lea eax [ebp+PathName] +
push offset asc_1005894  +
push eax  +
call ds:wcsstr  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103BDA1  +
mov ecx eax +
lea edi [ecx+2] +
mov dx [ecx] +
inc ecx  +
inc ecx  +
test dx dx +
jnz loc_103BD16  +
sub ecx edi +
sar ecx 1 +
cmp ecx 4 +
jbe loc_103BDA1  +
xor ecx ecx +
mov [eax+4] cx +
push esi  +
lea eax [ebp+Buffer] +
push eax  +
push 26FCh  +
push hInstance  +
call ds:LoadStringW  +
test eax eax +
jz loc_103BDA1  +
lea eax [ebp+Buffer] +
push eax  +
push esi  +
lea eax [ebp+PathName] +
push eax  +
call sub_1027EDD  +
push 0  +
lea eax [ebp+PathName] +
push eax  +
call ds:CreateDirectoryW  +
lea eax [ebp+PathName] +
push eax  +
call sub_102FE6A  +
test eax eax +
jnz loc_103BC61  +
mov [ebp+var_418] 80004005h +
jmp loc_103BDA1  +
mov eax 8007007Ah +
push eax  +
mov [ebp+var_418] eax +
call ds:SetLastError  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
mov eax [ebp+var_418] +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 21Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
and [ebp+hKey] 0 +
push esi  +
mov [ebp+var_21C] eax +
mov esi 80004005h +
test eax eax +
jnz loc_103BDFF  +
lea eax [esi-2] +
jmp loc_103BF12  +
lea eax [ebp+hKey] +
push eax  +
push 1  +
push 0  +
push offset aSoftwareMic_29  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_103BF10  +
push ebx  +
mov ebx [ebp+arg_4] +
mov esi 208h +
mov [ebp+cbData] ebx +
mov [ebp+Type] 1 +
cmp ebx esi +
jbe loc_103BE45  +
mov [ebp+cbData] esi +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+PathName] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aCommonfilesdir  +
push [ebp+hKey]  +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103BEAD  +
cmp [ebp+Type] 1 +
jnz loc_103BEAD  +
lea eax [ebp+PathName] +
push eax  +
call sub_102FE6A  +
test eax eax +
jz loc_103BE8E  +
xor esi esi +
jmp loc_103BEC0  +
push 0  +
lea eax [ebp+PathName] +
push eax  +
call ds:CreateDirectoryW  +
lea eax [ebp+PathName] +
push eax  +
call sub_102FE6A  +
test eax eax +
jnz loc_103BE8A  +
push esi  +
lea eax [ebp+PathName] +
push eax  +
call sub_103BB43  +
mov esi eax +
test esi esi +
jnz loc_103BF03  +
lea eax [ebp+PathName] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_103BEC9  +
sub eax edx +
sar eax 1 +
mov ecx ebx +
shr ecx 1 +
inc eax  +
cmp ecx eax +
jbe loc_103BEF5  +
lea eax [ebp+PathName] +
push eax  +
push ecx  +
push [ebp+var_21C]  +
call sub_1027E68  +
jmp loc_103BF03  +
mov eax 8007007Ah +
push eax  +
mov esi eax +
call ds:SetLastError  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop ebx  +
mov eax esi +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 218h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_0] +
and [ebp+pidl] 0 +
push ebx  +
push esi  +
mov [ebp+var_218] eax +
lea eax [ebp+pidl] +
push eax  +
push 23h  +
xor esi esi +
push esi  +
call ds:SHGetSpecialFolderLocation  +
mov ebx eax +
test ebx ebx +
jl loc_103BFBA  +
and [ebp+ppMalloc] esi +
lea eax [ebp+PathName] +
push eax  +
push [ebp+pidl]  +
call ds:SHGetPathFromIDListW  +
test eax eax +
jz loc_103BF83  +
inc esi  +
lea eax [ebp+ppMalloc] +
push eax  +
call ds:SHGetMalloc  +
test eax eax +
jl loc_103BFB6  +
mov eax [ebp+ppMalloc] +
test eax eax +
jz loc_103BFB6  +
push [ebp+pidl]  +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+14h]  +
mov eax [ebp+ppMalloc] +
mov ecx [eax] +
push eax  +
call dword ptr [ecx+8]  +
test esi esi +
jnz loc_103BFEC  +
mov esi 104h +
push esi  +
lea eax [ebp+PathName] +
push eax  +
call ds:GetWindowsDirectoryW  +
test eax eax +
jz loc_103BFE7  +
push offset aAllUsersApplic  +
push esi  +
lea eax [ebp+PathName] +
push eax  +
call sub_1027EDD  +
test eax eax +
jge loc_103BFEC  +
mov ebx 80070057h +
test ebx ebx +
jl loc_103C064  +
lea eax [ebp+PathName] +
push eax  +
call sub_102FE6A  +
test eax eax +
jz loc_103C004  +
xor ebx ebx +
jmp loc_103C029  +
push 0  +
lea eax [ebp+PathName] +
push eax  +
call ds:CreateDirectoryW  +
lea eax [ebp+PathName] +
push eax  +
call sub_102FE6A  +
test eax eax +
jz loc_103C025  +
xor ebx ebx +
test ebx ebx +
jnz loc_103C064  +
lea eax [ebp+PathName] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_103C032  +
mov ecx [ebp+arg_4] +
sub eax edx +
sar eax 1 +
shr ecx 1 +
inc eax  +
cmp ecx eax +
jbe loc_103C05F  +
lea eax [ebp+PathName] +
push eax  +
push ecx  +
push [ebp+var_218]  +
call sub_1027E68  +
jmp loc_103C064  +
mov ebx 8007007Ah +
mov ecx [ebp+var_4] +
pop esi  +
mov eax ebx +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ecx  +
and [ebp+var_4] 0 +
cmp [ebp+lpBuffer] 0 +
push ebx  +
push esi  +
mov ebx 80004005h +
push edi  +
mov edi ebx +
jz loc_103C433  +
mov esi [ebp+arg_4] +
test esi esi +
jz loc_103C433  +
lea eax [ebp+var_4] +
push eax  +
push offset aLu  +
push [ebp+lpBuffer]  +
call ds:swscanf  +
add esp 0Ch +
test eax eax +
jnz loc_103C0C7  +
mov eax 80070057h +
jmp loc_103C438  +
mov eax [ebp+var_4] +
cmp eax 0FFFFFFFFh +
jz loc_103C0BD  +
cmp eax 19h +
ja loc_103C314  +
jz loc_103C303  +
cmp eax 11h +
ja loc_103C1FE  +
jz loc_103C1BB  +
sub eax 0 +
jz loc_103C42F  +
dec eax  +
jz loc_103C1A9  +
sub eax 9 +
jz loc_103C303  +
dec eax  +
jz loc_103C170  +
dec eax  +
jnz loc_103C42F  +
shr esi 1 +
push esi  +
push [ebp+lpBuffer]  +
call ds:GetSystemDirectoryW  +
test eax eax +
jz loc_103C124  +
xor edi edi +
jmp loc_103C149  +
call ds:GetLastError  +
test eax eax +
jnz loc_103C133  +
push 57h  +
pop eax  +
test eax eax +
jle loc_103C13F  +
and eax 0FFFFh +
or eax 80070000h +
mov edi eax +
test edi edi +
jnz loc_103C42F  +
push 0  +
push 4  +
call sub_102EABA  +
test eax eax +
jz loc_103C15D  +
push offset aIosubsys  +
jmp loc_103C162  +
push offset aDrivers  +
push esi  +
push [ebp+lpBuffer]  +
call sub_1027EDD  +
jmp loc_103C42F  +
shr esi 1 +
push esi  +
push [ebp+lpBuffer]  +
call ds:GetSystemDirectoryW  +
jmp loc_103C1B5  +
xor edi edi +
jmp loc_103C42F  +
call ds:GetLastError  +
test eax eax +
jnz loc_103C194  +
push 57h  +
pop eax  +
test eax eax +
jle loc_103C42D  +
and eax 0FFFFh +
or eax 80070000h +
jmp loc_103C42D  +
push [ebp+lpBuffer]  +
shr esi 1 +
push esi  +
call ds:GetCurrentDirectoryW  +
test eax eax +
jnz loc_103C17E  +
jmp loc_103C185  +
shr esi 1 +
push esi  +
push [ebp+lpBuffer]  +
call ds:GetSystemWindowsDirectoryW  +
test eax eax +
jz loc_103C1CF  +
xor edi edi +
jmp loc_103C1F4  +
call ds:GetLastError  +
test eax eax +
jnz loc_103C1DE  +
push 57h  +
pop eax  +
test eax eax +
jle loc_103C1EA  +
and eax 0FFFFh +
or eax 80070000h +
mov edi eax +
test edi edi +
jnz loc_103C42F  +
push offset aInf  +
jmp loc_103C162  +
sub eax 12h +
jz loc_103C2C0  +
dec eax  +
dec eax  +
jz loc_103C27D  +
dec eax  +
jz loc_103C42F  +
dec eax  +
dec eax  +
jz loc_103C42F  +
dec eax  +
jnz loc_103C42F  +
shr esi 1 +
push esi  +
push [ebp+lpBuffer]  +
call ds:GetSystemDirectoryW  +
test eax eax +
jz loc_103C235  +
xor edi edi +
jmp loc_103C25A  +
call ds:GetLastError  +
test eax eax +
jnz loc_103C244  +
push 57h  +
pop eax  +
test eax eax +
jle loc_103C250  +
and eax 0FFFFh +
or eax 80070000h +
mov edi eax +
test edi edi +
jnz loc_103C42F  +
push offset asc_1005894  +
push [ebp+lpBuffer]  +
call ds:wcsstr  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103C42F  +
xor ecx ecx +
mov [eax+4] cx +
jmp loc_103C42F  +
shr esi 1 +
push esi  +
push [ebp+lpBuffer]  +
call ds:GetSystemWindowsDirectoryW  +
test eax eax +
jz loc_103C291  +
xor edi edi +
jmp loc_103C2B6  +
call ds:GetLastError  +
test eax eax +
jnz loc_103C2A0  +
push 57h  +
pop eax  +
test eax eax +
jle loc_103C2AC  +
and eax 0FFFFh +
or eax 80070000h +
mov edi eax +
test edi edi +
jnz loc_103C42F  +
push offset aFonts  +
jmp loc_103C162  +
shr esi 1 +
push esi  +
push [ebp+lpBuffer]  +
call ds:GetSystemWindowsDirectoryW  +
test eax eax +
jz loc_103C2D4  +
xor edi edi +
jmp loc_103C2F9  +
call ds:GetLastError  +
test eax eax +
jnz loc_103C2E3  +
push 57h  +
pop eax  +
test eax eax +
jle loc_103C2EF  +
and eax 0FFFFh +
or eax 80070000h +
mov edi eax +
test edi edi +
jnz loc_103C42F  +
push offset aHelp  +
jmp loc_103C162  +
shr esi 1 +
push esi  +
push [ebp+lpBuffer]  +
call ds:GetSystemWindowsDirectoryW  +
jmp loc_103C1B5  +
cmp eax 4019h +
ja loc_103C3CC  +
cmp eax 4016h +
jnb loc_103C42F  +
cmp eax 1Eh +
jz loc_103C42F  +
cmp eax 32h +
jz loc_103C42F  +
cmp eax 33h +
jz loc_103C38D  +
cmp eax 34h +
jnz loc_103C42F  +
shr esi 1 +
push esi  +
push [ebp+lpBuffer]  +
call ds:GetSystemWindowsDirectoryW  +
test eax eax +
jz loc_103C35E  +
xor edi edi +
jmp loc_103C383  +
call ds:GetLastError  +
test eax eax +
jnz loc_103C36D  +
push 57h  +
pop eax  +
test eax eax +
jle loc_103C379  +
and eax 0FFFFh +
or eax 80070000h +
mov edi eax +
test edi edi +
jnz loc_103C42F  +
push offset aSpoolDrivers  +
jmp loc_103C162  +
shr esi 1 +
push esi  +
push [ebp+lpBuffer]  +
call ds:GetSystemWindowsDirectoryW  +
test eax eax +
jz loc_103C3A1  +
xor edi edi +
jmp loc_103C3C2  +
call ds:GetLastError  +
test eax eax +
jnz loc_103C3B0  +
push 57h  +
pop eax  +
test eax eax +
jle loc_103C3BC  +
and eax 0FFFFh +
or eax 80070000h +
mov edi eax +
test edi edi +
jnz loc_103C42F  +
push offset aSpool  +
jmp loc_103C162  +
sub eax 401Fh +
jz loc_103C42F  +
sub eax 4 +
jz loc_103C422  +
sub eax 3 +
jz loc_103C415  +
sub eax 5 +
jz loc_103C408  +
sub eax 3825h +
jnz loc_103C42F  +
push 104h  +
push 1  +
push [ebp+lpBuffer]  +
call sub_10302A3  +
mov edi eax +
neg edi  +
sbb edi edi +
and edi 7FFFBFFBh +
add edi ebx +
jmp loc_103C42F  +
shr esi 1 +
push esi  +
push [ebp+lpBuffer]  +
call sub_103BDC8  +
jmp loc_103C42D  +
shr esi 1 +
push esi  +
push [ebp+lpBuffer]  +
call sub_103BB43  +
jmp loc_103C42D  +
shr esi 1 +
push esi  +
push [ebp+lpBuffer]  +
call sub_103BF26  +
mov edi eax +
mov eax edi +
jmp loc_103C438  +
mov eax 80004003h +
pop edi  +
pop esi  +
pop ebx  +
leave   +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 10h +
push ebx  +
mov ebx [ebp+lpBuffer] +
push esi  +
xor esi esi +
push edi  +
mov [ebp+var_C] esi +
mov [ebp+var_4] esi +
mov [ebp+var_10] esi +
mov [ebp+var_8] ebx +
cmp [ebp+arg_0] esi +
jz loc_103C597  +
mov edi [ebp+arg_4] +
cmp edi esi +
jz loc_103C597  +
cmp [ebp+arg_0] edi +
jz loc_103C597  +
push [ebp+arg_0]  +
push ebx  +
push edi  +
call sub_1027E68  +
push 22h  +
pop eax  +
cmp ax [edi] +
jnz loc_103C499  +
inc esi  +
lea eax [ebx-1] +
mov [ebp+var_4] esi +
mov [ebp+var_8] eax +
cmp esi ebx +
jnb loc_103C588  +
add esi esi +
push 25h  +
lea eax [esi+edi] +
pop ecx  +
mov [ebp+lpBuffer] eax +
cmp cx [eax] +
jnz loc_103C588  +
xor ecx ecx +
push 2  +
pop edx  +
lea eax [ebx+1] +
mul  edx +
seto cl  +
neg ecx  +
or ecx eax +
push ecx  +
call ??_U@YAPAXI@Z  +
mov edi eax +
pop ecx  +
test edi edi +
jz loc_103C578  +
push [ebp+arg_4]  +
push ebx  +
push edi  +
call sub_1027E68  +
cmp [ebp+var_4] 0 +
lea eax [esi+edi+2] +
push eax  +
jz loc_103C4FF  +
push offset aS_2  +
push ebx  +
push [ebp+arg_4]  +
call sub_1027F64  +
add esp 10h +
jmp loc_103C508  +
push ebx  +
push [ebp+arg_4]  +
call sub_1027E68  +
push offset asc_100C214  +
push [ebp+arg_4]  +
call ds:wcsstr  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103C56F  +
xor ecx ecx +
mov [eax] cx +
add eax 2 +
push eax  +
push ebx  +
push edi  +
call sub_1027E68  +
mov esi [ebp+var_8] +
lea eax [esi+esi] +
push eax  +
push [ebp+lpBuffer]  +
call sub_103C07B  +
test eax eax +
jl loc_103C56F  +
cmp [ebp+arg_C] 0 +
jnz loc_103C55E  +
push [ebp+lpBuffer]  +
call sub_102FE6A  +
test eax eax +
jz loc_103C55E  +
push esi  +
push [ebp+lpBuffer]  +
push [ebp+lpBuffer]  +
call ds:GetShortPathNameW  +
push edi  +
push esi  +
push [ebp+arg_4]  +
call sub_1027EDD  +
mov [ebp+var_C] 1 +
push edi  +
call ??_V@YAXPAX@Z  +
pop ecx  +
jmp loc_103C57F  +
mov [ebp+var_10] 8007000Eh +
cmp [ebp+var_C] 0 +
jnz loc_103C592  +
mov edi [ebp+arg_4] +
push [ebp+arg_0]  +
push ebx  +
push edi  +
call sub_1027E68  +
mov eax [ebp+var_10] +
jmp loc_103C59C  +
mov eax 80004003h +
pop edi  +
pop esi  +
pop ebx  +
leave   +
retn 10h  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push ebx  +
mov ebx [ebp+arg_0] +
test ebx ebx +
jnz loc_103C5BC  +
xor eax eax +
jmp loc_103C655  +
mov eax ebx +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_103C5C1  +
sub eax edx +
mov edx lpData +
push esi  +
mov ecx edx +
sar eax 1 +
lea esi [ecx+2] +
push edi  +
mov di [ecx] +
inc ecx  +
inc ecx  +
test di di +
jnz loc_103C5DC  +
sub ecx esi +
sar ecx 1 +
cmp eax ecx +
jnz loc_103C651  +
mov esi ds:_wcsicmp +
push edx  +
push ebx  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103C64C  +
cmp [ebp+arg_4] 0 +
jz loc_103C613  +
push off_103F018  +
push ebx  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103C64C  +
mov edi ds:_wcsnicmp +
push 7  +
push offset aCd3afa  +
push ebx  +
call edi  +
add esp 0Ch +
test eax eax +
jnz loc_103C63E  +
push 1Dh  +
lea eax [ebx+12h] +
push offset aB84f48f093937e  +
push eax  +
call edi  +
add esp 0Ch +
test eax eax +
jz loc_103C64C  +
push offset aEe4da6a48c524a  +
push ebx  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_103C651  +
xor eax eax +
inc eax  +
jmp loc_103C653  +
xor eax eax +
pop edi  +
pop esi  +
pop ebx  +
pop ebp  +
retn 8  +
***
mov edi edi +
push ebp  +
mov ebp esp +
push esi  +
push 1  +
push [ebp+arg_0]  +
call sub_103C5A8  +
test eax eax +
jnz loc_103C69D  +
mov esi ds:_wcsicmp +
push offset a2533692003f911  +
push [ebp+arg_0]  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103C69D  +
push offset a00022601000000  +
push [ebp+arg_0]  +
call esi  +
pop ecx  +
pop ecx  +
test eax eax +
jz loc_103C69D  +
xor eax eax +
jmp loc_103C6A0  +
xor eax eax +
inc eax  +
pop esi  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 1A4h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax dword ptr [ebp+arg_0] +
push esi  +
xor esi esi +
mov [ebp+hKey] esi +
mov [ebp+cbData] esi +
cmp eax esi +
jz loc_103C860  +
push eax  +
push offset aMimeDatabaseCo  +
lea eax [ebp+Data] +
push 0C7h  +
push eax  +
call sub_1027F64  +
add esp 10h +
test eax eax +
jl loc_103C860  +
lea eax [ebp+hKey] +
push eax  +
push 3  +
push esi  +
lea eax [ebp+Data] +
push eax  +
push 80000000h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_103C860  +
push edi  +
mov edi ds:RegQueryValueExW +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
mov esi offset aClsid +
push esi  +
push [ebp+hKey]  +
mov [ebp+Type] 1 +
mov [ebp+cbData] 190h +
call edi  +
test eax eax +
jnz loc_103C853  +
cmp [ebp+Type] 1 +
jnz loc_103C853  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_103C77C  +
sub eax edx +
sar eax 1 +
jz loc_103C853  +
push 0  +
lea eax [ebp+Data] +
push eax  +
call sub_103C5A8  +
test eax eax +
jz loc_103C853  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push 0  +
push offset aMplayer2_bak_c  +
push [ebp+hKey]  +
mov [ebp+cbData] 190h +
call edi  +
test eax eax +
jnz loc_103C846  +
cmp [ebp+Type] 1 +
jnz loc_103C846  +
push eax  +
lea eax [ebp+Data] +
push eax  +
call sub_103C5A8  +
mov edi ds:RegDeleteValueW +
test eax eax +
jz loc_103C803  +
push esi  +
push [ebp+hKey]  +
call edi  +
jmp loc_103C837  +
lea eax [ebp+Data] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
test cx cx +
jnz loc_103C80C  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+Data] +
push eax  +
push 1  +
push 0  +
push esi  +
push [ebp+hKey]  +
call ds:RegSetValueExW  +
push offset aMplayer2_bak_c  +
push [ebp+hKey]  +
call edi  +
jmp loc_103C853  +
push esi  +
push [ebp+hKey]  +
call ds:RegDeleteValueW  +
push [ebp+hKey]  +
call ds:RegCloseKey  +
pop edi  +
mov ecx [ebp+var_4] +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 430h +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
mov eax [ebp+arg_4] +
mov ecx [ebp+arg_8] +
push esi  +
xor esi esi +
push edi  +
mov edi dword ptr [ebp+arg_0] +
mov dword ptr [ebp+lpData] eax +
mov [ebp+var_42C] ecx +
mov [ebp+phkResult] esi +
mov [ebp+dwDisposition] esi +
mov [ebp+var_430] esi +
cmp edi esi +
jz loc_103CC18  +
cmp eax esi +
jnz loc_103C8C8  +
cmp ecx esi +
jz loc_103CC18  +
push ebx  +
push edi  +
push offset aMimeDatabaseCo  +
mov ebx 103h +
lea eax [ebp+SubKey] +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 10h +
test eax eax +
jl loc_103CC17  +
push edi  +
push lpSubKey  +
lea eax [ebp+Data] +
push offset aSMimeTypesS_0  +
push ebx  +
push eax  +
call sub_1027F64  +
add esp 14h +
test eax eax +
jl loc_103C9A6  +
lea eax [ebp+hKey] +
push eax  +
xor edi edi +
inc edi  +
push edi  +
push esi  +
lea eax [ebp+Data] +
push eax  +
push hKey  +
mov [ebp+hKey] esi +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_103C9A6  +
lea eax [ebp+dwDisposition] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aUserapprovedow  +
push [ebp+hKey]  +
mov [ebp+dwDisposition] 208h +
mov [ebp+Type] edi +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103C99A  +
cmp [ebp+Type] edi +
jnz loc_103C99A  +
lea eax [ebp+Data] +
push offset aYes  +
push eax  +
call ds:_wcsicmp  +
pop ecx  +
pop ecx  +
test eax eax +
jnz loc_103C99A  +
mov [ebp+var_430] edi +
push [ebp+hKey]  +
call ds:RegCloseKey  +
lea eax [ebp+dwDisposition] +
push eax  +
lea eax [ebp+phkResult] +
push eax  +
push esi  +
push 2001Fh  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000000h  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103CC17  +
mov eax dword ptr [ebp+lpData] +
mov edi ds:RegSetValueExW +
mov [ebp+hKey] 1 +
cmp eax esi +
jz loc_103CBD1  +
push 7Bh  +
pop ecx  +
cmp cx [eax] +
jnz loc_103CBD1  +
lea eax [ebp+dwDisposition] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
mov ebx offset aClsid +
push ebx  +
push [ebp+phkResult]  +
mov [ebp+dwDisposition] 208h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103CAB5  +
cmp [ebp+hKey] 1 +
jnz loc_103CAB5  +
cmp [ebp+var_430] esi +
jnz loc_103CA5C  +
lea eax [ebp+SubKey] +
push eax  +
call sub_103C65F  +
test eax eax +
jz loc_103CAE3  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
call sub_103C5A8  +
test eax eax +
jnz loc_103CAA0  +
lea eax [ebp+SubKey] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_103CA76  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
push 1  +
push esi  +
push offset aMplayer2_bak_c  +
push [ebp+phkResult]  +
call edi  +
mov eax dword ptr [ebp+lpData] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_103CAA9  +
jmp loc_103CAC8  +
mov eax dword ptr [ebp+lpData] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_103CABE  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push dword ptr [ebp+lpData]  +
push 1  +
push esi  +
push ebx  +
push [ebp+phkResult]  +
call edi  +
push dword ptr [ebp+lpData]  +
lea eax [ebp+SubKey] +
push offset aClsidSProgid  +
push 103h  +
push eax  +
mov [ebp+Type] esi +
call sub_1027F64  +
add esp 10h +
lea eax [ebp+Type] +
push eax  +
push 1  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
mov ebx 80000000h +
push ebx  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_103CBD1  +
lea eax [ebp+dwDisposition] +
push eax  +
lea eax [ebp+SubKey] +
push eax  +
lea eax [ebp+hKey] +
push eax  +
push esi  +
push esi  +
push [ebp+Type]  +
mov [ebp+dwDisposition] 208h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103CBC5  +
cmp [ebp+hKey] 1 +
jnz loc_103CBC5  +
lea eax [ebp+dwDisposition] +
push eax  +
lea eax [ebp+lpData] +
push eax  +
push esi  +
push 2001Fh  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push ebx  +
mov dword ptr [ebp+lpData] esi +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103CBC5  +
push 4  +
lea eax [ebp+dwDisposition] +
push eax  +
push 4  +
push esi  +
push offset aPreferexecuteo  +
push dword ptr [ebp+lpData]  +
mov [ebp+dwDisposition] 1 +
call edi  +
push dword ptr [ebp+lpData]  +
call ds:RegCloseKey  +
push [ebp+Type]  +
call ds:RegCloseKey  +
cmp [ebp+var_42C] esi +
jz loc_103CC0B  +
mov eax [ebp+var_42C] +
lea edx [eax+2] +
mov cx [eax] +
inc eax  +
inc eax  +
cmp cx si +
jnz loc_103CBE2  +
sub eax edx +
sar eax 1 +
lea eax [eax+eax+2] +
push eax  +
push [ebp+var_42C]  +
push 1  +
push esi  +
push offset aExtension  +
push [ebp+phkResult]  +
call edi  +
push [ebp+phkResult]  +
call ds:RegCloseKey  +
pop ebx  +
mov ecx [ebp+var_4] +
pop edi  +
xor ecx ebp +
pop esi  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
***
mov edi edi +
push ebp  +
mov ebp esp +
pop ebp  +
jmp loc_103C6AA  +
***
mov edi edi +
push ebp  +
mov ebp esp +
mov eax [ebp+arg_0] +
lea ecx [eax+3E8h] +
push ecx  +
lea ecx [eax+320h] +
push ecx  +
push eax  +
call sub_103C874  +
pop ebp  +
retn 4  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 62Ch +
mov eax dword_103F058 +
xor eax ebp +
mov [ebp+var_4] eax +
push ebx  +
mov ebx [ebp+arg_0] +
push esi  +
xor esi esi +
push edi  +
lea ecx [ebp+var_62C] +
mov [ebp+hKey] esi +
call sub_1031EAC  +
xor edi edi +
inc edi  +
mov [ebp+var_608] edi +
cmp ebx esi +
jnz loc_103CCBE  +
lea ecx [ebp+var_62C] +
call sub_1031ECD  +
xor eax eax +
mov ecx [ebp+var_4] +
pop edi  +
pop esi  +
xor ecx ebp +
pop ebx  +
call sub_102DF7D  +
leave   +
retn 0Ch  +
cmp [ebp+arg_8] esi +
jz loc_103CCD3  +
lea eax [ebp+var_62C] +
push eax  +
call sub_103802C  +
test eax eax +
jz loc_103CCA0  +
push ebx  +
push lpSubKey  +
lea eax [ebp+Data] +
push offset aSGroupsS  +
push 103h  +
push eax  +
call sub_1027F64  +
add esp 14h +
test eax eax +
jl loc_103CCA0  +
lea eax [ebp+hKey] +
push eax  +
push 2001Fh  +
push esi  +
lea eax [ebp+Data] +
push eax  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jz loc_103CD29  +
lea ecx [ebp+var_62C] +
call sub_1031ECD  +
mov eax esi +
jmp loc_103CCAD  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aExtensions_0  +
push [ebp+hKey]  +
mov [ebp+phkResult] esi +
mov [ebp+cbData] 208h +
mov [ebp+Type] edi +
call ds:RegQueryValueExW  +
mov ebx ds:RegSetValueExW +
mov edi ds:RegCloseKey +
test eax eax +
jnz loc_103CF6E  +
cmp [ebp+Type] 1 +
jnz loc_103CF6E  +
lea eax [ebp+Data] +
push eax  +
mov [ebp+var_5FC] eax +
push 95h  +
lea eax [ebp+var_130] +
push eax  +
call sub_1027E68  +
lea eax [ebp+var_130] +
push 20h  +
push eax  +
call ds:wcschr  +
pop ecx  +
pop ecx  +
cmp eax esi +
jz loc_103CDBF  +
xor ecx ecx +
mov [eax] cx +
lea eax [ebp+var_130] +
push eax  +
push lpSubKey  +
lea eax [ebp+SubKey] +
push offset aSExtensionsS  +
push 0C7h  +
push eax  +
call sub_1027F64  +
add esp 14h +
cmp [ebp+arg_4] esi +
jz loc_103CE77  +
test eax eax +
jl loc_103CE52  +
push esi  +
lea eax [ebp+phkResult] +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push hKey  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103CE36  +
push 8  +
push offset aYes  +
push 1  +
push esi  +
push offset aUserapprovedow  +
push [ebp+phkResult]  +
call ebx  +
push [ebp+phkResult]  +
call edi  +
cmp [ebp+arg_8] esi +
jz loc_103CE58  +
lea eax [ebp+var_130] +
push eax  +
lea eax [ebp+var_62C] +
push eax  +
call sub_10396F5  +
test eax eax +
jnz loc_103CE58  +
mov [ebp+var_608] esi +
push 20h  +
push [ebp+var_5FC]  +
call ds:wcschr  +
pop ecx  +
pop ecx  +
cmp eax esi +
jz loc_103CF6E  +
inc eax  +
inc eax  +
jmp loc_103CD8D  +
test eax eax +
jl loc_103CE52  +
push esi  +
lea eax [ebp+phkResult] +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push hKey  +
call ds:RegCreateKeyExW  +
test eax eax +
jnz loc_103CEBF  +
push 6  +
push offset aNo  +
push 1  +
push esi  +
push offset aUserapprovedow  +
push [ebp+phkResult]  +
call ebx  +
push [ebp+phkResult]  +
call edi  +
cmp [ebp+arg_8] esi +
jz loc_103CE58  +
lea eax [ebp+phkResult] +
push eax  +
push 20006h  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push 80000002h  +
call ds:RegOpenKeyExW  +
test eax eax +
jnz loc_103CE58  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+var_5F4] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aExtension_hand  +
push [ebp+phkResult]  +
mov [ebp+cbData] 12Ch +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103CF29  +
cmp [ebp+Type] 1 +
jz loc_103CF49  +
lea eax [ebp+var_130] +
push eax  +
push offset aSfile  +
lea eax [ebp+var_5F4] +
push 95h  +
push eax  +
call sub_1027F64  +
add esp 10h +
push offset aPlay  +
lea eax [ebp+var_5F4] +
push eax  +
lea eax [ebp+var_130] +
push eax  +
call sub_10350D6  +
push [ebp+phkResult]  +
call edi  +
jmp loc_103CE58  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aMimeTypes_0  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103D0CE  +
cmp [ebp+Type] 1 +
jnz loc_103D0CE  +
lea eax [ebp+Data] +
push eax  +
mov [ebp+var_5FC] eax +
push 95h  +
lea eax [ebp+var_130] +
push eax  +
call sub_1027E68  +
lea eax [ebp+var_130] +
push 20h  +
push eax  +
call ds:wcschr  +
pop ecx  +
pop ecx  +
cmp eax esi +
jz loc_103CFEC  +
xor ecx ecx +
mov [eax] cx +
lea eax [ebp+var_130] +
push eax  +
push lpSubKey  +
lea eax [ebp+SubKey] +
push offset aSMimeTypesS  +
push 0C7h  +
push eax  +
call sub_1027F64  +
add esp 14h +
push esi  +
lea eax [ebp+phkResult] +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push hKey  +
call ds:RegCreateKeyExW  +
cmp [ebp+arg_4] esi +
jz loc_103D07F  +
test eax eax +
jnz loc_103D05B  +
push 8  +
push offset aYes  +
push 1  +
push esi  +
push offset aUserapprovedow  +
push [ebp+phkResult]  +
call ebx  +
push [ebp+phkResult]  +
call edi  +
cmp [ebp+arg_8] esi +
jz loc_103D0B3  +
lea eax [ebp+var_130] +
push eax  +
lea eax [ebp+var_62C] +
push eax  +
call sub_1039746  +
test eax eax +
jnz loc_103D0B3  +
mov [ebp+var_608] esi +
jmp loc_103D0B3  +
test eax eax +
jnz loc_103D0A2  +
push 6  +
push offset aNo  +
push 1  +
push esi  +
push offset aUserapprovedow  +
push [ebp+phkResult]  +
call ebx  +
push [ebp+phkResult]  +
call edi  +
cmp [ebp+arg_8] esi +
jz loc_103D0B3  +
lea eax [ebp+var_130] +
push eax  +
call sub_103CC2D  +
push 20h  +
push [ebp+var_5FC]  +
call ds:wcschr  +
pop ecx  +
pop ecx  +
cmp eax esi +
jz loc_103D0CE  +
inc eax  +
inc eax  +
jmp loc_103CFBA  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aProtocols  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103D22E  +
cmp [ebp+Type] 1 +
jnz loc_103D22E  +
lea eax [ebp+Data] +
push eax  +
mov [ebp+var_5FC] eax +
push 95h  +
lea eax [ebp+var_130] +
push eax  +
call sub_1027E68  +
lea eax [ebp+var_130] +
push 20h  +
push eax  +
call ds:wcschr  +
pop ecx  +
pop ecx  +
cmp eax esi +
jz loc_103D14C  +
xor ecx ecx +
mov [eax] cx +
lea eax [ebp+var_130] +
push eax  +
push lpSubKey  +
lea eax [ebp+SubKey] +
push offset aSProtocolsS  +
push 0C7h  +
push eax  +
call sub_1027F64  +
add esp 14h +
push esi  +
lea eax [ebp+phkResult] +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push hKey  +
call ds:RegCreateKeyExW  +
cmp [ebp+arg_4] esi +
jz loc_103D1DF  +
test eax eax +
jnz loc_103D1BB  +
push 8  +
push offset aYes  +
push 1  +
push esi  +
push offset aUserapprovedow  +
push [ebp+phkResult]  +
call ebx  +
push [ebp+phkResult]  +
call edi  +
cmp [ebp+arg_8] esi +
jz loc_103D213  +
lea eax [ebp+var_130] +
push eax  +
lea eax [ebp+var_62C] +
push eax  +
call sub_10397A3  +
test eax eax +
jnz loc_103D213  +
mov [ebp+var_608] esi +
jmp loc_103D213  +
test eax eax +
jnz loc_103D202  +
push 6  +
push offset aNo  +
push 1  +
push esi  +
push offset aUserapprovedow  +
push [ebp+phkResult]  +
call ebx  +
push [ebp+phkResult]  +
call edi  +
cmp [ebp+arg_8] esi +
jz loc_103D213  +
lea eax [ebp+var_130] +
push eax  +
call sub_1032BE7  +
push 20h  +
push [ebp+var_5FC]  +
call ds:wcschr  +
pop ecx  +
pop ecx  +
cmp eax esi +
jz loc_103D22E  +
inc eax  +
inc eax  +
jmp loc_103D11A  +
lea eax [ebp+cbData] +
push eax  +
lea eax [ebp+Data] +
push eax  +
lea eax [ebp+Type] +
push eax  +
push esi  +
push offset aDevices_0  +
push [ebp+hKey]  +
mov [ebp+cbData] 208h +
call ds:RegQueryValueExW  +
test eax eax +
jnz loc_103D38E  +
cmp [ebp+Type] 1 +
jnz loc_103D38E  +
lea eax [ebp+Data] +
push eax  +
mov [ebp+var_5FC] eax +
push 95h  +
lea eax [ebp+var_130] +
push eax  +
call sub_1027E68  +
lea eax [ebp+var_130] +
push 20h  +
push eax  +
call ds:wcschr  +
pop ecx  +
pop ecx  +
cmp eax esi +
jz loc_103D2AC  +
xor ecx ecx +
mov [eax] cx +
lea eax [ebp+var_130] +
push eax  +
push lpSubKey  +
lea eax [ebp+SubKey] +
push offset aSDevicesS  +
push 0C7h  +
push eax  +
call sub_1027F64  +
add esp 14h +
push esi  +
lea eax [ebp+phkResult] +
push eax  +
push esi  +
push 2  +
push esi  +
push esi  +
push esi  +
lea eax [ebp+SubKey] +
push eax  +
push hKey  +
call ds:RegCreateKeyExW  +
cmp [ebp+arg_4] esi +
jz loc_103D33F  +
test eax eax +
jnz loc_103D31B  +
push 8  +
push offset aYes  +
push 1  +
push esi  +
push offset aUserapprovedow  +
push [ebp+phkResult]  +
call ebx  +
push [ebp+phkResult]  +
call edi  +
cmp [ebp+arg_8] esi +
jz loc_103D373  +
lea eax [ebp+var_130] +
push eax  +
lea eax [ebp+var_62C] +
push eax  +
call sub_1039825  +
test eax eax +
jnz loc_103D373  +
mov [ebp+var_608] esi +
jmp loc_103D373  +
test eax eax +
jnz loc_103D362  +
push 6  +
push offset aNo  +
push 1  +
push esi  +
push offset aUserapprovedow  +
push [ebp+phkResult]  +
call ebx  +
push [ebp+phkResult]  +
call edi  +
cmp [ebp+arg_8] esi +
jz loc_103D373  +
lea eax [ebp+var_130] +
push eax  +
call sub_10317B8  +
push 20h  +
push [ebp+var_5FC]  +
call ds:wcschr  +
pop ecx  +
pop ecx  +
cmp eax esi +
jz loc_103D38E  +
inc eax  +
inc eax  +
jmp loc_103D27A  +
push [ebp+hKey]  +
call edi  +
mov esi [ebp+var_608] +
jmp loc_103CD1A  +
***
mov edi edi +
push ebp  +
mov ebp esp +
sub esp 10h +
push ebx  +
mov ebx [ebp+pvar] +
test ebx ebx +
jnz loc_103D3E0  +
mov eax 80070057h +
jmp loc_103D408  +
push esi  +
push edi  +
mov esi ebx +
lea edi [ebp+var_10] +
movs   +
movs   +
movs   +
push ebx  +
movs   +
call ds:PropVariantClear  +
test eax eax +
jge loc_103D406  +
lea esi [ebp+var_10] +
mov edi ebx +
movs   +
movs   +
movs   +
push ebx  +
movs   +
call ds:VariantClear  +
pop edi  +
pop esi  +
pop ebx  +
leave   +
retn 4  +
***
push ebx  +
mov eax [esp+14h] +
or eax eax +
jnz loc_103D471  +
mov ecx [esp+10h] +
mov eax [esp+0Ch] +
xor edx edx +
div  ecx +
mov eax [esp+8] +
div  ecx +
mov eax edx +
xor edx edx +
jmp loc_103D4C1  +
mov ecx eax +
mov ebx [esp+10h] +
mov edx [esp+0Ch] +
mov eax [esp+8] +
shr ecx 1 +
rcr ebx 1 +
shr edx 1 +
rcr eax 1 +
or ecx ecx +
jnz loc_103D47F  +
div  ebx +
mov ecx eax +
mul  dword ptr [esp+14h] +
xchg eax ecx +
mul  dword ptr [esp+10h] +
add edx ecx +
jb loc_103D4AA  +
cmp edx [esp+0Ch] +
ja loc_103D4AA  +
jb loc_103D4B2  +
cmp eax [esp+8] +
jbe loc_103D4B2  +
sub eax [esp+10h] +
sbb edx [esp+14h] +
sub eax [esp+8] +
sbb edx [esp+0Ch] +
neg edx  +
neg eax  +
sbb edx 0 +
pop ebx  +
retn 10h  +
***
mov eax [esp+8] +
mov ecx [esp+10h] +
or ecx eax +
mov ecx [esp+0Ch] +
jnz loc_103D4E9  +
mov eax [esp+4] +
mul  ecx +
retn 10h  +
***
push ebx  +
mul  ecx +
mov ebx eax +
mov eax [esp+8] +
mul  dword ptr [esp+14h] +
add ebx eax +
mov eax [esp+8] +
mul  ecx +
add edx ebx +
pop ebx  +
retn 10h  +
***
push ebx  +
push esi  +
mov eax [esp+18h] +
or eax eax +
jnz loc_103D532  +
mov ecx [esp+14h] +
mov eax [esp+10h] +
xor edx edx +
div  ecx +
mov ebx eax +
mov eax [esp+0Ch] +
div  ecx +
mov edx ebx +
jmp loc_103D573  +
mov ecx eax +
mov ebx [esp+14h] +
mov edx [esp+10h] +
mov eax [esp+0Ch] +
shr ecx 1 +
rcr ebx 1 +
shr edx 1 +
rcr eax 1 +
or ecx ecx +
jnz loc_103D540  +
div  ebx +
mov esi eax +
mul  dword ptr [esp+18h] +
mov ecx eax +
mov eax [esp+14h] +
mul  esi +
add edx ecx +
jb loc_103D56E  +
cmp edx [esp+10h] +
ja loc_103D56E  +
jb loc_103D56F  +
cmp eax [esp+0Ch] +
jbe loc_103D56F  +
dec esi  +
xor edx edx +
mov eax esi +
pop esi  +
pop ebx  +
retn 10h  +
***
cmp cl 40h +
jnb loc_103D59A  +
cmp cl 20h +
jnb loc_103D590  +
shrd eax edx +
shr edx cl +
retn   +
***
mov eax edx +
xor edx edx +
and cl 1Fh +
shr eax cl +
retn   +
***
xor eax eax +
xor edx edx +
retn   +
***
mov eax off_103F074 +
mov dword_10416F4 eax +
retn   +
***
xor eax eax +
push eax  +
push eax  +
push eax  +
push 6  +
call sub_102FFFB  +
neg eax  +
sbb eax eax +
add eax 80000002h +
mov hKey eax +
retn   +
***
mov eax off_103F08C +
push esi  +
mov esi off_103F0A0 +
mov dword_1040040 esi +
mov esi off_103F0AC +
mov ecx off_103F0D8 +
mov dword_1040068 esi +
mov esi off_103F0A4 +
mov dword_103FF78 eax +
mov eax off_103F090 +
mov edx off_103F0DC +
mov dword_1040090 esi +
mov esi off_103F098 +
mov dword_103FFA0 eax +
mov eax off_103F0D4 +
mov dword_10400B8 esi +
mov esi off_103F09C +
mov dword_103FFC8 eax +
mov dword_1040270 eax +
mov eax off_103F0C0 +
mov dword_10400E0 esi +
mov esi off_103F0B0 +
mov dword_1040298 eax +
mov eax off_103F0BC +
mov dword_1040108 esi +
mov esi off_103F094 +
mov dword_10402C0 eax +
mov eax off_103F0E8 +
mov dword_1040130 esi +
mov esi off_103F0A8 +
mov dword_10402E8 eax +
mov eax off_103F0C4 +
mov dword_1040158 esi +
mov esi off_103F0B8 +
mov dword_1040310 eax +
mov eax off_103F0C8 +
mov dword_1040180 esi +
mov esi off_103F0D0 +
mov dword_1040338 eax +
mov eax off_103F0E0 +
mov dword_10401A8 esi +
mov esi off_103F0B4 +
mov dword_103FFF0 ecx +
mov dword_10401F8 ecx +
mov ecx off_103F0CC +
mov dword_1040388 eax +
mov eax off_103F0E4 +
mov dword_10401D0 esi +
mov dword_1040018 edx +
mov dword_1040220 edx +
mov dword_1040248 ecx +
mov dword_1040360 ecx +
mov dword_10403B0 eax +
pop esi  +
retn   +
***
mov eax dword_1040424 +
mov dword_104042C eax +
retn   +
***
mov eax dword_1040424 +
mov dword_1040444 eax +
retn   +
***
mov eax dword_1040424 +
mov dword_104045C eax +
retn   +
***
mov eax dword_1040424 +
mov dword_1040474 eax +
retn   +
***
mov eax dword_1040424 +
mov dword_104048C eax +
retn   +
***
mov eax dword_1040424 +
mov dword_10404A4 eax +
retn   +
***
mov eax dword_1040424 +
mov dword_10404BC eax +
retn   +
***
mov eax dword_1040424 +
mov dword_10404D4 eax +
retn   +
***
mov eax dword_1040424 +
mov dword_10404EC eax +
retn   +
***
mov eax dword_1040424 +
mov dword_1040504 eax +
retn   +
***
mov eax dword_1040424 +
mov dword_104051C eax +
retn   +
***
mov eax dword_1040424 +
mov dword_1040534 eax +
retn   +
***
mov eax dword_1040424 +
mov dword_104054C eax +
retn   +
***
mov eax dword_1040424 +
mov dword_1040564 eax +
retn   +
***
mov eax dword_1040424 +
mov dword_104057C eax +
retn   +
***
mov eax dword_1040424 +
mov dword_1040594 eax +
retn   +
***
